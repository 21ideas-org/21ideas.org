<!doctype html><html lang=en dir=ltr><head><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&display=swap" rel=stylesheet><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  This content is also available in video format in this playlist.


Contents
  
    
  Understanding Bitcoin Privacy with OXT
  #

Part 1: Chain Analysis And Transaction Privacy
Part 2: Chain Analysis Core Concepts
Part 3: Defences Against Chain Analysis
Part 4: Applying Chain Analysis Concepts To Improve User Privacy

  



  Introduction
  #

So far this guide has introduced the basics concepts used by chain analysis and the concepts used to undermine chain analysis."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta name=lightning content="21ideas@getalby.com"><meta property="og:title" content="Part 4: Applying Chain Analysis Concepts To Improve User Privacy"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://21ideas.org/en/privacy/oxt-4/"><meta property="og:image" content="https://21ideas.org/img/oxt/oxt-4-cover.webp"><title>Part 4: Applying Chain Analysis Concepts To Improve User Privacy | 21ideas</title>
<link rel=manifest href=/manifest.json><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon media="(prefers-color-scheme: dark)" sizes=180x180 href=/apple-touch-icon-dark.png><link rel=icon type=image/png media="(prefers-color-scheme: dark)" sizes=32x32 href=/favicon-32x32-dark.png><link rel=icon type=image/png media="(prefers-color-scheme: dark)" sizes=16x16 href=/favicon-16x16-dark.png><link rel=alternate hreflang=ru-RU href=https://21ideas.org/privacy/oxt-4/ title="Часть 4: Применение концепций анализа цепочки для улучшения приватности пользователей"><link rel=stylesheet href=/book.min.9a7e7f2fd8dbf37a603c13c455bcb4090978aba7c73b6cb3571d0bdd5e41e635.css integrity="sha256-mn5/L9jb83pgPBPEVby0CQl4q6fHO2yzVx0L3V5B5jU=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script><script defer src=/en.search.min.b433362958c44fd2c1742972d43975afa848d698e20be37c78c8fc63670cbfa0.js integrity="sha256-tDM2KVjET9LBdCly1Dl1r6hI1pjiC+N8eMj8Y2cMv6A=" crossorigin=anonymous></script><script type=text/javascript src=https://unpkg.com/zapthreads@0.5.2/dist/zapthreads.iife.js></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/en/><picture><source srcset=/svg/logo_white.svg media="(prefers-color-scheme: dark)"><img src=/svg/logo_black.svg alt=Logo>
</picture><span>21ideas</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
English</a></label><ul><li><a href=https://21ideas.org/privacy/oxt-4/>Русский</a></li></ul></li></ul><ul><li><input type=checkbox id=section-2c1fc68ff68c3e454d055a4d37a4816d class=toggle>
<label for=section-2c1fc68ff68c3e454d055a4d37a4816d class="flex justify-between"><a role=button>Start</a></label><ul><li><a href=/en/start/start/>Bitcoin Basics</a></li><li><a href=/en/start/guide/>Using Bitcoin</a></li><li><a href=/en/shitcoin-gambling-games/>Don’t Play Shitcoin Gambling Games</a></li></ul></li><li><input type=checkbox id=section-0e947b637002f54ca330500896114bfb class=toggle checked>
<label for=section-0e947b637002f54ca330500896114bfb class="flex justify-between"><a href=/en/theory/>Theory</a></label><ul><li><input type=checkbox id=section-c8c88ad6975c3c08b99f7a6aaa8233c7 class=toggle>
<label for=section-c8c88ad6975c3c08b99f7a6aaa8233c7 class="flex justify-between"><a href=/en/economics/>Economics</a></label><ul><li><input type=checkbox id=section-042039620ae77f503533b4129302aa25 class=toggle>
<label for=section-042039620ae77f503533b4129302aa25 class="flex justify-between"><a href=/en/gradually-then-suddenly/>Gradually, Then Suddenly</a></label><ul><li><a href=/en/gradually-then-suddenly/intro/>Intro</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-cant-be-copied/>Bitcoin Can’t Be Copied</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-too-volatile/>Bitcoin Is Not Too Volatile</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-does-not-waste-energy/>Bitcoin Does Not Waste Energy</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-too-slow/>Bitcoin is Not Too Slow</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-fixes-this/>Bitcoin Fixes This</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-not-blockchain/>Bitcoin, Not Blockchain</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-backed-by-nothing/>Bitcoin is Not Backed by Nothing</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-a-pyramid-scheme/>Bitcoin is Not a Pyramid Scheme</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-cannot-be-banned/>Bitcoin Cannot be Banned</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-for-criminals/>Bitcoin is Not for Criminals</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-obsoletes-all-other-money/>Bitcoin Obsoletes All Other Money</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-a-rally-cry/>Bitcoin is a Rally Cry</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-common-sense/>Bitcoin is Common Sense</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-antifragile/>Bitcoin is Antifragile</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-one-for-all/>Bitcoin is One for All</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-the-great-definancialization/>Bitcoin is the Great Definancialization</a></li></ul></li><li><input type=checkbox id=section-dcadc98a07b7e2ce216dc99178d52c35 class=toggle>
<label for=section-dcadc98a07b7e2ce216dc99178d52c35 class="flex justify-between"><a href=/en/discovering-bitcoin/>Discovering Bitcoin</a></label><ul><li><a href=/en/discovering-bitcoin/intro/>Introduction</a></li><li><a href=/en/discovering-bitcoin/about-time/>About Time</a></li><li><a href=/en/discovering-bitcoin/about-people/>About People</a></li><li><a href=/en/discovering-bitcoin/introducing-money/>Introducing Money</a></li><li><a href=/en/discovering-bitcoin/a-wrong-turn-new-plan-needed/>A Wrong Turn (New Plan Needed)!</a></li><li><a href=/en/discovering-bitcoin/digital-scarcity/>Digital Scarcity</a></li><li><a href=/en/discovering-bitcoin/digital-contracts/>Digital Contracts</a></li><li><a href=/en/discovering-bitcoin/the-missing-pieces/>The Missing Pieces</a></li></ul></li><li><a href=/en/bitcoin-is-not-harmful-for-the-environment/>Bitcoin Is Not Harmful For The Environment</a></li><li><a href=/en/seven-network-effects-of-bitcoin/>The Seven Network Effects of Bitcoin</a></li><li><a href=/en/masters-and-slaves-of-money/>Masters and Slaves of Money</a></li><li><a href=/en/structural-adjustment/>Structural Adjustment</a></li><li><a href=/en/in-defense-of-deflation/>In Defense Of Deflation</a></li><li><a href=/en/comparison-of-monetary-standards/>Comparison of Monetary Standards</a></li><li><a href=/en/petrodollar-negative-effects/>Petrodollar Negative Effects</a></li><li><a href=/en/shelling-out/>Shelling Out: The Origins of Money</a></li><li><a href=/en/bitcoin-rhythms-of-history/>Bitcoin and the Rhythms of History</a></li><li><a href=/en/bitcoin-and-the-hopf-cycle-of-the-internet/>Bitcoin & the HOPF Cycle of the Internet</a></li><li><a href=/en/money-blockchains-and-social-scalability/>Money, blockchains, and social scalability</a></li><li><a href=/en/what-is-money/>What Is Money</a></li><li><a href=/en/only-the-strong-survive/>Only The Strong Survive</a></li><li><a href=/en/dollar-cost-averaging/>Dollar-Cost Averaging</a></li><li><a href=/en/jevons-paradox/>Jevons Paradox: Contrary Truth</a></li></ul></li><li><input type=checkbox id=section-7607f4888796b50750900ae1fa41174c class=toggle>
<label for=section-7607f4888796b50750900ae1fa41174c class="flex justify-between"><a href=/en/security/>Security</a></label><ul><li><a href=/en/how-to-hold-private-keys/>Bitcoin Wallets: How, Why and When to Hold Your Own Private Keys</a></li><li><a href=/en/seed/>What is a bitcoin seed phrase and how does it work?</a></li><li><a href=/en/seed-security/>Ultimate guide to storing your bitcoin seed phrase backups</a></li><li><a href=/en/passphrase/>Is your passphrase strong enough?</a></li><li><a href=/en/what-is-multisig/>What is multisig?</a></li><li><a href=/en/hwws/>The best Bitcoin hardware wallets</a></li><li><a href=/en/multisig-1/>Multisig Part I: Why Multisig?</a></li><li><a href=/en/multisig-2/>Multisig Part II: Single Keys are the Foundation of Multisignature</a></li></ul></li><li><input type=checkbox id=section-6e81d9ae00d8c0e44f4b6c22008f433f class=toggle checked>
<label for=section-6e81d9ae00d8c0e44f4b6c22008f433f class="flex justify-between"><a href=/en/privacy/>Privacy</a></label><ul><li><a href=/en/privacy/best-practices/>Bitcoin Privacy: Best Practices</a></li><li><a href=/en/privacy/no-kyc/>no-KYC only. Avoid the creep</a></li><li><a href=/en/wiki-bitcoin-privacy/>Bitcoin Privacy</a></li><li><a href=/en/bitcoin-becomes-critical/>Bitcoin Becomes Critical</a></li><li><a href=/en/bip47-the-ugly-duckling/>BIP47, the ugly duckling</a></li><li><input type=checkbox id=section-fa948e4e97baac946689641ce96c1e94 class=toggle checked>
<label for=section-fa948e4e97baac946689641ce96c1e94 class="flex justify-between"><a href=/en/privacy/oxt/>Understanding Bitcoin Privacy with OXT</a></label><ul><li><a href=/en/privacy/oxt-1/>Part 1: Chain Analysis And Transaction Privacy</a></li><li><a href=/en/privacy/oxt-2/>Part 2: Chain Analysis Core Concepts</a></li><li><a href=/en/privacy/oxt-3/>Part 3: Defences Against Chain Analysis</a></li><li><a href=/en/privacy/oxt-4/ class=active>Part 4: Applying Chain Analysis Concepts To Improve User Privacy</a></li></ul></li><li><a href=/en/privacy/coinjoin/>CoinJoin Overview</a></li><li><a href=/en/bitcoin-fungibility/>Bitcoin Fungibility</a></li><li><a href=/en/freesamourai/>#FreeSamourai</a></li></ul></li><li><input type=checkbox id=section-7703f58e8cfca24f7e8f10e99f7fd772 class=toggle>
<label for=section-7703f58e8cfca24f7e8f10e99f7fd772 class="flex justify-between"><a href=/en/protocol/>Protocol</a></label><ul><li><a href=/en/who-controls-bitcoin-core/>Who Controls Bitcoin Core?</a></li><li><a href=/en/bitcoins-eternal-struggle/>Bitcoin's Eternal Struggle</a></li><li><a href=/en/on-bitcoins-ux/>On Bitcoin’s UX</a></li><li><a href=/en/bitcoin-digital-gold-or-ecash/>Bitcoin: Digital Gold or Peer-to-Peer Cash?</a></li><li><a href=/en/bitcoin-governance/>Bitcoin Governance</a></li><li><a href=/en/trusted-third-parties/>Trusted Third Parties are Security Holes</a></li><li><a href=/en/21-million-is-non-negotiable/>21 Million is Non-Negotiable</a></li><li><a href=/en/proof-of-work/>Proof of Work, a pictorial essay</a></li><li><a href=/en/proof-of-stake-is-a-scam/>Proof of stake is a scam</a></li><li><a href=/en/was-satoshi-a-greedy-miner/>Was Satoshi a Greedy Miner?</a></li><li><a href=/en/segwit/>What Is SegWit</a></li><li><a href=/en/taproot/>What Is Taproot</a></li><li><a href=/en/coercion-of-ethereums-difficulty-bomb/>The Coercion Of Ethereum's Difficulty Bomb</a></li><li><a href=/en/rgb/>Understanding the RGB protocol</a></li><li><a href=/en/difficulty/>Bitcoin Difficulty Adjustment</a></li><li><a href=/en/bitcoin-address-types/>Bitcoin address types</a></li><li><a href=/en/myths-about-halving/>Myths About the Bitcoin Halving</a></li><li><a href=/en/mining-walkthrough/>SHA256 and Bitcoin Mining Walkthrough</a></li><li><input type=checkbox id=section-f1564ca04cb3a2764bdfe28910075cd7 class=toggle>
<label for=section-f1564ca04cb3a2764bdfe28910075cd7 class="flex justify-between"><a href=/en/protocol/utxo/>What Is UTXO And How To Manage Them</a></label><ul><li><a href=/en/protocol/utxo-1/>What is a Bitcoin UTXO</a></li><li><a href=/en/protocol/utxo-2/>Too Many UTXOs: How To Avoid High Fees</a></li><li><a href=/en/protocol/utxo-3/>UTXOs Privacy</a></li></ul></li><li><a href=/en/transaction-size/>Transaction Size</a></li><li><a href=/en/on-ossification/>On Ossification</a></li></ul></li><li><input type=checkbox id=section-3b225c8aaa13f68b831829121e8a96ea class=toggle>
<label for=section-3b225c8aaa13f68b831829121e8a96ea class="flex justify-between"><a href=/en/history/>History</a></label><ul><li><input type=checkbox id=section-6a04f6b3dd7c2dea74ad7a9a3b27156f class=toggle>
<label for=section-6a04f6b3dd7c2dea74ad7a9a3b27156f class="flex justify-between"><a href=/en/gf/>The Genesis Files</a></label><ul><li><a href=/en/gf/genesis-intro/>Intro</a></li><li><a href=/en/gf/genesis-1/>Part I: How David Chaum’s eCash Spawned a Cypherpunk Dream</a></li><li><a href=/en/gf/genesis-2/>Part II: Hashcash or How Adam Back Designed Bitcoin’s Motor Block</a></li><li><a href=/en/gf/genesis-3/>Part III: If Bitcoin Had a First Draft, Wei Dai’s B-Money Was It</a></li><li><a href=/en/gf/genesis-4/>Part IV: With Bit Gold, Szabo Was Inches Away From Inventing Bitcoin</a></li><li><a href=/en/gf/genesis-5/>Part V: How Hal Finney’s Quest For Digital Cash Led To RPOW (And More)</a></li></ul></li><li><a href=/en/hal-finney/>Hal Finney — The Life And Death Of A Cypherpunk Legend</a></li><li><a href=/en/bitcoin-and-me/>Bitcoin and Me</a></li><li><a href=/en/bitcoin-reformation/>The Bitcoin Reformation</a></li><li><a href=/en/bitcoin-forks/>A complete history of Bitcoin’s consensus forks</a></li><li><a href=/en/analyzing-2013-fork/>Analyzing the 2013 Bitcoin fork</a></li></ul></li><li><input type=checkbox id=section-8deaa51eea3af90eb190b70b9511c351 class=toggle>
<label for=section-8deaa51eea3af90eb190b70b9511c351 class="flex justify-between"><a href=/en/philosophy/>Philosophy</a></label><ul><li><input type=checkbox id=section-c0de4237ba1d1d542c91bf085525457d class=toggle>
<label for=section-c0de4237ba1d1d542c91bf085525457d class="flex justify-between"><a href=/en/what-i-learned-from-bitcoin/>What I've Learned From Bitcoin</a></label><ul><li><a href=/en/what-i-learned-from-bitcoin-1/>Part I. Philosophical Teachings of Bitcoin</a></li><li><a href=/en/what-i-learned-from-bitcoin-2/>Part II. Economic Teachings of Bitcoin</a></li><li><a href=/en/what-i-learned-from-bitcoin-3/>Part III. Technological Teachings of Bitcoin</a></li></ul></li><li><a href=/en/not-shitcoin/>Why Bitcoin, Not Shitcoin</a></li><li><a href=/en/inalienable-property-rights/>Inalienable Property Rights</a></li><li><a href=/en/crypto-anarchist-manifesto/>The Crypto Anarchist Manifesto</a></li><li><a href=/en/cypherpunks-manifesto/>A Cypherpunk's Manifesto</a></li><li><a href=/en/dutch-tulip-bubble/>Is Bitcoin Like the Dutch Tulip Bubble?</a></li><li><a href=/en/everyones-a-scammer/>Everyone's a Scammer</a></li><li><a href=/en/freedom-of-value/>The Freedom of Value</a></li><li><a href=/en/bitcoin-meme/>Bitcoin Is The Only Real Meme</a></li><li><a href=/en/number-zero-and-bitcoin/>The Number Zero and Bitcoin</a></li><li><a href=/en/crypto-bro/>Dear Crypto & Fiat Bros</a></li><li><a href=/en/fighting-fake-bitcoin/>Fighting Fake Bitcoin</a></li><li><a href=/en/bitcoin-is-the-mycelium/>Bitcoin is The Mycelium of Money</a></li><li><a href=/en/proof-of-life/>Proof of Life. Why Bitcoin is a Living Organism</a></li><li><a href=/en/most-peaceful-revolution/>A Most Peaceful Revolution</a></li><li><a href=/en/bitcoin-universe/>Bitcoin Universe</a></li><li><a href=/en/bitcoin-dissidents/>Bitcoin Dissidents</a></li><li><a href=/en/bitcoin-equals-freedom/>Bitcoin Equals Freedom</a></li></ul></li><li><input type=checkbox id=section-acee29309cd01b51e216d2d768d75871 class=toggle>
<label for=section-acee29309cd01b51e216d2d768d75871 class="flex justify-between"><a href=/en/future/>Future</a></label><ul><li><input type=checkbox id=section-8b8bdf99eb0d858d5adbfb2d713a72dc class=toggle>
<label for=section-8b8bdf99eb0d858d5adbfb2d713a72dc class="flex justify-between"><a href=/en/ba/>Bitcoin Astronomy</a></label><ul><li><a href=/en/ba/1/>Part I</a></li><li><a href=/en/ba/2/>Part II</a></li><li><a href=/en/ba/3/>Part III</a></li></ul></li><li><a href=/en/hey-bitcoin-slow-down/>Hey Bitcoin, Slow Down!</a></li><li><a href=/en/apocalypse/>Can Bitcoin Survive An Apocalypse?</a></li><li><a href=/en/bitcoin-and-oceans/>Bitcoin and Ocean Thermal Energy</a></li></ul></li><li><input type=checkbox id=section-7273d708b600eaa6617c228cdd2d9524 class=toggle>
<label for=section-7273d708b600eaa6617c228cdd2d9524 class="flex justify-between"><a href=/en/lightning/>Lightning</a></label><ul><li><a href=/en/what-is-lightning-network/>What is Lightning Network?</a></li><li><a href=/en/lightning-wallets/>Lightning Wallets</a></li><li><a href=/en/how-lightning-address-works/>How Lightning Address Works</a></li><li><a href=/en/lightning-network-privacy/>Lightning Network Privacy</a></li><li><a href=/en/is-lightning-centralized/>Is Lightning centralized?</a></li><li><a href=/en/lightning-network-explained/>Lightning Network Explained</a></li><li><a href=/en/inbound-liquidity-problem/>Solutions to inbound liquidity problem</a></li></ul></li></ul></li><li><input type=checkbox id=section-ebedd809137a39943c3339b07b86856f class=toggle>
<label for=section-ebedd809137a39943c3339b07b86856f class="flex justify-between"><a href=/en/practice/>Practice</a></label><ul><li><input type=checkbox id=section-a04618d8af5c321dea142dada821f01f class=toggle>
<label for=section-a04618d8af5c321dea142dada821f01f class="flex justify-between"><a href=/en/practice/buy/>Buy</a></label><ul><li><a href=/en/newbie-buy/>Buy and Hodl Bitcoin for Beginners</a></li><li><a href=/en/hodl-hodl/>Buy noKYC Bitcoin with HodlHodl</a></li><li><a href=/en/robosats/>RoboSats: Private P2P Exchange</a></li></ul></li><li><input type=checkbox id=section-52e946c82575a11d29d8ca1021a1b878 class=toggle>
<label for=section-52e946c82575a11d29d8ca1021a1b878 class="flex justify-between"><a href=/en/practice/hodl/>Hodl</a></label><ul><li><a href=/en/electrum/>Electrum Bitcoin Wallet</a></li><li><a href=/en/blue/>Installing Blue Wallet</a></li><li><a href=/en/seedsigner/>SeedSigner: DIY Bitcoin Signing Device</a></li><li><a href=/en/coldcard/>What is Coldcard?</a></li></ul></li><li><input type=checkbox id=section-7778724fd028202526d77fda64e80716 class=toggle>
<label for=section-7778724fd028202526d77fda64e80716 class="flex justify-between"><a href=/en/practice/interact/>Interact</a></label><ul><li><a href=/en/practice/bitcoin-node/>Why You Should Run Your Own Bitcoin Node</a></li><li><a href=/en/orangepilling-in-5-min/>Orangepilling in 5 min</a></li><li><a href=/en/5-tips-for-teaching-bitcoin/>5 tips for teaching Bitcoin</a></li></ul></li><li><input type=checkbox id=section-42375023512d85163c1ed33595577cc3 class=toggle>
<label for=section-42375023512d85163c1ed33595577cc3 class="flex justify-between"><a href=/en/practice-privacy/>Privacy</a></label><ul><li><input type=checkbox id=section-489729314822a64eb481d2971b819168 class=toggle>
<label for=section-489729314822a64eb481d2971b819168 class="flex justify-between"><a href=/en/practice-privacy/dojo/>Dojo x86 Bitcoin Node Guide</a></label><ul><li><a href=/en/practice-privacy/dojo-0/>Introduction</a></li><li><a href=/en/practice-privacy/dojo-1/>Installing Bitcoin Core & Tor</a></li><li><a href=/en/practice-privacy/dojo-2/>Installing Fulcrum Indexer</a></li><li><a href=/en/practice-privacy/dojo-3/>Installing Mempool Explorer</a></li><li><a href=/en/practice-privacy/dojo-4/>Installing Samourai Dojo</a></li><li><a href=/en/practice-privacy/dojo-5/>Firewall Configuration</a></li><li><a href=/en/practice-privacy/dojo-6/>Installing Package Updates</a></li></ul></li><li><a href=/en/practice-privacy/ronindojo/>RoninDojo x86 Installation Guide</a></li><li><a href=/en/grapheneos/>GrapheneOS: De-Google your phone</a></li></ul></li><li><input type=checkbox id=section-1ee5fbef80ad0a274c597a531c90648c class=toggle>
<label for=section-1ee5fbef80ad0a274c597a531c90648c class="flex justify-between"><a href=/en/practice/lightning/>Lightning</a></label><ul><li><a href=/en/phoenix/>Phoenix: The Non-Custodial Lightning Wallet</a></li><li><a href=/en/lnbits/>LNbits: A Swiss knife among Lightning apps</a></li><li><a href=/en/alby-and-nostr/>Alby and Nostr</a></li><li><a href=/en/zapplanner/>Recurring Lightning Payments</a></li><li><a href=/en/lntips/>Telegram bot @LightningTipBot</a></li><li><a href=/en/lightning-liquidity-management-guide/>Lightning Liquidity Management Guide</a></li><li><a href=/en/mutiny/>Starting with Mutiny Wallet</a></li></ul></li></ul></li><li><input type=checkbox id=section-0fbeb231f88c8b74f36060fd3f3377c6 class=toggle>
<label for=section-0fbeb231f88c8b74f36060fd3f3377c6 class="flex justify-between"><a href=/en/rabbithole/>Rabbithole</a></label><ul></ul></li></ul><div class=menuSep></div><ul><li><input type=checkbox id=section-5c8dd08fbf75826bbf8b24f27b15430e class=toggle>
<label for=section-5c8dd08fbf75826bbf8b24f27b15430e class="flex justify-between"><a href=/en/contribute/>Contribute</a></label><ul><li><a href=/en/github/>Adding an Article</a></li></ul></li><li><span>Blog</span></li><li><a href=/en/feedback/>Feedback</a></li></ul></nav><footer><br><a class=menuSocialButton href=https://t.me/bitcoin21ideas target=_blank title=Telegram><svg viewBox="0 0 25 25"><path d="m12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12c0-6.627-5.373-12-12-12zm5.894 8.221-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.446 1.394c-.14.18-.357.295-.6.295-.002.0-.003.0-.005.0l.213-3.054 5.56-5.022c.24-.213-.054-.334-.373-.121L8.32 13.617l-2.96-.924c-.64-.203-.658-.64.135-.954l11.566-4.458c.538-.196 1.006.128.832.941z"/></svg>
</a>&nbsp;
<a class=menuSocialButton href=https://github.com/21ideas-org/21ideas.org target=_blank title=GitHub><svg viewBox="0 0 820 820"><path d="M4e2 9.9C179.11 9.9.0 189 0 409.94.0 585.6 113.24 734.86 270.71 788.61l2.83.83c20 3.76 27.34-8.59 27.34-19.24.0-9.49-.32-34.68-.5-68-111.27 24.14-134.75-53.68-134.75-53.68a106.58 106.58.0 00-44.09-58.26l-.43-.24c-36.23-24.81 2.8-24.3 2.8-24.3A84.06 84.06.0 01185 606.54l.22.4a85.24 85.24.0 00116.92 33l-.43.21A85.16 85.16.0 01327 586.7C238.19 576.67 144.8 542.25 144.8 389c0-.72.0-1.55.0-2.38a153.82 153.82.0 0141.27-105l-.08.11a139.82 139.82.0 01-8.56-48.58 141.91 141.91.0 0112.4-58.21l-.37.91s33.51-10.72 110 41c30-8.56 64.43-13.5 1e2-13.5a378.09 378.09.0 01102.68 14.14l-2.67-.64c76-51.72 109.51-41 109.51-41a144 144 0 0112 58.07 145.56 145.56.0 01-8.35 48.82l.32-1a154.37 154.37.0 0141 105c0 .83.0 1.63.0 2.43V389c0 153.68-93.5 187.51-182.52 197.35a95.48 95.48.0 0127.27 66.93c0 2.48-.11 5-.3 7.42v-.32c0 53.54-.51 96.54-.51 109.53.0 10.51 7 23 27.51 19C686.25 734.78 8e2 585.39 8e2 409.41 8e2 188.74 621.11 9.87 400.47 9.87H4e2z"/></svg>
</a>&nbsp;
<a class=menuSocialButton href=https://njump.me/npub1lm3f47nzyf0rjp6fsl4qlnkmzed4uj4h2gnf2vhe3l3mrj85vqks6z3c7l target=_blank title=Nostr><svg viewBox="0 0 820 820"><path d="M4e2 797.5c219.53.0 397.5-178 397.5-397.5S619.53 2.5 4e2 2.5 2.5 180.47 2.5 4e2 180.47 797.5 4e2 797.5zM598.23 242.15c6.82 8.46 10.35 18.14 11.45 28.86 1.7 16.37-2.68 31.17-11.2 45-14.19 23.62-43.17 39.63-45.85 41-5.42 2.86-7.42 7.12-7.06 13.34s-1.21 37.19-20 50.83c-9.68 7-48.64 16-66.6 19.05a28.61 28.61.0 00-13.18 5.37c-1 .67-2 1.36-3.2 2.06-6.82 4.27-31.23 38-35.31 45.48l10.66-3.27c21.2-6.53 66.85-20.6 69.52-21 9-1.4 15.89 1.22 20.34 7.79 3.63 5.41 7.18 10.81 10.75 16.25.61.94 1.23 1.87 1.85 2.81 1 1.54 2 3.08 2.93 4.62.48.78 1 1.55 1.45 2.32l1.52 2.38c.09.14.19.29.28.45a10.65 10.65.0 011.37 2.83c.24 1 .91 4.14-.92 6.09-1.7 1.77-4.63 1.77-6.21 1.34a15.65 15.65.0 01-5.6-2.8l-2.49-2.13c-2-1.71-5.73-2.56-8.71-2.44-3.41.13-8-1-10.11-2.37-4.2-2.74-5.35-9.56-5.35-9.68a3.51 3.51.0 00-3.72-2.86 18.58 18.58.0 00-6.28 1.15l-.78.25q-15 4.56-29.93 9.24h0l-14.31 4.45c-7.06 2.19-14.12 4.38-21.13 6.69a37.45 37.45.0 00-5.72 2.62c-.43.21-.84.43-1.25.64l-1.24.64h0c-.85.42-1.7.85-2.55 1.34l-.27.15a30.59 30.59.0 01-5.76 2.65c-7.12 2.13-13.39-1-16.32-8.1-1.88-4.63-.18-13.76.86-16.44 5.58-14.35 21.77-39.58 26.28-46.6.75-1.17 1.17-1.83 1.17-1.86-.36-.12-23.25 9.07-27 11.93-10.35 7.86-34.64 26.49-35 28.31A22.75 22.75.0 01331 508.13c-5.66 2.19-9.13 6.7-12.48 11.08.0.0-60.88 83.83-65 88.34l-.68.74c-2.83 3-12.28 13.16-15 18.13-.46.83-1.61 3.27-2.58 5.33-.6 1.26-1.13 2.38-1.38 2.89.0.05-.05.11-.08.17-.59 1.21-1.91 3.9-6.31 3.66s-4.79-6.12-5-9.09v-.4c-.54-6.88 1-13.7 4.63-20.82a6.46 6.46.0 01.31-.58c1-1.8 3.93-7 2.61-11.36s-2.61-11.14-.6-14.61c2.84-4.77 7.62-5.48 13.92-6.41l2.64-.41c5.29-.85 9.13-3.53 12.84-8.88 4.66-6.84 17-24.51 27.65-39.67C293.62 516 3e2 507 302.66 503.09a25.55 25.55.0 003.77-9.08c1.89-9.74 7.85-16.49 18.14-20.7 2.25-.85 43.17-35.06 43.17-39.45.0-3.1-4.45-4.87-7.92-5.78-.48-.12-26.24-6.82-37.92-12.12A88.58 88.58.0 01305 406.41c-7.53-5.54-22.23-3.16-25.3-2.67l-.27.05c-11 1.58-19.12 6.51-28.37 12.78-1.65 1.16-10.05 4.2-14.31 1.77-1.32-.75-2.9-1.6-4.65-2.54-9.16-4.92-22.91-12.31-28.59-20.9-3.11-4.69-2.68-12.42-.49-20.94 7.07-19.73 17.48-28.56 36.77-33.91 11.39-3.95 32.41-5.33 46.84-6.28 2.93-.19 5.59-.37 7.84-.54.12-.05.8-.09 1.94-.18 7-.51 31.32-2.27 49.13-11.39 1.61-.82 3.59-1.92 5.91-3.2 17.67-9.8 55.68-30.86 107.76-29.25 12.95.4 32.15 7.45 49.77 13.93 14.79 5.43 28.46 10.45 36.38 10.79 17.65.73 26.54-1.22 36.77-11.81 2.92-3.05 15.16-29.53 3.59-44a108.64 108.64.0 00-13.94-14.55q-2.28-1.94-4.59-3.85a183.79 183.79.0 01-15.8-14.29c-13.82-14.61-18.09-34.58-11.51-50.17 4.14-10.9 13-15.65 25.63-13.15 6.22 1.24 11.28 5.49 15.95 9.41a73.24 73.24.0 005.84 4.59c3.6 2.38 9.56 3.78 13.46 4.69 4.93 1.16 8.65 4.93 8.4 7.49s-6.7 4.75-13 4.26c-7.36-.49-20.09-.55-27.7 2-5.05 1.83-7.3 7.49-5.84 13 1.22 4.57 10.9 12.66 14.55 15.65 1.64 1.35 3.3 2.67 5 4C587.86 231.81 593.56 236.34 598.23 242.15z" fill-rule="evenodd"/></svg>
</a>&nbsp;
<a class=menuSocialButton href=/rss title=RSS><svg viewBox="-143 145 525 525"><path d="M113 145c-141.4.0-256 114.6-256 256s114.6 256 256 256 256-114.6 256-256S254.4 145 113 145zM43.1 518.7c-6.2 6.2-14.7 9.9-24.1 9.9-9.4.0-17.8-3.8-24-9.9-6.2-6.2-10-14.6-10-23.9.0-9.4 3.8-17.8 10-24s14.6-10 24-10 17.9 3.8 24 10c6.2 6.2 10 14.6 10 24C53 504.2 49.2 512.6 43.1 518.7zM104.8 529c-.1-32.1-12.5-62.3-35.1-84.9-22.6-22.6-52.8-35.2-84.7-35.2V360c46.6.0 88.7 19 119.3 49.6s49.5 72.8 49.6 119.4H104.8zm87.2.0c-.1-114.2-92.8-207.1-206.9-207.1V273c70.6.0 134.5 28.7 180.8 75.1 46.3 46.4 75 110.3 75.1 180.9H192z"/></svg></a></footer><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class="book-page book-page-page"><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Part 4: Applying Chain Analysis Concepts To Improve User Privacy</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#introduction>Introduction</a></li><li><a href=#lost-on-chain--starting-points-and-breaking-pseudonymity>Lost On Chain — Starting Points And Breaking Pseudonymity</a></li><li><a href=#oxt-workflow--addresses-as-starting-points>OXT Workflow — Addresses As Starting Points</a></li><li><a href=#analysis-directions--utxo-history-and-future-spending>Analysis Directions — UTXO History And Future Spending</a></li><li><a href=#privacy-implications-of-sending-and-receiving-payments>Privacy Implications Of Sending And Receiving Payments</a></li><li><a href=#samourai-wallet-privacy-enhancing-transactions>Samourai Wallet Privacy Enhancing Transactions</a><ul><li><a href=#stealth-addresses--denying-a-start-point>Stealth Addresses — Denying a Start Point</a></li><li><a href=#coin-control--utxo-segregation>Coin Control — UTXO Segregation</a></li><li><a href=#ricochet--adding-distance>Ricochet — Adding Distance</a></li><li><a href=#stonewall-and-stonewall-x2--payments-made-safe>Stonewall and Stonewall x2 — Payments Made Safe</a></li><li><a href=#stowaway--breaking-the-cioh>Stowaway — Breaking the CIOH</a></li><li><a href=#whirlpool-coinjoin--creating-forward-privacy>Whirlpool Coinjoin — Creating Forward Privacy</a></li></ul></li><li><a href=#review>Review</a></li><li><a href=#closing>Closing</a></li></ul></li></ul></nav></aside></header><div class=pageCover><picture><img src=/img/oxt/oxt-4-cover.webp alt=Cover></picture></div><h1>Part 4: Applying Chain Analysis Concepts To Improve User Privacy</h1><div class=pageDate>August 11, 2021</div><article class=markdown><blockquote class="book-hint info"><em>This content is also available in video format in <a href="https://www.youtube.com/playlist?list=PLIBmWVGQhizLrPjpFMN5bQdbOZRxCQXUg">this playlist</a>.</em></blockquote><details><summary>Contents</summary><div class=markdown-inner><h2 id=understanding-bitcoin-privacy-with-oxt>Understanding Bitcoin Privacy with OXT
<a class=anchor href=#understanding-bitcoin-privacy-with-oxt>#</a></h2><p><a href=/en/privacy/oxt-1>Part 1: Chain Analysis And Transaction Privacy</a></p><p><a href=/en/privacy/oxt-2>Part 2: Chain Analysis Core Concepts</a></p><p><a href=/en/privacy/oxt-3>Part 3: Defences Against Chain Analysis</a></p><p><a href=/en/privacy/oxt-4>Part 4: Applying Chain Analysis Concepts To Improve User Privacy</a></p></div></details><h2 id=introduction>Introduction
<a class=anchor href=#introduction>#</a></h2><p>So far this guide has introduced the basics concepts used by chain analysis and the concepts used to undermine chain analysis.</p><p>It is unlikely that users reading this are looking to become “experts” in chain analysis, but a fundamental understanding of the tools and concepts used to attack their privacy will allow them to better protect their privacy.</p><p>In this section we will introduce the real world implications of sending and receiving transactions on user privacy. From there we will present specific privacy enhancing technologies that can be used to maintain privacy when interacting with bitcoin.</p><h2 id=lost-on-chain--starting-points-and-breaking-pseudonymity>Lost On Chain — Starting Points And Breaking Pseudonymity
<a class=anchor href=#lost-on-chain--starting-points-and-breaking-pseudonymity>#</a></h2><p>Bitcoin is pseudonymous by default. Without additional information tying user activity to on-chain activity, an analysis has no “starting point” for tracking related bitcoin network activity.</p><p>Starting points typically include users willingly disclosing addresses they control. Provided addresses are typically for receiving payment. Starting points can also be obtained from information provided by third parties, such as the information sharing agreements between surveillance firms and exchanges.</p><p>For beginner analysts, some “context” is usually necessary for performing an analysis. That valuable context often comes from analysis of their own transactions. Users evaluating their own transaction history via a third party block explorer are encouraged to use a VPN or Tor browser to prevent linking of their IP address with their transaction information.</p><h2 id=oxt-workflow--addresses-as-starting-points>OXT Workflow — Addresses As Starting Points
<a class=anchor href=#oxt-workflow--addresses-as-starting-points>#</a></h2><p>Most users query block explorers by entering an address as a starting point. When querying OXT with an address as a starting point, the associated transaction information will not automatically be displayed. Users should follow the steps below to navigate to the transaction graph.</p><ol><li><p>Log in to your OXT account. Accounts are free and do not require any personally identifiable information for creation.</p></li><li><p>Enter the desired address into the search bar.</p></li></ol><div class=imageWrapper><img src=/img/oxt/oxt-39.png><p><em>OXT Workflow Address Query</em></p></div><ol start=3><li>Navigate to the TRANSACTION TAB</li></ol><div class=imageWrapper><img src=/img/oxt/oxt-40.png><p><em>OXT Workflow Address — Transaction Tab</em></p></div><ol start=4><li><p>Select the desired transaction. Users should note that a starting address may have received multiple payments. If the address has received multiple transactions, they will have to select the desired transaction based on volume and timing of the transactions.</p></li><li><p>From there the Transaction Page will be opened.</p></li></ol><div class=imageWrapper><img src=/img/oxt/oxt-41.png><p><em>OXT Workflow Transaction Page and Graph Tool</em></p></div><ol start=6><li>Open the transaction graph to begin the financial flow evaluation.</li></ol><blockquote class="book-hint info"><em>Note: If users already have the desired transaction ID, they can avoid logging into OXT and navigate directly to the transaction page for accessing the transaction graph. Revisit</em> <a href=/en/privacy/oxt-2><em>Part II</em></a> <em>for additional details on interacting with the transaction graph.</em></blockquote><h2 id=analysis-directions--utxo-history-and-future-spending>Analysis Directions — UTXO History And Future Spending
<a class=anchor href=#analysis-directions--utxo-history-and-future-spending>#</a></h2><p>Analysts presented with a starting transaction and UTXO can pursue two investigation “directions”.</p><p>They can search for the “source” of funds by evaluating the past history of the target UTXO. Source evaluation for transaction chains with a single input are fairly simple to perform, because there is no “decision” to be made in evaluating which input UTXO path to follow. However, multi-input transactions present analysts with multiple sources to evaluate.</p><p>Analysts can also search for the “destination” of future spends from the associated UTXO by applying the change detection heuristics presented in <a href=/en/privacy/oxt-1>Part I</a> and external transaction data presented in <a href=/en/privacy/oxt-2>Part II</a>.</p><div class=imageWrapper><img src=/img/oxt/oxt-42-en.webp><p><em>Investigation Direction — Source & Destination</em></p></div><blockquote class="book-hint info"><em>Note: UTXO flows should not be tracked across custodial services. It is highly unlikely that a deposit UTXO will be used to payout to the entity making the deposit.</em></blockquote><h2 id=privacy-implications-of-sending-and-receiving-payments>Privacy Implications Of Sending And Receiving Payments
<a class=anchor href=#privacy-implications-of-sending-and-receiving-payments>#</a></h2><p>When sending or receiving a payment, users necessarily reveal some of their UTXO set to their counterparty. For naively managed UTXOs, this may reveal a users <strong><em>entire</em></strong> wallet balance to a counterparty.</p><p>Disclosing wealth for making payments is an unfortunate side effect of bitcoin’s transparency. The negative implications of this disclosure to counterparties should be obvious, particularly for simple spends.</p><p>In addition, payments made by a sender allow for a recipient to assess the senders past transaction history. Payments also allow a sender to evaluate a recipients future spending of their received payment.</p><p>The techniques discussed below are designed to mitigate the negative side effects of bitcoin’s transparency.</p><h2 id=samourai-wallet-privacy-enhancing-transactions>Samourai Wallet Privacy Enhancing Transactions
<a class=anchor href=#samourai-wallet-privacy-enhancing-transactions>#</a></h2><p>Much of chain analysis is based on the following core concepts:</p><ul><li>analysts needing a starting point</li><li>the issues of the transaction graph</li><li>change detection</li><li>clustering separate addresses by the common input ownership heuristic</li></ul><p>In <a href=/en/privacy/oxt-1>Part I</a> and <a href=/en/privacy/oxt-2>II</a> we introduced the core concepts of chain analysis. <a href=/en/privacy/oxt-3>Part III</a> presented the concepts used to undermine these techniques.</p><p>The OXT team works with the <a href=https://samouraiwallet.com>Samourai Wallet</a> developers to test and create techniques that mitigate the privacy shortcomings we have introduced so far. These techniques are discussed below.</p><h3 id=stealth-addresses--denying-a-start-point>Stealth Addresses — Denying a Start Point
<a class=anchor href=#stealth-addresses--denying-a-start-point>#</a></h3><p>Chain analysts need a starting point when attempting to track an entity’s on chain activities. This typically means linking a target’s online activity with an address they have posted for receiving payments or donations. From this address an analyst can evaluate a user’s activity including received payments, total address balance, and spending patterns.</p><p>User’s frequently share addresses for receiving payments. The shared addresses are the same addresses that appear on the blockchain and are searchable via any block explorer.</p><p>Instead of exchanging a direct address for receiving payment, users can exchange “stealth addresses”. Stealth addresses are based on concepts derived from the Diffe-Hellman key exchange, a critical cryptographic concept that underpins TLS/SSL, one of the most important forms of cryptography used in internet secure communications.</p><p>Samourai Wallet’s stealth address implementation is based on the <a href=https://github.com/bitcoin/bips/blob/master/bip-0047.mediawiki>BIP 47</a> Proposal by the Open Bitcoin Privacy Project. BIP 47 reusable payment codes allow a sender to: create an unlimited amount of unique bitcoin addresses for payment to the intended recipient without the recipient needing to be online.</p><div class=imageWrapper><img src=/img/oxt/oxt-43.png><p><em>V1 BIP47 Payment Code Architecture (<a href=https://raw.githubusercontent.com/bitcoin/bips/master/bip-0047/reusable_payment_codes-01.png>BIP 47 Github</a>)</em></p></div><p>Reusable payment codes deprive analysts of a “free” starting point on the bitcoin block chain. More information on Samourai Wallet’s reusable payment code can be found <a href=https://docs.samourai.io/en/wallet/usage#paynym-1>here</a>.</p><h3 id=coin-control--utxo-segregation>Coin Control — UTXO Segregation
<a class=anchor href=#coin-control--utxo-segregation>#</a></h3><p>Combining inputs from multiple sources in future spends can allow payment senders to evaluate the transaction histories of additional UTXOs combined with their spent UTXO.</p><p>To mitigate this privacy leak, users can practice “coin control”. Broadly coin control consists of several steps.</p><ul><li>Labelling received payment UTXOs. At a minimum labelling should include the sender and reason for payment.</li><li>“Marking Do Not Spend”. To prevent a wallet from accidentally including a UTXO in a future payment, UTXOs can be made inactive for inclusion in future spends.</li><li>Sending Individual (Selective UTXO Activation). UTXOs can be selectively spent.</li></ul><div class=imageWrapper><img src=/img/oxt/oxt-44-en.webp><p><em>Samourai Wallet Coin Control</em></p></div><p>When payments are made, users should also get in the habit of labelling their change UTXOs. When a label is added to a single UTXO, Samourai Wallet will automatically label any other UTXOs (change outputs) from the same spend with the same label.</p><h3 id=ricochet--adding-distance>Ricochet — Adding Distance
<a class=anchor href=#ricochet--adding-distance>#</a></h3><p>Ricochet is a simple tool that automatically adds “hops”, or dummy transactions between an origin UTXO and payment destination. Ricochet transactions do not obfuscate source of funds or break the transaction graph. However, these transactions put distance between a payment destination and previous UTXO histories.</p><p>Source of fund evaluation for transactions with a single input are relatively easy to perform, but adding “hops” requires a receiving entity to evaluate history beyond the immediate incoming UTXO. Transaction graph traversal analyses are simple to perform, but expanding incoming UTXO history evaluation implies additional doubt based on the “UTXO Ownership Model” which increases chances for false positives.</p><div class=imageWrapper><img src=/img/oxt/oxt-45-en.webp><p><em>Example Ricochet Transaction (<a href=https://oxt.me/transaction/ee0d4dd6703949e594d88734ec40aa669a586c3126ee713bcf5883bd7f55b816>TxID</a>)</em></p></div><p>The current version of ricochet includes four extra hops. A more “dynamic” ricochet with a variable number of hops is planned in future updates. More information on ricochet can be found <a href=https://docs.samourai.io/wallet/privacy-enhanced-transactions#ricochet>here</a>.</p><h3 id=stonewall-and-stonewall-x2--payments-made-safe>Stonewall and Stonewall x2 — Payments Made Safe
<a class=anchor href=#stonewall-and-stonewall-x2--payments-made-safe>#</a></h3><p>Stonewall and Stonewall x2 use the same coin selection algorithm to create transactions with coinjoin properties. Stonewall is a simulated coinjoin that uses inputs from an individual wallet. Stonewall x2 is a “true” coinjoin that uses inputs from 2 collaborating users/wallets.</p><p>Using the same algorithm means these transactions have identical on-chain footprints, and are indistinguishable to outside observers. As a result, analysts must consider the possibility that any Stonewall transaction is a “true” coinjoin.</p><div class=imageWrapper><img src=/img/oxt/oxt-46-en.webp><p><em>Example Stonewall Transaction (<a href=https://kycp.org/#/587b93fb5bb4671835db88e30bab0acea752a9c06eaebc251f7fa644fc321cdf>TxID</a>)</em></p></div><p>The Stonewall algorithm is an extension of the transaction properties aimed at defeating simple spend change detection heuristics such as like-type output scripts and randomised change output position.</p><p>Due to their coinjoin properties, stonewall transactions are capable of defeating the round output payment heuristic interpretation that cannot be defeated by a simple spend. Stonewall defeats these heuristics by creating transactions with a “dummy” output equal to the intended payment amount.</p><p>Stonewall’s are true payments, that still include deterministic links for their “change” UTXOs. Because a Stonewall can be a two-wallet coinjoin, a transaction counterparty cannot be sure which change UTXOs belong to the transaction sender responsible for making the payment and which change UTXO belongs to the coinjoin collaborator.</p><h3 id=stowaway--breaking-the-cioh>Stowaway — Breaking the CIOH
<a class=anchor href=#stowaway--breaking-the-cioh>#</a></h3><p>As we described in <a href=/en/privacy/oxt-3>Part III</a>, payjoin transactions undermine the common input ownership heuristic. If a single UTXO does not have a sufficient balance to make the desired payment amount, wallet software will include additional inputs as needed to meet the desired amount. Analysts can potentially incorrectly assume the inputs these transactions are controlled by the same wallet.</p><div class=imageWrapper><img src=/img/oxt/oxt-47-en.webp><p><em>Example Stonewall Transaction (<a href=https://oxt.me/transaction/14ff5e5c9206f7722b0ed421d26f1cb003c523070c4882150073817683bd2dda>TxID</a>)</em></p></div><p>Payjoins typically have no indistinguishable on chain fingerprint. By including inputs from the transaction sender and payment recipient, two wallets are used to construct the transaction. This undermines the CIOH and creates a “false cluster”. As a consequence of the recipient contributing inputs to the transaction payjoin, the true transaction payment amount is also hidden.</p><h3 id=whirlpool-coinjoin--creating-forward-privacy>Whirlpool Coinjoin — Creating Forward Privacy
<a class=anchor href=#whirlpool-coinjoin--creating-forward-privacy>#</a></h3><p>Payment senders can track the future spending of their payment UTXO and potentially obtain additional information about their counterpatry’s wallet composition. To maintain their privacy, payment recipients can coinjoin to break the link between their payment receipt and future spending. In otherwords, sending UTXOs received as payment through a coinjoin establishes forward privacy.</p><p>Whirlpool is the only 100% entropy zerolink coinjoin implementation. Whirlpool coinjoins do not include “unmixed change” outputs within the coinjoin transaction that can be used to continue to track user activity.</p><div class=imageWrapper><img src=/img/oxt/oxt-48-en.webp><p><em>Whirlpool Transaction (<a href=https://kycp.org/#/323df21f0b0756f98336437aa3d2fb87e02b59f1946b714a7b09df04d429dec2>TxID</a>)</em></p></div><p>The Whirlpool transaction process begins with the Tx0 which pays the coordinator fee, creates premix UTXOs that are equal to the pool denomination plus miner fees, and a segregated change UTXO.</p><p>Inputs to a Tx0 should be selected with care to avoid linking UTXOs from different sources. Combining multiple inputs sources reveals common ownership. The change UTXO should also be handled with care so as to not directly link any future spending activity.</p><div class=imageWrapper><img src=/img/oxt/oxt-49-en.webp><p><em>Example Tx0 Transaction (<a href=https://kycp.org/#/a126e48d4a6eb8d19682ec0e23ad45e76cd52b45f6c17be5068ae051d4b2cc24>TxID</a>)</em></p></div><p>After coinjoining and breaking the links between their original (premix) UTXOs and postmix UTXOs, payment recipients can be confident that any payment senders will not be able to reliably follow the future spending of their payment UTXO.</p><h2 id=review>Review
<a class=anchor href=#review>#</a></h2><p>Bitcoin maintains basic user privacy with its pseudonymous nature by not linking real world identities and activities on the blockchain.</p><p>At the protocol level, bitcoin transactions send bitcoin to and from transparent addresses for transparent amounts. This transparency has lead to a proliferation of block chain analysis. The bulk of what is considered chain analysis involves payment change detection, transaction graph analysis, and use of the common input ownership heuristic for “wallet clustering”.</p><p>While many of these techniques rely on heuristics, applying external transaction data such as address reuse and outputs to or from centralised services can significantly undermine the ambiguity of simple bitcoin transactions.</p><p>Wallet software can include randomised fingerprinting and like-type address outputs to maintain ambiguity of simple spends. Even with these tools, the on-chain flows of bitcoin remain “traceable” and deterministic. Properly constructed equal output coinjoins remain the best way for breaking deterministic links and introducing plausible deniability into the transaction graph.</p><p>It is likely that the typical user reading this guide is not looking to become an expert in chain analysis. Rather they are looking to improve their privacy when sending and receiving payments. The act of sending and receiving payments necessarily reveals UTXO set information about a sender’s wallet to a payment recipient. As a result, payment senders and receivers are able to evaluate the respective past and future spending of these known UTXOs, which can reveal additional information about their counterparty.</p><p>Users armed with knowledge of chain analysis are better prepared for evaluating the implications of spending and receiving and can begin to take steps to protect their privacy.</p><p>Those steps include: not linking blockchain activities to an online persona, avoiding address reuse, segregating UTXOs with different histories, establishing forward privacy with coinjoin, and using the advanced spending tools previously discussed to undermine chain analysis heursitics.</p><p>Knowledgeable use of these techniques can allow users to obtain a basic level of privacy they may be accustomed to in the traditional finance system.</p><h2 id=closing>Closing
<a class=anchor href=#closing>#</a></h2><p>A general bitcoin privacy and OXT guide has been requested by many readers. Our hope is that this provides you with a starting point for continuing to expand your understanding of bitcoin privacy.</p><p>Armed with additional knowledge and context from this guide, long term readers are encouraged to revisit our previous research reports. Particularly the previously included transaction graphs.</p><p>Feedback, comments, and requests for additional guides are welcome.</p><p>Thanks for reading and stay safe.</p><p><em>— The OXT Research Team</em></p><details><summary>Contents</summary><div class=markdown-inner><h2 id=understanding-bitcoin-privacy-with-oxt>Understanding Bitcoin Privacy with OXT
<a class=anchor href=#understanding-bitcoin-privacy-with-oxt>#</a></h2><p><a href=/en/privacy/oxt-1>Part 1: Chain Analysis And Transaction Privacy</a></p><p><a href=/en/privacy/oxt-2>Part 2: Chain Analysis Core Concepts</a></p><p><a href=/en/privacy/oxt-3>Part 3: Defences Against Chain Analysis</a></p><p><a href=/en/privacy/oxt-4>Part 4: Applying Chain Analysis Concepts To Improve User Privacy</a></p></div></details></article><hr><i>Connect to our relay to leave a comment. <a href=https://21ideas.org/en/comments/>Details</a>.<br>Подключитесь к нашему релею, чтобы оставить комментарий. <a href=https://21ideas.org/comments/>Подробнее</a>.</i>
<zap-threads anchor=https://21ideas.org/en/privacy/oxt-4/ author=npub1lm3f47nzyf0rjp6fsl4qlnkmzed4uj4h2gnf2vhe3l3mrj85vqks6z3c7l relays=wss://21ideas.nostr1.com disable=replyAnonymously legacy-url=true></zap-threads><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#introduction>Introduction</a></li><li><a href=#lost-on-chain--starting-points-and-breaking-pseudonymity>Lost On Chain — Starting Points And Breaking Pseudonymity</a></li><li><a href=#oxt-workflow--addresses-as-starting-points>OXT Workflow — Addresses As Starting Points</a></li><li><a href=#analysis-directions--utxo-history-and-future-spending>Analysis Directions — UTXO History And Future Spending</a></li><li><a href=#privacy-implications-of-sending-and-receiving-payments>Privacy Implications Of Sending And Receiving Payments</a></li><li><a href=#samourai-wallet-privacy-enhancing-transactions>Samourai Wallet Privacy Enhancing Transactions</a><ul><li><a href=#stealth-addresses--denying-a-start-point>Stealth Addresses — Denying a Start Point</a></li><li><a href=#coin-control--utxo-segregation>Coin Control — UTXO Segregation</a></li><li><a href=#ricochet--adding-distance>Ricochet — Adding Distance</a></li><li><a href=#stonewall-and-stonewall-x2--payments-made-safe>Stonewall and Stonewall x2 — Payments Made Safe</a></li><li><a href=#stowaway--breaking-the-cioh>Stowaway — Breaking the CIOH</a></li><li><a href=#whirlpool-coinjoin--creating-forward-privacy>Whirlpool Coinjoin — Creating Forward Privacy</a></li></ul></li><li><a href=#review>Review</a></li><li><a href=#closing>Closing</a></li></ul></li></ul></nav></div></aside></main><script src=/static/scripts.js></script></body></html>