<!doctype html><html lang=en dir=ltr><head><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&display=swap" rel=stylesheet><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  This content is also available in video format in this playlist.


Contents
  
    
  Understanding Bitcoin Privacy with OXT
  #

Part 1: Chain Analysis And Transaction Privacy
Part 2: Chain Analysis Core Concepts
Part 3: Defences Against Chain Analysis
Part 4: Applying Chain Analysis Concepts To Improve User Privacy

  



  Introduction
  #

Awareness of Bitcoin’s value proposition for censorship resistant payments took off in 2011 with the launch of Silk Road and the rescue of the otherwise donation starved Wikileaks."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta name=lightning content="21ideas@getalby.com"><meta property="og:title" content="Part 1: Chain Analysis And Transaction Privacy"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://21ideas.org/en/privacy/oxt-1/"><meta property="og:image" content="https://21ideas.org/img/oxt/oxt-1-cover.png"><title>Part 1: Chain Analysis And Transaction Privacy | 21ideas</title>
<link rel=manifest href=/manifest.json><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon media="(prefers-color-scheme: dark)" sizes=180x180 href=/apple-touch-icon-dark.png><link rel=icon type=image/png media="(prefers-color-scheme: dark)" sizes=32x32 href=/favicon-32x32-dark.png><link rel=icon type=image/png media="(prefers-color-scheme: dark)" sizes=16x16 href=/favicon-16x16-dark.png><link rel=alternate hreflang=ru-RU href=https://21ideas.org/privacy/oxt-1/ title="Часть 1: Анализ цепочки и приватность транзакций"><link rel=stylesheet href=/book.min.a88fda41628a86b0aa4a3caa9c8ab466ee8e01a433898186e506a93fb98f1884.css integrity="sha256-qI/aQWKKhrCqSjyqnIq0Zu6OAaQziYGG5QapP7mPGIQ=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script><script defer src=/en.search.min.d6bc52f60174ba6dedd819f430e20fafba72374b0fb89a05c809afcea190127c.js integrity="sha256-1rxS9gF0um3t2Bn0MOIPr7pyN0sPuJoFyAmvzqGQEnw=" crossorigin=anonymous></script><script type=text/javascript src=https://unpkg.com/zapthreads@0.5.2/dist/zapthreads.iife.js></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/en/><picture><source srcset=/svg/logo_white.svg media="(prefers-color-scheme: dark)"><img src=/svg/logo_black.svg alt=Logo>
</picture><span>21ideas</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
English</a></label><ul><li><a href=https://21ideas.org/privacy/oxt-1/>Русский</a></li></ul></li></ul><ul><li><input type=checkbox id=section-2c1fc68ff68c3e454d055a4d37a4816d class=toggle>
<label for=section-2c1fc68ff68c3e454d055a4d37a4816d class="flex justify-between"><a role=button>Start</a></label><ul><li><a href=/en/start/start/>Bitcoin Basics</a></li><li><a href=/en/start/guide/>Using Bitcoin</a></li><li><a href=/en/shitcoin-gambling-games/>Don’t Play Shitcoin Gambling Games</a></li></ul></li><li><input type=checkbox id=section-0e947b637002f54ca330500896114bfb class=toggle checked>
<label for=section-0e947b637002f54ca330500896114bfb class="flex justify-between"><a href=/en/theory/>Theory</a></label><ul><li><input type=checkbox id=section-c8c88ad6975c3c08b99f7a6aaa8233c7 class=toggle>
<label for=section-c8c88ad6975c3c08b99f7a6aaa8233c7 class="flex justify-between"><a href=/en/economics/>Economics</a></label><ul><li><input type=checkbox id=section-042039620ae77f503533b4129302aa25 class=toggle>
<label for=section-042039620ae77f503533b4129302aa25 class="flex justify-between"><a href=/en/gradually-then-suddenly/>Gradually, Then Suddenly</a></label><ul><li><a href=/en/gradually-then-suddenly/intro/>Intro</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-cant-be-copied/>Bitcoin Can’t Be Copied</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-too-volatile/>Bitcoin Is Not Too Volatile</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-does-not-waste-energy/>Bitcoin Does Not Waste Energy</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-too-slow/>Bitcoin is Not Too Slow</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-fixes-this/>Bitcoin Fixes This</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-not-blockchain/>Bitcoin, Not Blockchain</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-backed-by-nothing/>Bitcoin is Not Backed by Nothing</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-a-pyramid-scheme/>Bitcoin is Not a Pyramid Scheme</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-cannot-be-banned/>Bitcoin Cannot be Banned</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-for-criminals/>Bitcoin is Not for Criminals</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-obsoletes-all-other-money/>Bitcoin Obsoletes All Other Money</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-a-rally-cry/>Bitcoin is a Rally Cry</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-common-sense/>Bitcoin is Common Sense</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-antifragile/>Bitcoin is Antifragile</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-one-for-all/>Bitcoin is One for All</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-the-great-definancialization/>Bitcoin is the Great Definancialization</a></li></ul></li><li><input type=checkbox id=section-dcadc98a07b7e2ce216dc99178d52c35 class=toggle>
<label for=section-dcadc98a07b7e2ce216dc99178d52c35 class="flex justify-between"><a href=/en/discovering-bitcoin/>Discovering Bitcoin</a></label><ul><li><a href=/en/discovering-bitcoin/intro/>Introduction</a></li><li><a href=/en/discovering-bitcoin/about-time/>About Time</a></li><li><a href=/en/discovering-bitcoin/about-people/>About People</a></li><li><a href=/en/discovering-bitcoin/introducing-money/>Introducing Money</a></li><li><a href=/en/discovering-bitcoin/a-wrong-turn-new-plan-needed/>A Wrong Turn (New Plan Needed)!</a></li><li><a href=/en/discovering-bitcoin/digital-scarcity/>Digital Scarcity</a></li><li><a href=/en/discovering-bitcoin/digital-contracts/>Digital Contracts</a></li><li><a href=/en/discovering-bitcoin/the-missing-pieces/>The Missing Pieces</a></li></ul></li><li><a href=/en/bitcoin-is-not-harmful-for-the-environment/>Bitcoin Is Not Harmful For The Environment</a></li><li><a href=/en/seven-network-effects-of-bitcoin/>The Seven Network Effects of Bitcoin</a></li><li><a href=/en/masters-and-slaves-of-money/>Masters and Slaves of Money</a></li><li><a href=/en/structural-adjustment/>Structural Adjustment</a></li><li><a href=/en/in-defense-of-deflation/>In Defense Of Deflation</a></li><li><a href=/en/comparison-of-monetary-standards/>Comparison of Monetary Standards</a></li><li><a href=/en/petrodollar-negative-effects/>Petrodollar Negative Effects</a></li><li><a href=/en/shelling-out/>Shelling Out: The Origins of Money</a></li><li><a href=/en/bitcoin-rhythms-of-history/>Bitcoin and the Rhythms of History</a></li><li><a href=/en/bitcoin-and-the-hopf-cycle-of-the-internet/>Bitcoin & the HOPF Cycle of the Internet</a></li><li><a href=/en/money-blockchains-and-social-scalability/>Money, blockchains, and social scalability</a></li><li><a href=/en/what-is-money/>What Is Money</a></li><li><a href=/en/only-the-strong-survive/>Only The Strong Survive</a></li><li><a href=/en/dollar-cost-averaging/>Dollar-Cost Averaging</a></li><li><a href=/en/jevons-paradox/>Jevons Paradox: Contrary Truth</a></li></ul></li><li><input type=checkbox id=section-7607f4888796b50750900ae1fa41174c class=toggle>
<label for=section-7607f4888796b50750900ae1fa41174c class="flex justify-between"><a href=/en/security/>Security</a></label><ul><li><a href=/en/how-to-hold-private-keys/>Bitcoin Wallets: How, Why and When to Hold Your Own Private Keys</a></li><li><a href=/en/seed/>What is a bitcoin seed phrase and how does it work?</a></li><li><a href=/en/seed-security/>Ultimate guide to storing your bitcoin seed phrase backups</a></li><li><a href=/en/passphrase/>Is your passphrase strong enough?</a></li><li><a href=/en/what-is-multisig/>What is multisig?</a></li><li><a href=/en/hwws/>The best Bitcoin hardware wallets</a></li><li><a href=/en/multisig-1/>Multisig Part I: Why Multisig?</a></li><li><a href=/en/multisig-2/>Multisig Part II: Single Keys are the Foundation of Multisignature</a></li></ul></li><li><input type=checkbox id=section-6e81d9ae00d8c0e44f4b6c22008f433f class=toggle checked>
<label for=section-6e81d9ae00d8c0e44f4b6c22008f433f class="flex justify-between"><a href=/en/privacy/>Privacy</a></label><ul><li><a href=/en/privacy/best-practices/>Bitcoin Privacy: Best Practices</a></li><li><a href=/en/privacy/no-kyc/>no-KYC only. Avoid the creep</a></li><li><a href=/en/wiki-bitcoin-privacy/>Bitcoin Privacy</a></li><li><a href=/en/bitcoin-becomes-critical/>Bitcoin Becomes Critical</a></li><li><a href=/en/bip47-the-ugly-duckling/>BIP47, the ugly duckling</a></li><li><input type=checkbox id=section-fa948e4e97baac946689641ce96c1e94 class=toggle checked>
<label for=section-fa948e4e97baac946689641ce96c1e94 class="flex justify-between"><a href=/en/privacy/oxt/>Understanding Bitcoin Privacy with OXT</a></label><ul><li><a href=/en/privacy/oxt-1/ class=active>Part 1: Chain Analysis And Transaction Privacy</a></li><li><a href=/en/privacy/oxt-2/>Part 2: Chain Analysis Core Concepts</a></li><li><a href=/en/privacy/oxt-3/>Part 3: Defences Against Chain Analysis</a></li><li><a href=/en/privacy/oxt-4/>Part 4: Applying Chain Analysis Concepts To Improve User Privacy</a></li></ul></li><li><a href=/en/privacy/coinjoin/>CoinJoin Overview</a></li><li><a href=/en/bitcoin-fungibility/>Bitcoin Fungibility</a></li><li><a href=/en/freesamourai/>#FreeSamourai</a></li></ul></li><li><input type=checkbox id=section-7703f58e8cfca24f7e8f10e99f7fd772 class=toggle>
<label for=section-7703f58e8cfca24f7e8f10e99f7fd772 class="flex justify-between"><a href=/en/protocol/>Protocol</a></label><ul><li><a href=/en/who-controls-bitcoin-core/>Who Controls Bitcoin Core?</a></li><li><a href=/en/bitcoins-eternal-struggle/>Bitcoin's Eternal Struggle</a></li><li><a href=/en/on-bitcoins-ux/>On Bitcoin’s UX</a></li><li><a href=/en/bitcoin-digital-gold-or-ecash/>Bitcoin: Digital Gold or Peer-to-Peer Cash?</a></li><li><a href=/en/bitcoin-governance/>Bitcoin Governance</a></li><li><a href=/en/trusted-third-parties/>Trusted Third Parties are Security Holes</a></li><li><a href=/en/21-million-is-non-negotiable/>21 Million is Non-Negotiable</a></li><li><a href=/en/proof-of-work/>Proof of Work, a pictorial essay</a></li><li><a href=/en/proof-of-stake-is-a-scam/>Proof of stake is a scam</a></li><li><a href=/en/was-satoshi-a-greedy-miner/>Was Satoshi a Greedy Miner?</a></li><li><a href=/en/segwit/>What Is SegWit</a></li><li><a href=/en/taproot/>What Is Taproot</a></li><li><a href=/en/coercion-of-ethereums-difficulty-bomb/>The Coercion Of Ethereum's Difficulty Bomb</a></li><li><a href=/en/rgb/>Understanding the RGB protocol</a></li><li><a href=/en/difficulty/>Bitcoin Difficulty Adjustment</a></li><li><a href=/en/bitcoin-address-types/>Bitcoin address types</a></li><li><a href=/en/myths-about-halving/>Myths About the Bitcoin Halving</a></li><li><a href=/en/mining-walkthrough/>SHA256 and Bitcoin Mining Walkthrough</a></li><li><input type=checkbox id=section-f1564ca04cb3a2764bdfe28910075cd7 class=toggle>
<label for=section-f1564ca04cb3a2764bdfe28910075cd7 class="flex justify-between"><a href=/en/protocol/utxo/>What Is UTXO And How To Manage Them</a></label><ul><li><a href=/en/protocol/utxo-1/>What is a Bitcoin UTXO</a></li><li><a href=/en/protocol/utxo-2/>Too Many UTXOs: How To Avoid High Fees</a></li><li><a href=/en/protocol/utxo-3/>UTXOs Privacy</a></li></ul></li><li><a href=/en/transaction-size/>Transaction Size</a></li><li><a href=/en/on-ossification/>On Ossification</a></li></ul></li><li><input type=checkbox id=section-3b225c8aaa13f68b831829121e8a96ea class=toggle>
<label for=section-3b225c8aaa13f68b831829121e8a96ea class="flex justify-between"><a href=/en/history/>History</a></label><ul><li><input type=checkbox id=section-6a04f6b3dd7c2dea74ad7a9a3b27156f class=toggle>
<label for=section-6a04f6b3dd7c2dea74ad7a9a3b27156f class="flex justify-between"><a href=/en/gf/>The Genesis Files</a></label><ul><li><a href=/en/gf/genesis-intro/>Intro</a></li><li><a href=/en/gf/genesis-1/>Part I: How David Chaum’s eCash Spawned a Cypherpunk Dream</a></li><li><a href=/en/gf/genesis-2/>Part II: Hashcash or How Adam Back Designed Bitcoin’s Motor Block</a></li><li><a href=/en/gf/genesis-3/>Part III: If Bitcoin Had a First Draft, Wei Dai’s B-Money Was It</a></li><li><a href=/en/gf/genesis-4/>Part IV: With Bit Gold, Szabo Was Inches Away From Inventing Bitcoin</a></li><li><a href=/en/gf/genesis-5/>Part V: How Hal Finney’s Quest For Digital Cash Led To RPOW (And More)</a></li></ul></li><li><a href=/en/hal-finney/>Hal Finney — The Life And Death Of A Cypherpunk Legend</a></li><li><a href=/en/bitcoin-and-me/>Bitcoin and Me</a></li><li><a href=/en/bitcoin-reformation/>The Bitcoin Reformation</a></li><li><a href=/en/bitcoin-forks/>A complete history of Bitcoin’s consensus forks</a></li><li><a href=/en/analyzing-2013-fork/>Analyzing the 2013 Bitcoin fork</a></li></ul></li><li><input type=checkbox id=section-8deaa51eea3af90eb190b70b9511c351 class=toggle>
<label for=section-8deaa51eea3af90eb190b70b9511c351 class="flex justify-between"><a href=/en/philosophy/>Philosophy</a></label><ul><li><input type=checkbox id=section-c0de4237ba1d1d542c91bf085525457d class=toggle>
<label for=section-c0de4237ba1d1d542c91bf085525457d class="flex justify-between"><a href=/en/what-i-learned-from-bitcoin/>What I've Learned From Bitcoin</a></label><ul><li><a href=/en/what-i-learned-from-bitcoin-1/>Part I. Philosophical Teachings of Bitcoin</a></li><li><a href=/en/what-i-learned-from-bitcoin-2/>Part II. Economic Teachings of Bitcoin</a></li><li><a href=/en/what-i-learned-from-bitcoin-3/>Part III. Technological Teachings of Bitcoin</a></li></ul></li><li><a href=/en/not-shitcoin/>Why Bitcoin, Not Shitcoin</a></li><li><a href=/en/inalienable-property-rights/>Inalienable Property Rights</a></li><li><a href=/en/crypto-anarchist-manifesto/>The Crypto Anarchist Manifesto</a></li><li><a href=/en/cypherpunks-manifesto/>A Cypherpunk's Manifesto</a></li><li><a href=/en/dutch-tulip-bubble/>Is Bitcoin Like the Dutch Tulip Bubble?</a></li><li><a href=/en/everyones-a-scammer/>Everyone's a Scammer</a></li><li><a href=/en/freedom-of-value/>The Freedom of Value</a></li><li><a href=/en/bitcoin-meme/>Bitcoin Is The Only Real Meme</a></li><li><a href=/en/number-zero-and-bitcoin/>The Number Zero and Bitcoin</a></li><li><a href=/en/crypto-bro/>Dear Crypto & Fiat Bros</a></li><li><a href=/en/fighting-fake-bitcoin/>Fighting Fake Bitcoin</a></li><li><a href=/en/bitcoin-is-the-mycelium/>Bitcoin is The Mycelium of Money</a></li><li><a href=/en/proof-of-life/>Proof of Life. Why Bitcoin is a Living Organism</a></li><li><a href=/en/most-peaceful-revolution/>A Most Peaceful Revolution</a></li><li><a href=/en/bitcoin-universe/>Bitcoin Universe</a></li><li><a href=/en/bitcoin-dissidents/>Bitcoin Dissidents</a></li><li><a href=/en/bitcoin-equals-freedom/>Bitcoin Equals Freedom</a></li></ul></li><li><input type=checkbox id=section-acee29309cd01b51e216d2d768d75871 class=toggle>
<label for=section-acee29309cd01b51e216d2d768d75871 class="flex justify-between"><a href=/en/future/>Future</a></label><ul><li><input type=checkbox id=section-8b8bdf99eb0d858d5adbfb2d713a72dc class=toggle>
<label for=section-8b8bdf99eb0d858d5adbfb2d713a72dc class="flex justify-between"><a href=/en/ba/>Bitcoin Astronomy</a></label><ul><li><a href=/en/ba/1/>Part I</a></li><li><a href=/en/ba/2/>Part II</a></li><li><a href=/en/ba/3/>Part III</a></li></ul></li><li><a href=/en/hey-bitcoin-slow-down/>Hey Bitcoin, Slow Down!</a></li><li><a href=/en/apocalypse/>Can Bitcoin Survive An Apocalypse?</a></li><li><a href=/en/bitcoin-and-oceans/>Bitcoin and Ocean Thermal Energy</a></li></ul></li><li><input type=checkbox id=section-7273d708b600eaa6617c228cdd2d9524 class=toggle>
<label for=section-7273d708b600eaa6617c228cdd2d9524 class="flex justify-between"><a href=/en/lightning/>Lightning</a></label><ul><li><a href=/en/what-is-lightning-network/>What is Lightning Network?</a></li><li><a href=/en/lightning-wallets/>Lightning Wallets</a></li><li><a href=/en/how-lightning-address-works/>How Lightning Address Works</a></li><li><a href=/en/lightning-network-privacy/>Lightning Network Privacy</a></li><li><a href=/en/is-lightning-centralized/>Is Lightning centralized?</a></li><li><a href=/en/lightning-network-explained/>Lightning Network Explained</a></li><li><a href=/en/inbound-liquidity-problem/>Solutions to inbound liquidity problem</a></li></ul></li></ul></li><li><input type=checkbox id=section-ebedd809137a39943c3339b07b86856f class=toggle>
<label for=section-ebedd809137a39943c3339b07b86856f class="flex justify-between"><a href=/en/practice/>Practice</a></label><ul><li><input type=checkbox id=section-a04618d8af5c321dea142dada821f01f class=toggle>
<label for=section-a04618d8af5c321dea142dada821f01f class="flex justify-between"><a href=/en/practice/buy/>Buy</a></label><ul><li><a href=/en/newbie-buy/>Buy and Hodl Bitcoin for Beginners</a></li><li><a href=/en/hodl-hodl/>Buy noKYC Bitcoin with HodlHodl</a></li><li><a href=/en/robosats/>RoboSats: Private P2P Exchange</a></li></ul></li><li><input type=checkbox id=section-52e946c82575a11d29d8ca1021a1b878 class=toggle>
<label for=section-52e946c82575a11d29d8ca1021a1b878 class="flex justify-between"><a href=/en/practice/hodl/>Hodl</a></label><ul><li><a href=/en/electrum/>Electrum Bitcoin Wallet</a></li><li><a href=/en/blue/>Installing Blue Wallet</a></li><li><a href=/en/seedsigner/>SeedSigner: DIY Bitcoin Signing Device</a></li><li><a href=/en/coldcard/>What is Coldcard?</a></li></ul></li><li><input type=checkbox id=section-7778724fd028202526d77fda64e80716 class=toggle>
<label for=section-7778724fd028202526d77fda64e80716 class="flex justify-between"><a href=/en/practice/interact/>Interact</a></label><ul><li><a href=/en/practice/bitcoin-node/>Why You Should Run Your Own Bitcoin Node</a></li><li><a href=/en/orangepilling-in-5-min/>Orangepilling in 5 min</a></li><li><a href=/en/5-tips-for-teaching-bitcoin/>5 tips for teaching Bitcoin</a></li></ul></li><li><input type=checkbox id=section-42375023512d85163c1ed33595577cc3 class=toggle>
<label for=section-42375023512d85163c1ed33595577cc3 class="flex justify-between"><a href=/en/practice-privacy/>Privacy</a></label><ul><li><input type=checkbox id=section-489729314822a64eb481d2971b819168 class=toggle>
<label for=section-489729314822a64eb481d2971b819168 class="flex justify-between"><a href=/en/practice-privacy/dojo/>Dojo x86 Bitcoin Node Guide</a></label><ul><li><a href=/en/practice-privacy/dojo-0/>Introduction</a></li><li><a href=/en/practice-privacy/dojo-1/>Installing Bitcoin Core & Tor</a></li><li><a href=/en/practice-privacy/dojo-2/>Installing Fulcrum Indexer</a></li><li><a href=/en/practice-privacy/dojo-3/>Installing Mempool Explorer</a></li><li><a href=/en/practice-privacy/dojo-4/>Installing Samourai Dojo</a></li><li><a href=/en/practice-privacy/dojo-5/>Firewall Configuration</a></li><li><a href=/en/practice-privacy/dojo-6/>Installing Package Updates</a></li></ul></li><li><a href=/en/practice-privacy/ronindojo/>RoninDojo x86 Installation Guide</a></li><li><a href=/en/grapheneos/>GrapheneOS: De-Google your phone</a></li></ul></li><li><input type=checkbox id=section-1ee5fbef80ad0a274c597a531c90648c class=toggle>
<label for=section-1ee5fbef80ad0a274c597a531c90648c class="flex justify-between"><a href=/en/practice/lightning/>Lightning</a></label><ul><li><a href=/en/phoenix/>Phoenix: The Non-Custodial Lightning Wallet</a></li><li><a href=/en/lnbits/>LNbits: A Swiss knife among Lightning apps</a></li><li><a href=/en/alby-and-nostr/>Alby and Nostr</a></li><li><a href=/en/zapplanner/>Recurring Lightning Payments</a></li><li><a href=/en/lntips/>Telegram bot @LightningTipBot</a></li><li><a href=/en/lightning-liquidity-management-guide/>Lightning Liquidity Management Guide</a></li><li><a href=/en/mutiny/>Starting with Mutiny Wallet</a></li></ul></li></ul></li><li><input type=checkbox id=section-0fbeb231f88c8b74f36060fd3f3377c6 class=toggle>
<label for=section-0fbeb231f88c8b74f36060fd3f3377c6 class="flex justify-between"><a href=/en/rabbithole/>Rabbithole</a></label><ul></ul></li></ul><div class=menuSep></div><ul><li><input type=checkbox id=section-5c8dd08fbf75826bbf8b24f27b15430e class=toggle>
<label for=section-5c8dd08fbf75826bbf8b24f27b15430e class="flex justify-between"><a href=/en/contribute/>Contribute</a></label><ul><li><a href=/en/github/>Adding an Article</a></li></ul></li><li><span>Blog</span></li><li><a href=/en/feedback/>Feedback</a></li></ul><div class=menuBlock><div id=metrics-container class=metrics-container><div id=metrics-label></div><div id=metrics-value></div></div></div></nav><footer><br><a class=menuSocialButton href=https://t.me/bitcoin21ideas target=_blank title=Telegram><svg viewBox="0 0 25 25"><path d="m12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12c0-6.627-5.373-12-12-12zm5.894 8.221-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.446 1.394c-.14.18-.357.295-.6.295-.002.0-.003.0-.005.0l.213-3.054 5.56-5.022c.24-.213-.054-.334-.373-.121L8.32 13.617l-2.96-.924c-.64-.203-.658-.64.135-.954l11.566-4.458c.538-.196 1.006.128.832.941z"/></svg>
</a>&nbsp;
<a class=menuSocialButton href=https://github.com/21ideas-org/21ideas.org target=_blank title=GitHub><svg viewBox="0 0 820 820"><path d="M4e2 9.9C179.11 9.9.0 189 0 409.94.0 585.6 113.24 734.86 270.71 788.61l2.83.83c20 3.76 27.34-8.59 27.34-19.24.0-9.49-.32-34.68-.5-68-111.27 24.14-134.75-53.68-134.75-53.68a106.58 106.58.0 00-44.09-58.26l-.43-.24c-36.23-24.81 2.8-24.3 2.8-24.3A84.06 84.06.0 01185 606.54l.22.4a85.24 85.24.0 00116.92 33l-.43.21A85.16 85.16.0 01327 586.7C238.19 576.67 144.8 542.25 144.8 389c0-.72.0-1.55.0-2.38a153.82 153.82.0 0141.27-105l-.08.11a139.82 139.82.0 01-8.56-48.58 141.91 141.91.0 0112.4-58.21l-.37.91s33.51-10.72 110 41c30-8.56 64.43-13.5 1e2-13.5a378.09 378.09.0 01102.68 14.14l-2.67-.64c76-51.72 109.51-41 109.51-41a144 144 0 0112 58.07 145.56 145.56.0 01-8.35 48.82l.32-1a154.37 154.37.0 0141 105c0 .83.0 1.63.0 2.43V389c0 153.68-93.5 187.51-182.52 197.35a95.48 95.48.0 0127.27 66.93c0 2.48-.11 5-.3 7.42v-.32c0 53.54-.51 96.54-.51 109.53.0 10.51 7 23 27.51 19C686.25 734.78 8e2 585.39 8e2 409.41 8e2 188.74 621.11 9.87 400.47 9.87H4e2z"/></svg>
</a>&nbsp;
<a class=menuSocialButton href=https://njump.me/npub1lm3f47nzyf0rjp6fsl4qlnkmzed4uj4h2gnf2vhe3l3mrj85vqks6z3c7l target=_blank title=Nostr><svg viewBox="0 0 820 820"><path d="M4e2 797.5c219.53.0 397.5-178 397.5-397.5S619.53 2.5 4e2 2.5 2.5 180.47 2.5 4e2 180.47 797.5 4e2 797.5zM598.23 242.15c6.82 8.46 10.35 18.14 11.45 28.86 1.7 16.37-2.68 31.17-11.2 45-14.19 23.62-43.17 39.63-45.85 41-5.42 2.86-7.42 7.12-7.06 13.34s-1.21 37.19-20 50.83c-9.68 7-48.64 16-66.6 19.05a28.61 28.61.0 00-13.18 5.37c-1 .67-2 1.36-3.2 2.06-6.82 4.27-31.23 38-35.31 45.48l10.66-3.27c21.2-6.53 66.85-20.6 69.52-21 9-1.4 15.89 1.22 20.34 7.79 3.63 5.41 7.18 10.81 10.75 16.25.61.94 1.23 1.87 1.85 2.81 1 1.54 2 3.08 2.93 4.62.48.78 1 1.55 1.45 2.32l1.52 2.38c.09.14.19.29.28.45a10.65 10.65.0 011.37 2.83c.24 1 .91 4.14-.92 6.09-1.7 1.77-4.63 1.77-6.21 1.34a15.65 15.65.0 01-5.6-2.8l-2.49-2.13c-2-1.71-5.73-2.56-8.71-2.44-3.41.13-8-1-10.11-2.37-4.2-2.74-5.35-9.56-5.35-9.68a3.51 3.51.0 00-3.72-2.86 18.58 18.58.0 00-6.28 1.15l-.78.25q-15 4.56-29.93 9.24h0l-14.31 4.45c-7.06 2.19-14.12 4.38-21.13 6.69a37.45 37.45.0 00-5.72 2.62c-.43.21-.84.43-1.25.64l-1.24.64h0c-.85.42-1.7.85-2.55 1.34l-.27.15a30.59 30.59.0 01-5.76 2.65c-7.12 2.13-13.39-1-16.32-8.1-1.88-4.63-.18-13.76.86-16.44 5.58-14.35 21.77-39.58 26.28-46.6.75-1.17 1.17-1.83 1.17-1.86-.36-.12-23.25 9.07-27 11.93-10.35 7.86-34.64 26.49-35 28.31A22.75 22.75.0 01331 508.13c-5.66 2.19-9.13 6.7-12.48 11.08.0.0-60.88 83.83-65 88.34l-.68.74c-2.83 3-12.28 13.16-15 18.13-.46.83-1.61 3.27-2.58 5.33-.6 1.26-1.13 2.38-1.38 2.89.0.05-.05.11-.08.17-.59 1.21-1.91 3.9-6.31 3.66s-4.79-6.12-5-9.09v-.4c-.54-6.88 1-13.7 4.63-20.82a6.46 6.46.0 01.31-.58c1-1.8 3.93-7 2.61-11.36s-2.61-11.14-.6-14.61c2.84-4.77 7.62-5.48 13.92-6.41l2.64-.41c5.29-.85 9.13-3.53 12.84-8.88 4.66-6.84 17-24.51 27.65-39.67C293.62 516 3e2 507 302.66 503.09a25.55 25.55.0 003.77-9.08c1.89-9.74 7.85-16.49 18.14-20.7 2.25-.85 43.17-35.06 43.17-39.45.0-3.1-4.45-4.87-7.92-5.78-.48-.12-26.24-6.82-37.92-12.12A88.58 88.58.0 01305 406.41c-7.53-5.54-22.23-3.16-25.3-2.67l-.27.05c-11 1.58-19.12 6.51-28.37 12.78-1.65 1.16-10.05 4.2-14.31 1.77-1.32-.75-2.9-1.6-4.65-2.54-9.16-4.92-22.91-12.31-28.59-20.9-3.11-4.69-2.68-12.42-.49-20.94 7.07-19.73 17.48-28.56 36.77-33.91 11.39-3.95 32.41-5.33 46.84-6.28 2.93-.19 5.59-.37 7.84-.54.12-.05.8-.09 1.94-.18 7-.51 31.32-2.27 49.13-11.39 1.61-.82 3.59-1.92 5.91-3.2 17.67-9.8 55.68-30.86 107.76-29.25 12.95.4 32.15 7.45 49.77 13.93 14.79 5.43 28.46 10.45 36.38 10.79 17.65.73 26.54-1.22 36.77-11.81 2.92-3.05 15.16-29.53 3.59-44a108.64 108.64.0 00-13.94-14.55q-2.28-1.94-4.59-3.85a183.79 183.79.0 01-15.8-14.29c-13.82-14.61-18.09-34.58-11.51-50.17 4.14-10.9 13-15.65 25.63-13.15 6.22 1.24 11.28 5.49 15.95 9.41a73.24 73.24.0 005.84 4.59c3.6 2.38 9.56 3.78 13.46 4.69 4.93 1.16 8.65 4.93 8.4 7.49s-6.7 4.75-13 4.26c-7.36-.49-20.09-.55-27.7 2-5.05 1.83-7.3 7.49-5.84 13 1.22 4.57 10.9 12.66 14.55 15.65 1.64 1.35 3.3 2.67 5 4C587.86 231.81 593.56 236.34 598.23 242.15z" fill-rule="evenodd"/></svg>
</a>&nbsp;
<a class=menuSocialButton href=/rss title=RSS><svg viewBox="-143 145 525 525"><path d="M113 145c-141.4.0-256 114.6-256 256s114.6 256 256 256 256-114.6 256-256S254.4 145 113 145zM43.1 518.7c-6.2 6.2-14.7 9.9-24.1 9.9-9.4.0-17.8-3.8-24-9.9-6.2-6.2-10-14.6-10-23.9.0-9.4 3.8-17.8 10-24s14.6-10 24-10 17.9 3.8 24 10c6.2 6.2 10 14.6 10 24C53 504.2 49.2 512.6 43.1 518.7zM104.8 529c-.1-32.1-12.5-62.3-35.1-84.9-22.6-22.6-52.8-35.2-84.7-35.2V360c46.6.0 88.7 19 119.3 49.6s49.5 72.8 49.6 119.4H104.8zm87.2.0c-.1-114.2-92.8-207.1-206.9-207.1V273c70.6.0 134.5 28.7 180.8 75.1 46.3 46.4 75 110.3 75.1 180.9H192z"/></svg>
</a>&nbsp;
<a class=menuSocialButton href=https://www.youtube.com/@21ideas target=_blank title=YouTube><svg viewBox="0 0 25 25"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm4.441 16.892c-2.102.144-6.784.144-8.883.0C5.282 16.736 5.017 15.622 5 12c.017-3.629.285-4.736 2.558-4.892 2.099-.144 6.782-.144 8.883.0C18.718 7.264 18.982 8.378 19 12c-.018 3.629-.285 4.736-2.559 4.892zM10 9.658l4.917 2.338L10 14.342V9.658z"/></svg></a></footer><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class="book-page book-page-page"><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Part 1: Chain Analysis And Transaction Privacy</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#introduction>Introduction</a><ul><li><a href=#traceability-is-mainstream>Traceability is mainstream.</a></li></ul></li><li><a href=#problem-statement--pseudonymous-bitcoin>Problem Statement — Pseudonymous Bitcoin</a></li><li><a href=#heuristics>Heuristics</a></li><li><a href=#unspent-transaction-outputs-utxos>Unspent Transaction Outputs (UTXOs)</a></li><li><a href=#example-transactions>Example Transactions</a><ul><li><a href=#simple-send>Simple Send</a></li><li><a href=#sweep>Sweep</a></li><li><a href=#consolidation-spend>Consolidation Spend</a></li><li><a href=#batch-spend>Batch Spend</a></li><li><a href=#multi-party-transactions-coinjoin>Multi-party Transactions (Coinjoin)</a></li></ul></li><li><a href=#change-detection--simple-spend-interpretations>Change Detection — Simple Spend Interpretations</a><ul><li><a href=#change-detection>Change Detection</a></li><li><a href=#address-reuse>Address Reuse</a></li><li><a href=#round-number-payment-heuristic>Round Number Payment Heuristic</a></li><li><a href=#different-script-type-heuristic>Different Script Type Heuristic</a></li><li><a href=#largest-output-amount-heuristic>Largest Output Amount Heuristic</a></li></ul></li><li><a href=#review-and-preview>Review And Preview</a></li></ul></li></ul></nav></aside></header><div class=pageCover><picture><img src=/img/oxt/oxt-1-cover.png alt=Cover></picture></div><h1>Part 1: Chain Analysis And Transaction Privacy</h1><div class=pageDate>August 4, 2021</div><article class=markdown><blockquote class="book-hint info"><em>This content is also available in video format in <a href="https://www.youtube.com/playlist?list=PLIBmWVGQhizLrPjpFMN5bQdbOZRxCQXUg">this playlist</a>.</em></blockquote><details><summary>Contents</summary><div class=markdown-inner><h2 id=understanding-bitcoin-privacy-with-oxt>Understanding Bitcoin Privacy with OXT
<a class=anchor href=#understanding-bitcoin-privacy-with-oxt>#</a></h2><p><a href=/en/privacy/oxt-1>Part 1: Chain Analysis And Transaction Privacy</a></p><p><a href=/en/privacy/oxt-2>Part 2: Chain Analysis Core Concepts</a></p><p><a href=/en/privacy/oxt-3>Part 3: Defences Against Chain Analysis</a></p><p><a href=/en/privacy/oxt-4>Part 4: Applying Chain Analysis Concepts To Improve User Privacy</a></p></div></details><h2 id=introduction>Introduction
<a class=anchor href=#introduction>#</a></h2><p>Awareness of Bitcoin’s value proposition for censorship resistant payments took off in 2011 with the launch of Silk Road and the rescue of the otherwise donation starved Wikileaks.</p><p>Simultaneously a dangerous and inaccurate narrative surrounding bitcoin transaction privacy took off: “anonymous” payments.</p><blockquote class=twitter-tweet><p lang=en dir=ltr>WikiLeaks now accepts anonymous Bitcoin donations on 1HB5XMLmzFVj8ALj6mfBsbifRoD4miY36v</p>&mdash; WikiLeaks (@wikileaks) <a href="https://twitter.com/wikileaks/status/80774521350668288?ref_src=twsrc%5Etfw">June 14, 2011</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><p>This perception was never true and largely due to a lack of understanding of bitcoin’s underlying functionality. Further, almost no one was watching the blockchain in 2011. But the blockchain is forever.</p><p>Today law enforcement’s access to chain analytic tools has aided in many high profile <a href=https://www.coindesk.com/u-s-seized-more-than-1b-in-silk-road-linked-bitcoin-seeks-forfeiture-bloomberg>take-downs</a>. Chain surveillance firms clamor for first publication of blog posts on the latest “crime” using bitcoin for payment. The mainstays of old media are running headlines on bitcoin’s traceability.</p><div class=imageWrapper><img src=/img/oxt/oxt-2.png><p><em>Bitcoin is Traceable <a href=https://www.nytimes.com/2021/06/09/technology/bitcoin-untraceable-pipeline-ransomware.html>Headline</a></em></p></div><h3 id=traceability-is-mainstream>Traceability is mainstream.
<a class=anchor href=#traceability-is-mainstream>#</a></h3><p>The reality of bitcoin privacy, and what users are capable of when using bitcoin to make payments, lies somewhere between perfectly anonymous and perfectly traceable.</p><p>Most tracking techniques are reliant on heuristics and evaluating the flow of bitcoin. Without fundamental privacy enhancements at the protocol level, these techniques must be undermined at the application layer.</p><p>Early in bitcoin’s history, randomized wallet fingerprinting was used to defeat analytic heuristics. Tools such as custodial tumblers were used to defeat financial flow analyses at the risk of loss of funds. Today coinjoins and collaborative transactions allow for reasonable spending privacy with enhanced security over previous methods. However, much work remains to be done in automating privacy enhancements at the application layer.</p><p>We consider education among the remaining work to aid users in obtaining a basic level of financial privacy they are typically afforded by the legacy financial network. This is our main motivation for creating this documentation. In this guide we will cover the following:</p><ol><li>What “traceable” bitcoin really means including examples.</li><li>Defensive measures users can take to defeat tracking and why they work.</li><li>Practical considerations for users sending and receiving payments.</li></ol><h2 id=problem-statement--pseudonymous-bitcoin>Problem Statement — Pseudonymous Bitcoin
<a class=anchor href=#problem-statement--pseudonymous-bitcoin>#</a></h2><p>Bitcoin transaction activity is pseudonymous, not anonymous. A user’s true name and personal identification information (PII) is not included in the Bitcoin protocol. This provides a very basic level of privacy, as transaction activity must be attributed to an individual.</p><p>However, bitcoin transactions are made for transparent amounts to transparent addresses. Addresses are pseudonyms that represent an actual user’s activity, or more specifically, a private key’s activity.</p><div class=imageWrapper><img src=/img/oxt/oxt-3.png><p><em>Example Bitcoin <a href=https://oxt.me/transaction/ceb2daa77a281083cd1b07977adb87753801047753781a9e93ac9252f1c51b8c>Transaction</a></em></p></div><p>Bitcoin transactions are broadcast to the bitcoin network, and archived on the bitcoin ledger. The ledger, and any transactions included in the ledger, are viewable to anyone running a bitcoin node or with access to a web based blockchain explorer.</p><p>The transparency of this public information allows for an unprecedented ease of information access that is not possible with the traditional financial system.</p><p>Users can query a blockchain explorer through a web browser and observe the entire bitcoin network’s past transaction history. They can easily track the flows of bitcoin across multiple transactions.</p><p>Broadly, this practice has become synonymous with the terms traceability and chain analysis.</p><p>The most common form of chain analysis is focused on identification of transaction “change” outputs. The process is based on a series of heuristics that can be used to follow a user’s activity over multiple transactions.</p><p>If this on-chain activity leads to an identified economic entity’s wallet cluster, investigators may be able to obtain user PII associated with the observed transaction activity.</p><p><strong>From here we can glean two critical issues that can be used to attack a user privacy:</strong></p><ol><li>“Change” outputs can be used to track a users activity on the blockchain.</li><li>The intersection of this activity with entities that obtain PII links observed blockchain activity with a possible real identity.</li></ol><p>While item 2 is a critical part of what turns chain analysis into real world enforcement, this documentation will focus specifically on mitigation of the on-chain tracking.</p><h2 id=heuristics>Heuristics
<a class=anchor href=#heuristics>#</a></h2><p>Heuristics are rules of thumb used to make decisions under uncertain conditions. They are often based on practical shortcuts. Being shortcuts heuristics are not 100% accurate.</p><p>Much of traditional chain analysis is based on heuristics. The primary heuristics have to do with “change detection” in simple spends and the clustering of separate addresses by the common input ownership heuristic.</p><p>In isolation, these heuristics can be misleading and inaccurate. But when combined with additional transaction patterns or external data such as wallet cluster labeling, the short comings of these heuristics become less damaging to attempted tracking.</p><h2 id=unspent-transaction-outputs-utxos>Unspent Transaction Outputs (UTXOs)
<a class=anchor href=#unspent-transaction-outputs-utxos>#</a></h2><p>Bitcoin transactions are records of the flows of bitcoin between addresses.</p><p>Unspent transaction outputs (UTXOs) are “pieces of bitcoin” that are used to construct transactions. Transaction structure can be divided into inputs and outputs.</p><p>A user constructs a transaction by designating a payment address(es) and payment amount(s). These will be the <em>outputs</em> of the newly constructed transaction.</p><p>Typically wallet software will complete the transaction by algorithmically including UTXOs from previous transactions as <em>inputs</em> to the new transaction.</p><div class=imageWrapper><img src=/img/oxt/oxt-4-en.webp><p><em>Unspent Transaction Outputs (UTXOs)</em></p></div><p>There is a difference between an address and a UTXO. UTXOs are “pieces of bitcoin” paid to an address. The simplest way to visualize the difference is to understand that an address can receive multiple UTXOs, a process detrimental to privacy referred to as “address reuse”.</p><h2 id=example-transactions>Example Transactions
<a class=anchor href=#example-transactions>#</a></h2><p>There are several common categories of bitcoin transactions. These categories are inferred based on a transactions input and output profile along with our experience and observed cluster labeling. Examples of the major transaction types are provided below.</p><h3 id=simple-send>Simple Send
<a class=anchor href=#simple-send>#</a></h3><p>Simple spends are some of the most common transaction types and make up roughly 50% of bitcoin transactions in recent blocks (Source: <a href=https://transactionfee.info/charts/transactions-1in-2out/>transactionfee.info</a>).</p><p>These transaction types are evidence of typical user behavior, where a user makes a payment and receives a change output.</p><p><strong><em>Traits:</em></strong></p><ul><li>Number of Inputs: 1 (or more)</li><li>Number of Outputs: 2</li><li>Common Interpretation: 1 payment output, 1 change output</li></ul><div class=imageWrapper><img src=/img/oxt/oxt-5-en.webp><p><em>Simple Spend Transaction <a href=https://oxt.me/transaction/36e0f7c61e40a232829087ed3152519765b7fcf7be7d8574387cd1e694aa71b3>Example</a></em></p></div><h3 id=sweep>Sweep
<a class=anchor href=#sweep>#</a></h3><p>“Sweeps” spend the entirety of a single UTXO to a new address.</p><p><strong><em>Traits:</em></strong></p><ul><li>Number of Inputs: 1</li><li>Number of Outputs: 1</li><li>Common Interpretation: Possible self-transfer</li></ul><div class=imageWrapper><img src=/img/oxt/oxt-6-en.webp><p><em>“Sweep” Example <a href=https://oxt.me/transaction/ae4e6fe34a8c4e98339ca84c902946e68a8bb8a6cdcf63f19d6f201a7a403f0e>Transaction</a></em></p></div><h3 id=consolidation-spend>Consolidation Spend
<a class=anchor href=#consolidation-spend>#</a></h3><p>Consolidation transactions combine multiple UTXOs into a single UTXO. These are rarely “true payments” because a normal payment has a change output.</p><p><strong><em>Traits:</em></strong></p><ul><li>Number of Inputs: >1</li><li>Number of Outputs: 1</li><li>Common Interpretation: Possible self-transfer</li></ul><div class=imageWrapper><img src=/img/oxt/oxt-7-en.webp><p><em>Consolidation Spend Example <a href=https://oxt.me/transaction/8855ca21337c5b82a1970aea0f4c21c7284016c33caa1d26a6441c74f6a0ba57>Transaction</a></em></p></div><h3 id=batch-spend>Batch Spend
<a class=anchor href=#batch-spend>#</a></h3><p>Batch spends are most likely performed by exchanges and include 1 or more inputs and many outputs. These transactions aim to save on miner fees by making as many payments as possible in a single transaction.</p><p><strong><em>Traits:</em></strong></p><ul><li>Number of Inputs: ≥1</li><li>Number of Outputs: MANY</li><li>Common Interpretation: Large economic activity, likely exchange</li></ul><div class=imageWrapper><img src=/img/oxt/oxt-8-en.webp><p><em>Batch Spend Example <a href=https://oxt.me/transaction/3524f3e2bdd7c1a5e4bc116d3a55d650b67e37504258c731b9c7b63dc4425a45>Transaction</a></em></p></div><h3 id=multi-party-transactions-coinjoin>Multi-party Transactions (Coinjoin)
<a class=anchor href=#multi-party-transactions-coinjoin>#</a></h3><p>Multi-party transactions involve collaboration between many users to perform a single transaction that improves participant privacy. These transactions are easily identified by their equal output amounts.</p><p><strong><em>Traits:</em></strong></p><ul><li>Number of Inputs: MANY</li><li>Number of Outputs: MANY</li><li>Output Profile: Number of identical outputs is a proxy for number of participants.</li></ul><div class=imageWrapper><img src=/img/oxt/oxt-9-en.webp><p><em>Coinjoin Example <a href=https://oxt.me/transaction/00601af905bede31086d9b1b79ee8399bd60c97e9c5bba197bdebeee028b9bea>Transaction</a></em></p></div><h2 id=change-detection--simple-spend-interpretations>Change Detection — Simple Spend Interpretations
<a class=anchor href=#change-detection--simple-spend-interpretations>#</a></h2><p>In this section we are going to introduce transaction interpretations for simple spends (1 input, 2 outputs). This section will focus on the most common interpretation of these transactions, where one output is interpreted as a payment and the remaining output is interpreted as change back to the original wallet. A complete list of interpretations under this model are presented in Part III. The goal of this section is to familiarize the reader with the heuristics used to evaluate simple spends and detect a change output.</p><p>When observing a single transaction in isolation, we are presented with a limited amount of data that is included within the transaction. We refer to this information as internal transaction data.</p><p>Internal transaction data is limited to the following:</p><ul><li>amounts (input, output, miner fees)</li><li>input address script type</li><li>output address script type</li><li>transaction version number</li><li>transaction locktime</li><li>replace by fee signalling</li></ul><h3 id=change-detection>Change Detection
<a class=anchor href=#change-detection>#</a></h3><p>Due to miner fees, a normal bitcoin payment always requires spending a larger output amount than the intended payment amount.</p><p>When a single UTXO for a larger amount than the intended payment amount is consumed, the user will receive a change UTXO for the remainder back to an address generated by their wallet’s private key.</p><p>Much of traditional chain analysis is based on detecting this change output. If a change output can be successfully detected, a single user’s activity can be tracked across a series of transactions.</p><p>In this section we will detect change outputs based on internal transaction data. The heuristics are presented roughly in the order of decreasing effectiveness accuracy. Examples will be presented and annotated screenshots shown for aiding users in visualizing these concepts.</p><h3 id=address-reuse>Address Reuse
<a class=anchor href=#address-reuse>#</a></h3><p>Addresses are created by a single private key. Multiple uses of the same address are signs of activity of the same private key.</p><p>In a simple spend, if one output is to a new address, and the remaining output is to the same address as the input address, we know that the reused address is the change output.</p><p>Today, most bitcoin wallets will automatically generate a new address for receiving change outputs. However, a wallet can be configured to receive change to the same address as the transaction input. This behavior is typically indicative of centralized service wallet activities or old versions of the bitcoin core wallet.</p><div class=imageWrapper><img src=/img/oxt/oxt-10-en.webp><p><em>Address Reuse Example <a href=https://oxt.me/transaction/4c18b982836006cbe54661942f632f10b9cc0072e97a32feeea77abd8c7c8c3c>Transaction</a></em></p></div><h3 id=round-number-payment-heuristic>Round Number Payment Heuristic
<a class=anchor href=#round-number-payment-heuristic>#</a></h3><p>When a user initiates a payment, they input the payment destination (address), payment amount, and a network transaction fee into their wallet software. The wallet software will select input UTXOs and generate the change output (if there is one).</p><p>The change amount in a simple spend is calculated as follows:</p><p><code>input amount ➖ payment amount ➖ tx size (in vbytes) ✖️ network fee rate (in sat/vbyte)</code></p><p>It’s difficult for a user to generate a change output for a “round number amount” on purpose. In a simple spend, the round number output is the likely payment which makes the remaining output the change output.</p><div class=imageWrapper><img src=/img/oxt/oxt-11-en.webp><p><em>Round Number Payment Heuristic Example <a href=https://oxt.me/transaction/112c987fcb27c54452b8bbaff35a89c2aff3def5a132844fd58865c224d5169d>Transaction</a></em></p></div><h3 id=different-script-type-heuristic>Different Script Type Heuristic
<a class=anchor href=#different-script-type-heuristic>#</a></h3><p>There are several bitcoin address script types. Readers will be most familiar with the following script types:</p><ul><li>Pay to pubkey hash (P2PKH): Addresses starting with a 1</li><li>Pay to script script hash (P2SH): Addresses starting with a 3</li><li>Native Segwit (version 0)(bech32): Addresses starting with bc1q</li></ul><p>For a given input script type, if one output is to the same type as the input and the remaining output is to a new address script type, the output to the new address script type is the likely payment. Which makes the output to the same address address script type the likely change output.</p><p>In other words, an output to a different script type is the likely payment output. This heuristic can also be combined with the round number payment heuristic.</p><div class=imageWrapper><img src=/img/oxt/oxt-12-en.webp><p><em>Different Script Output Type Heuristic Example <a href=https://oxt.me/transaction/046c82240b8b29612c5b385b9bca6557f72f2bbeed0a043b3799f94a6c979f3d>Transaction</a></em></p></div><h3 id=largest-output-amount-heuristic>Largest Output Amount Heuristic
<a class=anchor href=#largest-output-amount-heuristic>#</a></h3><p>Another simple heuristic, assumes that the largest output amount is the likely change output. This is one of the weakest heuristics, particularly when taken in isolation, but as we will discuss in Part 2, this heuristic can be helpful in a transaction graph analysis.</p><div class=imageWrapper><img src=/img/oxt/oxt-13-en.webp><p><em>Largest Output Heuristic Example <a href=https://oxt.me/transaction/5005628082b902961c25fb6c9503e2ad11e84a75e07e8f24f5b425451f017af6>Transaction</a></em></p></div><h2 id=review-and-preview>Review And Preview
<a class=anchor href=#review-and-preview>#</a></h2><p>In this section we introduced many of the basic concepts around bitcoin transaction privacy. Pseudonymous bitcoin provides a basic level of privacy that is not directly associated with personal identifiable information.</p><p>However, the openness of the bitcoin protocol allows for the tracking of bitcoin flows. This concept is broadly referred to as “chain analysis”. A core focus of chain analysis focuses on detection of change outputs by making use of several heuristics. If successful, these heuristics allow for tracking a single users activity over multiple transactions.</p><p><a href=/en/privacy/oxt-2><strong>Part 2</strong></a> <strong>will introduce core concepts of chain analysis such as:</strong></p><ol><li>External transaction data, which can be used to weaken transaction privacy.</li><li>Transaction graph analysis, a main tool for tracking the flow of bitcoin over multiple transactions.</li><li>The common input ownership heuristic, also known as “wallet clustering” and its implication on the bitcoin network.</li><li>This section also includes a walk-through and examples of OXTs transaction graph tool and wallet clustering scheme.</li></ol><p><strong><a href=/en/privacy/oxt-3>Part 3</a> cover core concepts of improving bitcoin’s privacy including:</strong></p><ol><li>Randomized wallet fingerprinting for defeating change detection.</li><li>UTXO flows and the fundamental link between inputs and outputs.</li><li>How equal output coinjoins address the issue of deterministic flows.</li><li>Transaction entropy</li><li>How payjoin defeats the common input ownership heuristic</li></ol><p><strong><a href=/en/privacy/oxt-4>Part 4</a> discusses:</strong></p><ol><li>Analyses needing a “starting point”</li><li>The privacy implications of sending and receiving payments</li><li>How existing privacy techniques can mitigate many of the issues discussed throughout the guide.</li></ol><details><summary>Contents</summary><div class=markdown-inner><h2 id=understanding-bitcoin-privacy-with-oxt>Understanding Bitcoin Privacy with OXT
<a class=anchor href=#understanding-bitcoin-privacy-with-oxt>#</a></h2><p><a href=/en/privacy/oxt-1>Part 1: Chain Analysis And Transaction Privacy</a></p><p><a href=/en/privacy/oxt-2>Part 2: Chain Analysis Core Concepts</a></p><p><a href=/en/privacy/oxt-3>Part 3: Defences Against Chain Analysis</a></p><p><a href=/en/privacy/oxt-4>Part 4: Applying Chain Analysis Concepts To Improve User Privacy</a></p></div></details></article><hr><i>Connect to our relay to leave a comment. <a href=https://21ideas.org/en/comments/>Details</a>.<br>Подключитесь к нашему релею, чтобы оставить комментарий. <a href=https://21ideas.org/comments/>Подробнее</a>.</i>
<zap-threads anchor=https://21ideas.org/en/privacy/oxt-1/ author=npub1lm3f47nzyf0rjp6fsl4qlnkmzed4uj4h2gnf2vhe3l3mrj85vqks6z3c7l relays=wss://21ideas.nostr1.com disable=replyAnonymously legacy-url=true></zap-threads><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#introduction>Introduction</a><ul><li><a href=#traceability-is-mainstream>Traceability is mainstream.</a></li></ul></li><li><a href=#problem-statement--pseudonymous-bitcoin>Problem Statement — Pseudonymous Bitcoin</a></li><li><a href=#heuristics>Heuristics</a></li><li><a href=#unspent-transaction-outputs-utxos>Unspent Transaction Outputs (UTXOs)</a></li><li><a href=#example-transactions>Example Transactions</a><ul><li><a href=#simple-send>Simple Send</a></li><li><a href=#sweep>Sweep</a></li><li><a href=#consolidation-spend>Consolidation Spend</a></li><li><a href=#batch-spend>Batch Spend</a></li><li><a href=#multi-party-transactions-coinjoin>Multi-party Transactions (Coinjoin)</a></li></ul></li><li><a href=#change-detection--simple-spend-interpretations>Change Detection — Simple Spend Interpretations</a><ul><li><a href=#change-detection>Change Detection</a></li><li><a href=#address-reuse>Address Reuse</a></li><li><a href=#round-number-payment-heuristic>Round Number Payment Heuristic</a></li><li><a href=#different-script-type-heuristic>Different Script Type Heuristic</a></li><li><a href=#largest-output-amount-heuristic>Largest Output Amount Heuristic</a></li></ul></li><li><a href=#review-and-preview>Review And Preview</a></li></ul></li></ul></nav></div></aside></main><script>"use strict";const METRICS={FEE:"fee",BLOCK:"block",PRICE:"price",SATS:"sats",BTC:"btc"};let currentMetric=METRICS.FEE,lastKnownValues={fee:{label:"Комиссия",value:"0 sat/vB"},block:{label:"Высота блока",value:"0"},price:{label:"Цена",value:"$0"},sats:{label:"Московское время",value:"00:00"},btc:{label:"",value:"1 BTC = 1 BTC"}};function formatSatsAsTime(e){const t=Math.round(e).toString().padStart(4,"0"),n=t.slice(0,-2),s=t.slice(-2);return`${n}:${s}`}function formatNumber(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}function updateDisplay(){const n=document.getElementById("metrics-label"),e=document.getElementById("metrics-value");if(!n||!e)return;const t=lastKnownValues[currentMetric];n.textContent=t.label,e.textContent=t.value,e.style.paddingTop=t.label?"0":"0.7rem"}async function updateMetrics(){try{const[t,n,e]=await Promise.all([fetch("https://mempool.space/api/v1/fees/recommended").then(e=>e.json()),fetch("https://mempool.space/api/blocks/tip/height").then(e=>e.json()),fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd").then(e=>e.json())]);lastKnownValues.fee.value=`${t.fastestFee} sat/vB`,lastKnownValues.block.value=formatNumber(n),lastKnownValues.price.value=`$${formatNumber(e.bitcoin.usd)}`;const s=Math.round(1e8/e.bitcoin.usd);lastKnownValues.sats.value=formatSatsAsTime(s),updateDisplay()}catch(e){console.error("Error fetching metrics:",e)}}function cycleMetric(){const e=Object.values(METRICS),t=e.indexOf(currentMetric);currentMetric=e[(t+1)%e.length],updateDisplay()}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("metrics-container");e&&(e.addEventListener("click",cycleMetric),updateMetrics(),setInterval(updateMetrics,6e4))})</script></body></html>