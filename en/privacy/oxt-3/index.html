<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This content is also available in video format in this playlist. Contents ... Understanding Bitcoin Privacy with OXT # Part 1: Chain Analysis And Transaction Privacy
Part 2: Chain Analysis Core Concepts
Part 3: Defences Against Chain Analysis
Part 4: Applying Chain Analysis Concepts To Improve User Privacy
Introduction # With the foundational concepts of chain analysis introduced in Part 1 and Part 2, Part 3 will discuss the methods for undermining chain analysis."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta name=lightning content="21ideas@getalby.com"><meta property="og:title" content="Part 3: Defences Against Chain Analysis"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://21ideas.org/en/privacy/oxt-3/"><meta property="og:image" content="https://21ideas.org/img/oxt/oxt-3-cover.webp"><title>Part 3: Defences Against Chain Analysis | 21ideas</title><link rel=manifest href=/manifest.json><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon media="(prefers-color-scheme: dark)" sizes=180x180 href=/apple-touch-icon-dark.png><link rel=icon type=image/png media="(prefers-color-scheme: dark)" sizes=32x32 href=/favicon-32x32-dark.png><link rel=icon type=image/png media="(prefers-color-scheme: dark)" sizes=16x16 href=/favicon-16x16-dark.png><link rel=alternate hreflang=ru-ru href=https://21ideas.org/privacy/oxt-3/ title="Часть 3: Защита от анализа цепочки"><link rel=stylesheet href=/book.min.3ccd2c056255dd77a07f397725e829449ae55b167758de17b2708acc660f649c.css integrity="sha256-PM0sBWJV3Xegfzl3JegpRJrlWxZ3WN4XsnCKzGYPZJw=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.189721b45eebea92f982e4186c37b973bc180e84af8b0748596d50441df9a0d9.js integrity="sha256-GJchtF7r6pL5guQYbDe5c7wYDoSviwdIWW1QRB35oNk=" crossorigin=anonymous></script>
<script type=text/javascript src=https://unpkg.com/zapthreads@0.5.0/dist/zapthreads.iife.js></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/en/><picture><source srcset=/svg/logo_white.svg media="(prefers-color-scheme: dark)"><img src=/svg/logo_black.svg alt=Logo></picture>
<span>21ideas</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
English</a></label><ul><li><a href=https://21ideas.org/privacy/oxt-3/>Русский</a></li></ul></li></ul><ul><li><input type=checkbox id=section-512cd8dd047d9194f8b56568c3c961b4 class=toggle>
<label for=section-512cd8dd047d9194f8b56568c3c961b4 class="flex justify-between"><a role=button>Start</a></label><ul><li><a href=/en/start/start/>Что такое Биткоин?</a></li><li><a href=/en/start/guide/>Используем биткоин</a></li><li><a href=/en/kurs/>Биткоин от А до Я</a></li><li><a href=/en/razrushaem-mify-o-bitcoin/>Разрушаем мифы о Биткоине</a></li><li><a href=/en/shitcoin-gambling-games/>Don’t Play Shitcoin Gambling Games</a></li></ul></li><li><input type=checkbox id=section-4f53cbff6ac5b0f9cfca5f1f9f3b991c class=toggle checked>
<label for=section-4f53cbff6ac5b0f9cfca5f1f9f3b991c class="flex justify-between"><a href=/en/theory/>Theory</a></label><ul><li><input type=checkbox id=section-c4ddad175f26bb1d35909363eff62296 class=toggle>
<label for=section-c4ddad175f26bb1d35909363eff62296 class="flex justify-between"><a href=/en/economics/>Economics</a></label><ul><li><input type=checkbox id=section-182005e73bd80d066a67724ac5ed0bad class=toggle>
<label for=section-182005e73bd80d066a67724ac5ed0bad class="flex justify-between"><a href=/en/gradually-then-suddenly/>Gradually, Then Suddenly</a></label><ul><li><a href=/en/gradually-then-suddenly/intro/>Intro</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-cant-be-copied/>Bitcoin Can’t Be Copied</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-too-volatile/>Bitcoin Is Not Too Volatile</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-does-not-waste-energy/>Bitcoin Does Not Waste Energy</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-too-slow/>Bitcoin is Not Too Slow</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-fixes-this/>Bitcoin Fixes This</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-not-blockchain/>Bitcoin, Not Blockchain</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-backed-by-nothing/>Bitcoin is Not Backed by Nothing</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-a-pyramid-scheme/>Bitcoin is Not a Pyramid Scheme</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-cannot-be-banned/>Bitcoin Cannot be Banned</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-for-criminals/>Bitcoin is Not for Criminals</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-obsoletes-all-other-money/>Bitcoin Obsoletes All Other Money</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-a-rally-cry/>Bitcoin is a Rally Cry</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-common-sense/>Bitcoin is Common Sense</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-antifragile/>Bitcoin is Antifragile</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-one-for-all/>Bitcoin is One for All</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-the-great-definancialization/>Bitcoin is the Great Definancialization</a></li></ul></li><li><input type=checkbox id=section-7f9a42e8b73c082c7ee1415fd0eae7fb class=toggle>
<label for=section-7f9a42e8b73c082c7ee1415fd0eae7fb class="flex justify-between"><a href=/en/discovering-bitcoin/>Discovering Bitcoin</a></label><ul><li><a href=/en/discovering-bitcoin/intro/>Introduction</a></li><li><a href=/en/discovering-bitcoin/about-time/>About Time</a></li><li><a href=/en/discovering-bitcoin/about-people/>About People</a></li><li><a href=/en/discovering-bitcoin/introducing-money/>Introducing Money</a></li><li><a href=/en/discovering-bitcoin/a-wrong-turn-new-plan-needed/>A Wrong Turn (New Plan Needed)!</a></li><li><a href=/en/discovering-bitcoin/digital-scarcity/>Digital Scarcity</a></li><li><a href=/en/discovering-bitcoin/digital-contracts/>Digital Contracts</a></li><li><a href=/en/discovering-bitcoin/the-missing-pieces/>The Missing Pieces</a></li></ul></li><li><a href=/en/bitcoin-is-not-harmful-for-the-environment/>Bitcoin Is Not Harmful For The Environment</a></li><li><a href=/en/seven-network-effects-of-bitcoin/>The Seven Network Effects of Bitcoin</a></li><li><a href=/en/masters-and-slaves-of-money/>Masters and Slaves of Money</a></li><li><a href=/en/structural-adjustment/>Structural Adjustment</a></li><li><a href=/en/in-defense-of-deflation/>In Defense Of Deflation</a></li><li><a href=/en/comparison-of-monetary-standards/>Comparison of Monetary Standards</a></li><li><a href=/en/petrodollar-negative-effects/>Petrodollar Negative Effects</a></li><li><a href=/en/shelling-out/>Shelling Out: The Origins of Money</a></li><li><a href=/en/bitcoin-rhythms-of-history/>Bitcoin and the Rhythms of History</a></li><li><a href=/en/bitcoin-and-the-hopf-cycle-of-the-internet/>Bitcoin & the HOPF Cycle of the Internet</a></li><li><a href=/en/money-blockchains-and-social-scalability/>Money, blockchains, and social scalability</a></li><li><a href=/en/chto-takoe-dengi/>Что такое деньги</a></li><li><a href=/en/only-the-strong-survive/>Only The Strong Survive</a></li><li><a href=/en/dollar-cost-averaging/>Dollar-Cost Averaging</a></li><li><a href=/en/jevons-paradox/>Jevons Paradox: Contrary Truth</a></li></ul></li><li><input type=checkbox id=section-e83ea293497a2ab861101ccfc99a8ecc class=toggle>
<label for=section-e83ea293497a2ab861101ccfc99a8ecc class="flex justify-between"><a href=/en/security/>Security</a></label><ul><li><a href=/en/how-to-hold-private-keys/>Bitcoin Wallets: How, Why and When to Hold Your Own Private Keys</a></li><li><a href=/en/seed/>What is a bitcoin seed phrase and how does it work?</a></li><li><a href=/en/seed-security/>Ultimate guide to storing your bitcoin seed phrase backups</a></li><li><a href=/en/passphrase/>Is your passphrase strong enough?</a></li><li><a href=/en/what-is-multisig/>What is multisig?</a></li><li><a href=/en/hwws/>The best Bitcoin hardware wallets</a></li><li><a href=/en/multisig-1/>Multisig Part I: Why Multisig?</a></li><li><a href=/en/multisig-2/>Multisig Part II: Single Keys are the Foundation of Multisignature</a></li></ul></li><li><input type=checkbox id=section-e9552bdc5e196adcf41f88d9180bebda class=toggle checked>
<label for=section-e9552bdc5e196adcf41f88d9180bebda class="flex justify-between"><a href=/en/privacy/>Privacy</a></label><ul><li><a href=/en/privacy/best-practices/>Bitcoin Privacy: Best Practices</a></li><li><a href=/en/privacy/no-kyc/>no-KYC only. Avoid the creep</a></li><li><a href=/en/wiki-bitcoin-privacy/>Bitcoin Privacy</a></li><li><a href=/en/bitcoin-becomes-critical/>Bitcoin Becomes Critical</a></li><li><a href=/en/bip47-the-ugly-duckling/>BIP47, the ugly duckling</a></li><li><input type=checkbox id=section-197d372e28cf8111d6d38339599c8c1f class=toggle checked>
<label for=section-197d372e28cf8111d6d38339599c8c1f class="flex justify-between"><a href=/en/privacy/oxt/>Understanding Bitcoin Privacy with OXT</a></label><ul><li><a href=/en/privacy/oxt-1/>Part 1: Chain Analysis And Transaction Privacy</a></li><li><a href=/en/privacy/oxt-2/>Part 2: Chain Analysis Core Concepts</a></li><li><a href=/en/privacy/oxt-3/ class=active>Part 3: Defences Against Chain Analysis</a></li><li><a href=/en/privacy/oxt-4/>Part 4: Applying Chain Analysis Concepts To Improve User Privacy</a></li></ul></li><li><a href=/en/privacy/coinjoin/>CoinJoin Overview</a></li></ul></li><li><input type=checkbox id=section-e49feff8bdc4c8d9840548f297831fbc class=toggle>
<label for=section-e49feff8bdc4c8d9840548f297831fbc class="flex justify-between"><a href=/en/protocol/>Protocol</a></label><ul><li><a href=/en/who-controls-bitcoin-core/>Who Controls Bitcoin Core?</a></li><li><a href=/en/bitcoins-eternal-struggle/>Bitcoin's Eternal Struggle</a></li><li><a href=/en/on-bitcoins-ux/>On Bitcoin’s UX</a></li><li><a href=/en/bitcoin-zoloto-2-0/>Биткоин: цифровое золото или пиринговая наличность?</a></li><li><a href=/en/bitcoin-governance/>Bitcoin Governance</a></li><li><a href=/en/trusted-third-parties/>Trusted Third Parties are Security Holes</a></li><li><a href=/en/21-million-is-non-negotiable/>21 Million is Non-Negotiable</a></li><li><a href=/en/proof-of-work/>Proof of Work, a pictorial essay</a></li><li><a href=/en/proof-of-stake-is-a-scam/>Proof of stake is a scam</a></li><li><a href=/en/was-satoshi-a-greedy-miner/>Was Satoshi a Greedy Miner?</a></li><li><a href=/en/taproot/>What Is Taproot</a></li><li><a href=/en/coercion-of-ethereums-difficulty-bomb/>The Coercion Of Ethereum's Difficulty Bomb</a></li><li><a href=/en/rgb/>Understanding the RGB protocol</a></li><li><a href=/en/difficulty/>Bitcoin Difficulty Adjustment</a></li><li><a href=/en/bitcoin-address-types/>Bitcoin address types</a></li></ul></li><li><input type=checkbox id=section-8509d6019544d659ccbc67af32e91aea class=toggle>
<label for=section-8509d6019544d659ccbc67af32e91aea class="flex justify-between"><a href=/en/history/>History</a></label><ul><li><input type=checkbox id=section-aa23c48a9c39058e09f0c1d84d8ebaca class=toggle>
<label for=section-aa23c48a9c39058e09f0c1d84d8ebaca class="flex justify-between"><a href=/en/gf/>The Genesis Files</a></label><ul><li><a href=/en/gf/genesis-intro/>Intro</a></li><li><a href=/en/gf/genesis-1/>Part I: How David Chaum’s eCash Spawned a Cypherpunk Dream</a></li><li><a href=/en/gf/genesis-2/>Part II: Hashcash or How Adam Back Designed Bitcoin’s Motor Block</a></li><li><a href=/en/gf/genesis-3/>Part III: If Bitcoin Had a First Draft, Wei Dai’s B-Money Was It</a></li><li><a href=/en/gf/genesis-4/>Part IV: With Bit Gold, Szabo Was Inches Away From Inventing Bitcoin</a></li><li><a href=/en/gf/genesis-5/>Part V: How Hal Finney’s Quest For Digital Cash Led To RPOW (And More)</a></li></ul></li><li><a href=/en/hal-finney/>Hal Finney — The Life And Death Of A Cypherpunk Legend</a></li><li><a href=/en/bitcoin-reformation/>The Bitcoin Reformation</a></li></ul></li><li><input type=checkbox id=section-042f7e1a0906e66d4ceaeeb231b37175 class=toggle>
<label for=section-042f7e1a0906e66d4ceaeeb231b37175 class="flex justify-between"><a href=/en/philosophy/>Philosophy</a></label><ul><li><input type=checkbox id=section-1048f9a65fd469c32ebe9f1814dc2a1c class=toggle>
<label for=section-1048f9a65fd469c32ebe9f1814dc2a1c class="flex justify-between"><a href=/en/what-i-learned-from-bitcoin/>What I've Learned From Bitcoin</a></label><ul><li><a href=/en/what-i-learned-from-bitcoin-3/>Part III. Technological Teachings of Bitcoin</a></li><li><a href=/en/what-i-learned-from-bitcoin-2/>Part II. Economic Teachings of Bitcoin</a></li><li><a href=/en/what-i-learned-from-bitcoin-1/>Part I. Philosophical Teachings of Bitcoin</a></li></ul></li><li><a href=/en/not-shitcoin/>Why Bitcoin, Not Shitcoin</a></li><li><a href=/en/inalienable-property-rights/>Inalienable Property Rights</a></li><li><a href=/en/crypto-anarchist-manifesto/>The Crypto Anarchist Manifesto</a></li><li><a href=/en/cypherpunks-manifesto/>A Cypherpunk's Manifesto</a></li><li><a href=/en/dutch-tulip-bubble/>Is Bitcoin Like the Dutch Tulip Bubble?</a></li><li><a href=/en/everyones-a-scammer/>Everyone's a Scammer</a></li><li><a href=/en/freedom-of-value/>The Freedom of Value</a></li><li><a href=/en/bitcoin-meme/>Bitcoin Is The Only Real Meme</a></li><li><a href=/en/number-zero-and-bitcoin/>The Number Zero and Bitcoin</a></li><li><a href=/en/crypto-bro/>Dear Crypto & Fiat Bros</a></li><li><a href=/en/fighting-fake-bitcoin/>Fighting Fake Bitcoin</a></li><li><a href=/en/bitcoin-is-the-mycelium/>Bitcoin is The Mycelium of Money</a></li><li><a href=/en/proof-of-life/>Proof of Life. Why Bitcoin is a Living Organism</a></li><li><a href=/en/most-peaceful-revolution/>A Most Peaceful Revolution</a></li><li><a href=/en/bitcoin-universe/>Bitcoin Universe</a></li><li><a href=/en/bitcoin-dissidents/>Bitcoin Dissidents</a></li><li><a href=/en/bitcoin-equals-freedom/>Bitcoin Equals Freedom</a></li><li><a href=/en/myths-about-halving/>Myths About the Bitcoin Halving</a></li></ul></li><li><input type=checkbox id=section-66beb9b5ed04619b43509a5a9298b3a2 class=toggle>
<label for=section-66beb9b5ed04619b43509a5a9298b3a2 class="flex justify-between"><a href=/en/future/>Future</a></label><ul><li><input type=checkbox id=section-df24c55b3b01a044f159006399dd3f62 class=toggle>
<label for=section-df24c55b3b01a044f159006399dd3f62 class="flex justify-between"><a href=/en/ba/>Bitcoin Astronomy</a></label><ul><li><a href=/en/ba/1/>Part I</a></li><li><a href=/en/ba/2/>Part II</a></li><li><a href=/en/ba/3/>Part III</a></li></ul></li><li><a href=/en/hey-bitcoin-slow-down/>Hey Bitcoin, Slow Down!</a></li><li><a href=/en/apocalypse/>Can Bitcoin Survive An Apocalypse?</a></li><li><a href=/en/bitcoin-and-oceans/>Bitcoin and Ocean Thermal Energy</a></li></ul></li><li><input type=checkbox id=section-a71a3aee31fa8f939d269196bdc16bfd class=toggle>
<label for=section-a71a3aee31fa8f939d269196bdc16bfd class="flex justify-between"><a href=/en/lightning/>Lightning</a></label><ul><li><a href=/en/chto-takoe-laitning/>Что такое Лайтнинг?</a></li><li><a href=/en/lajtning-koshelki/>Лайтнинг-кошельки</a></li><li><a href=/en/lajtning-adresa/>Лайтнинг-адреса</a></li><li><a href=/en/lightning-network-privacy/>Lightning Network Privacy</a></li><li><a href=/en/is-lightning-centralized/>Is Lightning centralized?</a></li><li><a href=/en/lightning-network-explained/>Lightning Network Explained</a></li><li><a href=/en/inbound-liquidity-problem/>Solutions to inbound liquidity problem</a></li></ul></li></ul></li><li><input type=checkbox id=section-a6b5e5f811434cb992fdebac0e1d7718 class=toggle>
<label for=section-a6b5e5f811434cb992fdebac0e1d7718 class="flex justify-between"><a href=/en/practice/>Practice</a></label><ul><li><input type=checkbox id=section-5a7a56ff2c706814b0747555f55b45b2 class=toggle>
<label for=section-5a7a56ff2c706814b0747555f55b45b2 class="flex justify-between"><a role=button>Buy</a></label><ul><li><a href=/en/newbie-buy/>Покупка и хранение биткоина для новичков</a></li><li><a href=/en/hodl-hodl/>Покупка биткоина без KYC на Hodl Hodl</a></li><li><a href=/en/robosats/>RoboSats: Приватный p2p обмен</a></li></ul></li><li><input type=checkbox id=section-a2a499e8fa40193bb85003cabaff5d49 class=toggle>
<label for=section-a2a499e8fa40193bb85003cabaff5d49 class="flex justify-between"><a role=button>Hodl</a></label><ul><li><a href=/en/electrum/>Кошелек Электрум</a></li><li><a href=/en/blue/>Кошелек Blue</a></li><li><a href=/en/seedsigner/>SeedSigner: оффлайн-крепость для ваших биткоинов</a></li><li><a href=/en/coldcard/>Что такое Coldcard?</a></li></ul></li><li><input type=checkbox id=section-4e34fd6dae27eeab9274b5e370a300a7 class=toggle>
<label for=section-4e34fd6dae27eeab9274b5e370a300a7 class="flex justify-between"><a role=button>Interact</a></label><ul><li><a href=/en/practice/bitcoin-noda/>Каждому следует запустить собственную Биткоин-ноду!</a></li><li><a href=/en/orangepilling-in-5-min/>Orangepilling in 5 min</a></li><li><a href=/en/5-tips-for-teaching-bitcoin/>5 tips for teaching Bitcoin</a></li></ul></li><li><input type=checkbox id=section-ed813fe32867bdad9fbc116cfa115400 class=toggle>
<label for=section-ed813fe32867bdad9fbc116cfa115400 class="flex justify-between"><a href=/en/practice-privacy/>Privacy</a></label><ul><li><input type=checkbox id=section-20fa42a588c7405850eac56c7752c25b class=toggle>
<label for=section-20fa42a588c7405850eac56c7752c25b class="flex justify-between"><a href=/en/practice-privacy/dojo/>Dojo x86 Bitcoin Node Guide</a></label><ul><li><a href=/en/practice-privacy/dojo-0/>Introduction</a></li><li><a href=/en/practice-privacy/dojo-1/>Installing Bitcoin Core</a></li><li><a href=/en/practice-privacy/dojo-2/>Installing Fulcrum Indexer</a></li><li><a href=/en/practice-privacy/dojo-3/>Installing Mempool Explorer</a></li><li><a href=/en/practice-privacy/dojo-4/>Installing Samourai Dojo</a></li><li><a href=/en/practice-privacy/dojo-5/>Installing Whirlpool CLI & Firewall Config</a></li><li><a href=/en/practice-privacy/dojo-6/>Installing Package Updates</a></li></ul></li><li><a href=/en/practice-privacy/ronindojo/>RoninDojo x86 Installation Guide</a></li></ul></li><li><input type=checkbox id=section-0af442a82e8087438ae3e5d932bfcd3c class=toggle>
<label for=section-0af442a82e8087438ae3e5d932bfcd3c class="flex justify-between"><a href=/en/practice/lightning/>Lightning</a></label><ul><li><a href=/en/phoenix/>Кошелек Phoenix</a></li><li><a href=/en/lnbits/>LNbits</a></li><li><a href=/en/alby-i-nostr/>Alby и Nostr</a></li><li><a href=/en/zapplanner/>Подписки с помощью Лайтнинг</a></li><li><a href=/en/lntips/>Телеграм-бот @LightningTipBot</a></li><li><a href=/en/ochishchaem-bitcoin-cherez-lajtning/>Очищаем биткоины через сеть Лайтнинг</a></li><li><a href=/en/lightning-liquidity-management-guide/>Lightning Liquidity Management Guide</a></li></ul></li></ul></li><li><input type=checkbox id=section-4f9efbc916a788429edff50248f79330 class=toggle>
<label for=section-4f9efbc916a788429edff50248f79330 class="flex justify-between"><a href=/en/rabbithole/>Rabbithole</a></label><ul><li><input type=checkbox id=section-dd34bc6fc687d6e6fb62acabc34277a6 class=toggle>
<label for=section-dd34bc6fc687d6e6fb62acabc34277a6 class="flex justify-between"><a href=/en/books/>Books</a></label><ul><li><a href=/en/whitepaper/>Белая книга</a></li><li><input type=checkbox id=section-e3198834b11fdb517332c04453209400 class=toggle>
<label for=section-e3198834b11fdb517332c04453209400 class="flex justify-between"><a href=/en/izobretaem-bitkoin/>Изобретаем Биткоин</a></label><ul><li><a href=/en/izobretaem-bitkoin/vstuplenie/>Вступление</a></li><li><a href=/en/izobretaem-bitkoin/glava-1/>Глава 1: Что такое Биткоин</a></li><li><a href=/en/izobretaem-bitkoin/glava-2/>Глава 2: Отказываемся от посредника</a></li><li><a href=/en/izobretaem-bitkoin/glava-3/>Глава 3: Proof of Work</a></li><li><a href=/en/izobretaem-bitkoin/glava-4/>Глава 4: Майнинг</a></li><li><a href=/en/izobretaem-bitkoin/glava-5/>Глава 5: Обеспечение безопасности реестра</a></li><li><a href=/en/izobretaem-bitkoin/glava-6/>Глава 6: Форки и атаки 51%</a></li><li><a href=/en/izobretaem-bitkoin/glava-7/>Глава 7: Учетные записи, не идентифицирующие личность</a></li><li><a href=/en/izobretaem-bitkoin/glava-8/>Глава 8: Кто устанавливает правила?</a></li><li><a href=/en/izobretaem-bitkoin/glava-9/>Глава 9: Что дальше?</a></li></ul></li><li><input type=checkbox id=section-f289993761aca4a4b180363fe368f984 class=toggle>
<label for=section-f289993761aca4a4b180363fe368f984 class="flex justify-between"><a href=/en/suverenitet-posredstvom-matematiki/>Суверенитет посредством математики</a></label><ul><li><a href=/en/suverenitet-posredstvom-matematiki/intro/>Предисловие</a></li><li><a href=/en/suverenitet-posredstvom-matematiki/glava-1/>Глава 1: Вся наша жизнь — торговля</a></li><li><a href=/en/suverenitet-posredstvom-matematiki/glava-2/>Глава 2: Финансовый атеизм</a></li><li><a href=/en/suverenitet-posredstvom-matematiki/glava-3/>Глава 3: Доверчивость</a></li><li><a href=/en/suverenitet-posredstvom-matematiki/glava-4/>Глава 4: Непорочное зачатие</a></li><li><a href=/en/suverenitet-posredstvom-matematiki/glava-5/>Глава 5: Proof of Work</a></li><li><a href=/en/suverenitet-posredstvom-matematiki/glava-6/>Глава 6: Редкость</a></li><li><a href=/en/suverenitet-posredstvom-matematiki/glava-7/>Глава 7: Ходл Он</a></li><li><a href=/en/suverenitet-posredstvom-matematiki/glava-8/>Глава 8: Изменение правил</a></li><li><a href=/en/suverenitet-posredstvom-matematiki/glava-9/>Глава 9: Деньги как акселератор</a></li><li><a href=/en/suverenitet-posredstvom-matematiki/glava-10/>Глава 10: Окружающая среда</a></li><li><a href=/en/suverenitet-posredstvom-matematiki/glava-11/>Глава 11: Новая форма жизни</a></li><li><a href=/en/suverenitet-posredstvom-matematiki/glava-12/>Глава 12: Будущее</a></li><li><a href=/en/suverenitet-posredstvom-matematiki/mysli/>Размышления</a></li></ul></li><li><input type=checkbox id=section-e5860353bd62663c37a33bec590802ab class=toggle>
<label for=section-e5860353bd62663c37a33bec590802ab class="flex justify-between"><a href=/en/bychij-kejs-dlya-bitcoin/>Бычий кейс для Биткоина</a></label><ul><li><a href=/en/bychij-kejs-dlya-bitcoin/predislovie/>Предисловие от Майкла Сэйлора</a></li><li><a href=/en/bychij-kejs-dlya-bitcoin/prolog/>Пролог</a></li><li><a href=/en/bychij-kejs-dlya-bitcoin/glava-1/>Глава 1: Генезис и происхождение денег</a></li><li><a href=/en/bychij-kejs-dlya-bitcoin/glava-2/>Глава 2: Атрибуты хорошего средства сбережения</a></li><li><a href=/en/bychij-kejs-dlya-bitcoin/glava-3/>Глава 3: Эволюция денег</a></li><li><a href=/en/bychij-kejs-dlya-bitcoin/glava-4/>Глава 4: Форма монетизации</a></li><li><a href=/en/bychij-kejs-dlya-bitcoin/glava-5/>Глава 5: Новая денежная база</a></li><li><a href=/en/bychij-kejs-dlya-bitcoin/epilog/>Эпилог</a></li></ul></li><li><input type=checkbox id=section-4b442928210bf7bb8d82eb48c684874d class=toggle>
<label for=section-4b442928210bf7bb8d82eb48c684874d class="flex justify-between"><a href=/en/21-sposob/>21 способ</a></label><ul><li><a href=/en/21-sposob/vvedenie/>Введение</a></li><li><a href=/en/21-sposob/glava-0/>Глава 0</a></li><li><a href=/en/21-sposob/glava-01/>Глава 0.1</a></li><li><a href=/en/21-sposob/glava-1-bitcoin-eto-ideya/>Глава 1. Биткоин — это идея</a></li><li><a href=/en/21-sposob/glava-2-bitcoin-eto-vremya/>Глава 2. Биткоин — это время</a></li><li><a href=/en/21-sposob/glava-3-bitcoin-volshebnye-internet-dengi/>Глава 3. Биткоин — волшебные интернет-деньги</a></li><li><a href=/en/21-sposob/glava-6-bitcoin-eto-cifrovaya-redkost/>Глава 6. Биткоин – это цифровая редкость</a></li></ul></li><li><input type=checkbox id=section-4821edbebdbff526db8aaad627df8c2e class=toggle>
<label for=section-4821edbebdbff526db8aaad627df8c2e class="flex justify-between"><a href=/en/suverennaya-lichnost/>Суверенная личность</a></label><ul><li><a href=/en/suverennaya-lichnost/glava-1/>Глава 1: Переходный период 2000 года</a></li><li><a href=/en/suverennaya-lichnost/rezyume/>Резюме</a></li><li><a href=/en/suverennaya-lichnost/glava-2/>Глава 2: Метаполитические трансформации в исторической перспективе</a></li><li><a href=/en/suverennaya-lichnost/glava-3/>Глава 3: К востоку от Эдема</a></li><li><a href=/en/suverennaya-lichnost/glava-4/>Глава 4: Последние дни политики</a></li><li><a href=/en/suverennaya-lichnost/glava-5/>Глава 5: Самочувствие национального государства</a></li><li><a href=/en/suverennaya-lichnost/glava-6/>Глава 6: Мегаполитика информационной эпохи</a></li><li><a href=/en/suverennaya-lichnost/glava-7/>Глава 7: Выход за рамки локальности</a></li><li><a href=/en/suverennaya-lichnost/glava-8/>Глава 8: Конец уравнительной экономики</a></li><li><a href=/en/suverennaya-lichnost/glava-9/>Глава 9: Национализм, реакция и новые луддиты</a></li><li><a href=/en/suverennaya-lichnost/glava-10/>Глава 10: Сумерки демократии</a></li><li><a href=/en/suverennaya-lichnost/glava-11/>Мораль и преступность в “естественной экономике” информационного века</a></li></ul></li><li><input type=checkbox id=section-c0b499506f23962152d4aaeec11bead1 class=toggle>
<label for=section-c0b499506f23962152d4aaeec11bead1 class="flex justify-between"><a href=/en/vojna-za-razmer-bloka/>Война за размер блока</a></label><ul><li><a href=/en/vojna-za-razmer-bloka/glava-1/>Глава 1: Первый удар</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-2/>Глава 2: Начало</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-3/>Глава 3: Масштабирование I Монреаль</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-4/>Глава 4: Масштабирование II Гонконг</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-5/>Глава 5: SegWit</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-6/>Глава 6: Сеть Lightning</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-7/>Глава 7: Bitcoin Classic</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-8/>Глава 8: Круглый стол в Гонконге</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-9/>Глава 9: Фейковый Сатоши</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-10/>Глава 10: DAO</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-11/>Глава 11: Масштабирование III Милан</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-12/>Глава 12: Bitcoin Unlimited</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-13/>Глава 13: Биржи</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-14/>Глава 14: ASICBoost</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-15/>Глава 15: Логово драконов</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-16/>Глава 16: Litecoin</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-17/>Глава 17: UASF – Активируемый пользователями софтфорк</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-18/>Глава 18: Нью-Йоркское соглашение</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-19/>Глава 19: Bitcoin Cash</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-20/>Глава 20: SegWit2x</a></li><li><a href=/en/vojna-za-razmer-bloka/glava-21/>Глава 21: Победа</a></li></ul></li><li><input type=checkbox id=section-e3c67eeeb417643514d32de865decd82 class=toggle>
<label for=section-e3c67eeeb417643514d32de865decd82 class="flex justify-between"><a href=/en/cena/>Цена завтрашнего дня</a></label><ul><li><a href=/en/cena/predislovie/>Предисловие</a></li><li><a href=/en/cena/vvedenie/>Введение</a></li><li><a href=/en/cena/1/>Печать денег</a></li></ul></li><li><a href=/en/anil-slides/>Презентации Анила</a></li><li><a href=/en/bitcoin-money/>Биткоин-деньги</a></li><li><a href=/en/v-zaschitu-defliazii-book/>В защиту дефляции</a></li><li><a href=/en/doroga-k-rabstvu/>Дорога к рабству</a></li></ul></li><li><a href=/en/videos/>Видео</a><ul></ul></li><li><a href=/en/audiobooks/>Audiobooks</a><ul></ul></li><li><a href=/en/pods/>Podcasts</a><ul></ul></li></ul></li></ul><div class=menuSep></div><ul><li><input type=checkbox id=section-d90442343f58c582906ebc7e255e7116 class=toggle>
<label for=section-d90442343f58c582906ebc7e255e7116 class="flex justify-between"><a href=/en/contribute/>Contribute</a></label><ul><li><a href=/en/syntax/>Оформление статей</a></li><li><a href=/en/github/>Adding an Article</a></li><li><a href=/en/obsidian/>Публикация статей через Obsidian</a></li></ul></li><li><span>Blog</span></li><li><a href=/en/feedback/>Feedback</a></li></ul></nav><footer><br><a class=menuSocialButton href=https://t.me/bitcoin21ideas target=_blank title=Telegram><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg"><path d="m12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12c0-6.627-5.373-12-12-12zm5.894 8.221-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.446 1.394c-.14.18-.357.295-.6.295-.002.0-.003.0-.005.0l.213-3.054 5.56-5.022c.24-.213-.054-.334-.373-.121L8.32 13.617l-2.96-.924c-.64-.203-.658-.64.135-.954l11.566-4.458c.538-.196 1.006.128.832.941z"/></svg></a>&nbsp;
<a class=menuSocialButton href=https://github.com/21ideas-org/21ideas.org target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 820 820"><path d="M4e2 9.9C179.11 9.9.0 189 0 409.94.0 585.6 113.24 734.86 270.71 788.61l2.83.83c20 3.76 27.34-8.59 27.34-19.24.0-9.49-.32-34.68-.5-68-111.27 24.14-134.75-53.68-134.75-53.68a106.58 106.58.0 00-44.09-58.26l-.43-.24c-36.23-24.81 2.8-24.3 2.8-24.3A84.06 84.06.0 01185 606.54l.22.4a85.24 85.24.0 00116.92 33l-.43.21A85.16 85.16.0 01327 586.7C238.19 576.67 144.8 542.25 144.8 389c0-.72.0-1.55.0-2.38a153.82 153.82.0 0141.27-105l-.08.11a139.82 139.82.0 01-8.56-48.58 141.91 141.91.0 0112.4-58.21l-.37.91s33.51-10.72 110 41c30-8.56 64.43-13.5 1e2-13.5a378.09 378.09.0 01102.68 14.14l-2.67-.64c76-51.72 109.51-41 109.51-41a144 144 0 0112 58.07 145.56 145.56.0 01-8.35 48.82l.32-1a154.37 154.37.0 0141 105c0 .83.0 1.63.0 2.43V389c0 153.68-93.5 187.51-182.52 197.35a95.48 95.48.0 0127.27 66.93c0 2.48-.11 5-.3 7.42v-.32c0 53.54-.51 96.54-.51 109.53.0 10.51 7 23 27.51 19C686.25 734.78 8e2 585.39 8e2 409.41 8e2 188.74 621.11 9.87 400.47 9.87H4e2z"/></svg></a>&nbsp;
<a class=menuSocialButton href=https://njump.me/npub1lm3f47nzyf0rjp6fsl4qlnkmzed4uj4h2gnf2vhe3l3mrj85vqks6z3c7l target=_blank title=Nostr><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 820 820"><path d="M4e2 797.5c219.53.0 397.5-178 397.5-397.5S619.53 2.5 4e2 2.5 2.5 180.47 2.5 4e2 180.47 797.5 4e2 797.5zM598.23 242.15c6.82 8.46 10.35 18.14 11.45 28.86 1.7 16.37-2.68 31.17-11.2 45-14.19 23.62-43.17 39.63-45.85 41-5.42 2.86-7.42 7.12-7.06 13.34s-1.21 37.19-20 50.83c-9.68 7-48.64 16-66.6 19.05a28.61 28.61.0 00-13.18 5.37c-1 .67-2 1.36-3.2 2.06-6.82 4.27-31.23 38-35.31 45.48l10.66-3.27c21.2-6.53 66.85-20.6 69.52-21 9-1.4 15.89 1.22 20.34 7.79 3.63 5.41 7.18 10.81 10.75 16.25.61.94 1.23 1.87 1.85 2.81 1 1.54 2 3.08 2.93 4.62.48.78 1 1.55 1.45 2.32l1.52 2.38c.09.14.19.29.28.45a10.65 10.65.0 011.37 2.83c.24 1 .91 4.14-.92 6.09-1.7 1.77-4.63 1.77-6.21 1.34a15.65 15.65.0 01-5.6-2.8l-2.49-2.13c-2-1.71-5.73-2.56-8.71-2.44-3.41.13-8-1-10.11-2.37-4.2-2.74-5.35-9.56-5.35-9.68a3.51 3.51.0 00-3.72-2.86 18.58 18.58.0 00-6.28 1.15l-.78.25q-15 4.56-29.93 9.24h0l-14.31 4.45c-7.06 2.19-14.12 4.38-21.13 6.69a37.45 37.45.0 00-5.72 2.62c-.43.21-.84.43-1.25.64l-1.24.64h0c-.85.42-1.7.85-2.55 1.34l-.27.15a30.59 30.59.0 01-5.76 2.65c-7.12 2.13-13.39-1-16.32-8.1-1.88-4.63-.18-13.76.86-16.44 5.58-14.35 21.77-39.58 26.28-46.6.75-1.17 1.17-1.83 1.17-1.86-.36-.12-23.25 9.07-27 11.93-10.35 7.86-34.64 26.49-35 28.31A22.75 22.75.0 01331 508.13c-5.66 2.19-9.13 6.7-12.48 11.08.0.0-60.88 83.83-65 88.34l-.68.74c-2.83 3-12.28 13.16-15 18.13-.46.83-1.61 3.27-2.58 5.33-.6 1.26-1.13 2.38-1.38 2.89.0.05-.05.11-.08.17-.59 1.21-1.91 3.9-6.31 3.66s-4.79-6.12-5-9.09v-.4c-.54-6.88 1-13.7 4.63-20.82a6.46 6.46.0 01.31-.58c1-1.8 3.93-7 2.61-11.36s-2.61-11.14-.6-14.61c2.84-4.77 7.62-5.48 13.92-6.41l2.64-.41c5.29-.85 9.13-3.53 12.84-8.88 4.66-6.84 17-24.51 27.65-39.67C293.62 516 3e2 507 302.66 503.09a25.55 25.55.0 003.77-9.08c1.89-9.74 7.85-16.49 18.14-20.7 2.25-.85 43.17-35.06 43.17-39.45.0-3.1-4.45-4.87-7.92-5.78-.48-.12-26.24-6.82-37.92-12.12A88.58 88.58.0 01305 406.41c-7.53-5.54-22.23-3.16-25.3-2.67l-.27.05c-11 1.58-19.12 6.51-28.37 12.78-1.65 1.16-10.05 4.2-14.31 1.77-1.32-.75-2.9-1.6-4.65-2.54-9.16-4.92-22.91-12.31-28.59-20.9-3.11-4.69-2.68-12.42-.49-20.94 7.07-19.73 17.48-28.56 36.77-33.91 11.39-3.95 32.41-5.33 46.84-6.28 2.93-.19 5.59-.37 7.84-.54.12-.05.8-.09 1.94-.18 7-.51 31.32-2.27 49.13-11.39 1.61-.82 3.59-1.92 5.91-3.2 17.67-9.8 55.68-30.86 107.76-29.25 12.95.4 32.15 7.45 49.77 13.93 14.79 5.43 28.46 10.45 36.38 10.79 17.65.73 26.54-1.22 36.77-11.81 2.92-3.05 15.16-29.53 3.59-44a108.64 108.64.0 00-13.94-14.55q-2.28-1.94-4.59-3.85a183.79 183.79.0 01-15.8-14.29c-13.82-14.61-18.09-34.58-11.51-50.17 4.14-10.9 13-15.65 25.63-13.15 6.22 1.24 11.28 5.49 15.95 9.41a73.24 73.24.0 005.84 4.59c3.6 2.38 9.56 3.78 13.46 4.69 4.93 1.16 8.65 4.93 8.4 7.49s-6.7 4.75-13 4.26c-7.36-.49-20.09-.55-27.7 2-5.05 1.83-7.3 7.49-5.84 13 1.22 4.57 10.9 12.66 14.55 15.65 1.64 1.35 3.3 2.67 5 4C587.86 231.81 593.56 236.34 598.23 242.15z" fill-rule="evenodd"/></svg></a>&nbsp;
<a class=menuSocialButton href=/rss title=RSS><svg xmlns="http://www.w3.org/2000/svg" viewBox="-143 145 525 525"><path d="M113 145c-141.4.0-256 114.6-256 256s114.6 256 256 256 256-114.6 256-256S254.4 145 113 145zM43.1 518.7c-6.2 6.2-14.7 9.9-24.1 9.9-9.4.0-17.8-3.8-24-9.9-6.2-6.2-10-14.6-10-23.9.0-9.4 3.8-17.8 10-24s14.6-10 24-10 17.9 3.8 24 10c6.2 6.2 10 14.6 10 24C53 504.2 49.2 512.6 43.1 518.7zM104.8 529c-.1-32.1-12.5-62.3-35.1-84.9-22.6-22.6-52.8-35.2-84.7-35.2V360c46.6.0 88.7 19 119.3 49.6s49.5 72.8 49.6 119.4H104.8zm87.2.0c-.1-114.2-92.8-207.1-206.9-207.1V273c70.6.0 134.5 28.7 180.8 75.1 46.3 46.4 75 110.3 75.1 180.9H192z"/></svg></a></footer><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Part 3: Defences Against Chain Analysis</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#introduction>Introduction</a></li><li><a href=#the-utxo-ownership-model--ambiguity-of-simple-spends>The UTXO Ownership Model & Ambiguity Of Simple Spends</a></li><li><a href=#defeating-change-detection-heuristics>Defeating Change Detection Heuristics</a><ul><li><a href=#round-number-payment-heuristic-defences>Round Number Payment Heuristic Defences</a></li><li><a href=#identical-change-output-script-type>Identical Change Output Script Type</a></li><li><a href=#randomised-change-output-position>Randomised Change Output Position</a></li><li><a href=#evaluate-the-transaction-including-external-transaction-data>Evaluate the Transaction Including External Transaction Data</a></li></ul></li><li><a href=#utxo-flows-and-deterministic-spends>UTXO Flows And Deterministic Spends</a></li><li><a href=#breaking-links--non-deterministic-transactions>Breaking Links — Non Deterministic Transactions</a></li><li><a href=#entropy--equal-output-coinjoins-and-when-is-it-appropriate-to-apply-the-cioh>Entropy — Equal Output CoinJoins And When Is It Appropriate To Apply The CIOH</a><ul><li><a href=#kycp-transaction-interpretation>KYCP Transaction Interpretation</a></li></ul></li><li><a href=#coinjoins--equal-output-encryption-vs-payjoin-steganography>CoinJoins — Equal Output (Encryption) vs. PayJoin (Steganography)</a></li><li><a href=#other-techniques--breaking-the-transaction-graph>Other Techniques — “Breaking” The Transaction Graph</a></li><li><a href=#review>Review</a></li></ul></li></ul></nav></aside></header><div class=pageCover><picture><img src=/img/oxt/oxt-3-cover.webp alt=Cover></picture></div><h1>Part 3: Defences Against Chain Analysis</h1><div class=pageDate>August 9, 2021</div><article class=markdown><blockquote class="book-hint info"><em>This content is also available in video format in <a href="https://www.youtube.com/playlist?list=PLIBmWVGQhizLrPjpFMN5bQdbOZRxCQXUg">this playlist</a>.</em></blockquote><div class=book-expand><label><div class="book-expand-head flex justify-between"><span>Contents</span>
<span>...</span></div><input type=checkbox class=hidden><div class="book-expand-content markdown-inner"><h2 id=understanding-bitcoin-privacy-with-oxt>Understanding Bitcoin Privacy with OXT
<a class=anchor href=#understanding-bitcoin-privacy-with-oxt>#</a></h2><p><a href=/en/privacy/oxt-1>Part 1: Chain Analysis And Transaction Privacy</a></p><p><a href=/en/privacy/oxt-2>Part 2: Chain Analysis Core Concepts</a></p><p><a href=/en/privacy/oxt-3>Part 3: Defences Against Chain Analysis</a></p><p><a href=/en/privacy/oxt-4>Part 4: Applying Chain Analysis Concepts To Improve User Privacy</a></p></div></label></div><h2 id=introduction>Introduction
<a class=anchor href=#introduction>#</a></h2><p>With the foundational concepts of chain analysis introduced in <a href=/en/privacy/oxt-1>Part 1</a> and <a href=/en/privacy/oxt-2>Part 2</a>, Part 3 will discuss the methods for undermining chain analysis.</p><p>In this section we will present the following:</p><ol><li>defeating heuristics for change detection in simple spends</li><li>creating an ambiguous transaction graph with equal output coinjoins</li><li>undermining the CIOH with coinjoins</li></ol><h2 id=the-utxo-ownership-model--ambiguity-of-simple-spends>The UTXO Ownership Model & Ambiguity Of Simple Spends
<a class=anchor href=#the-utxo-ownership-model--ambiguity-of-simple-spends>#</a></h2><p>Previously, we introduced change detection heuristics for simple spends with 1 input and 2 outputs. We <strong><em>assumed</em></strong> that the transaction included a payment and change output.</p><p>In reality, a simple spend has many additional interpretations based on the UTXO “ownership model”. The ownership model attempts to assign ownership to the inputs and outputs of a transaction. The complete ownership interpretations for a transaction with 1 input and 2 outputs are shown in figure below.</p><div class=imageWrapper><img src=/img/oxt/oxt-29-en.webp><p><em>UTXO Ownership Model for Simple Spend</em></p></div><p>Each of these interpretations must be considered by an analyst, especially when only applying internal transaction data. Interpretations can be eliminated when accounting for additional wallet fingerprinting, normal wallet behaviour, and typical user behaviour.</p><p>Typical user behaviour makes interpretations 1 and 2 most likely. Interpretations 3 and 4 are possible, though many bitcoin wallets to do not have batch spend functionality. Interpretation 5 is rare due to extra fees paid and UTXO set bloat.</p><p>The application of external transaction data such as outputs sent to centralised services or reused addresses, can be used to eliminate interpretations. Due to the concentration of the bitcoin transaction graph around centralised services and patterns of normal user behaviour, these full interpretations are rarely considered in practice.</p><h2 id=defeating-change-detection-heuristics>Defeating Change Detection Heuristics
<a class=anchor href=#defeating-change-detection-heuristics>#</a></h2><p>Transactions can be made more ambiguous by wallet software that aims to defeat the heuristics for change detection presented in Part 1. When taken in isolation, the transaction below is an example of a “maximally” ambiguous simple spend.</p><div class=imageWrapper><img src=/img/oxt/oxt-30-en.webp><p><em>Ambiguous Simple Spend (<a href=https://oxt.me/transaction/e610d6ab26878c9f37502b3f31755ae5066d9e982613c6042757d8972d412a84>TxID</a>)</em></p></div><h3 id=round-number-payment-heuristic-defences>Round Number Payment Heuristic Defences
<a class=anchor href=#round-number-payment-heuristic-defences>#</a></h3><p>The payment amount is determined by the user. If a user selects a round payment amount, it is difficult for a wallet to protect against this heuristic in a simple spend. For most true payments (priced in fiat), this heuristic is less likely to apply. The example in figure above does not have a round number payment amount and maintains protection against this heuristic.</p><h3 id=identical-change-output-script-type>Identical Change Output Script Type
<a class=anchor href=#identical-change-output-script-type>#</a></h3><p>The example transaction has identical output script types for both outputs so the unique script output heuristic does not apply. This helps to maintain ambiguity and makes change detection more difficult.</p><h3 id=randomised-change-output-position>Randomised Change Output Position
<a class=anchor href=#randomised-change-output-position>#</a></h3><p>To further increase the ambiguity of this wallet’s behaviour over a series of transactions, wallet software must randomise the change output position. Alternating the change position between output 0 and 1 would make the automated tracking of wallets like the activity shown in Fig 2.8 more difficult.</p><h3 id=evaluate-the-transaction-including-external-transaction-data>Evaluate the Transaction Including External Transaction Data
<a class=anchor href=#evaluate-the-transaction-including-external-transaction-data>#</a></h3><p>OXT’s transaction graph shows relative UTXO and transaction amounts by varying line weights. In this way, expanding the transaction graph automatically includes some external transaction data.</p><p><em>Based on the transaction graph and future UTXO spending, which output might be the payment? Do the addresses in this transaction have any previous history of reuse?</em></p><p>This is a perfect example of how external transaction data can be used to aid in determining payments and establishing a change output. Expand the transaction graph or follow the future UTXO spending to verify your payment/change assumption.</p><h2 id=utxo-flows-and-deterministic-spends>UTXO Flows And Deterministic Spends
<a class=anchor href=#utxo-flows-and-deterministic-spends>#</a></h2><p>Identical change output scripts and randomised change positions can be applied by wallets to maintain the ambiguity of simple spends, but they do not address the fundamental link between inputs and outputs consumed in a transaction.</p><p>A link always exists between a transaction’s inputs and outputs. These intra-transaction UTXO relationships can be thought of as “flows”. Where the BTC consumed by input UTXOs are transferred to the output UTXOs.</p><div class=imageWrapper><img src=/img/oxt/oxt-31-en.webp><p><em>UTXO Flow Visualization via OXT Tx Graph (<a href=https://oxt.me/transaction/e610d6ab26878c9f37502b3f31755ae5066d9e982613c6042757d8972d412a84>TxID</a>)</em></p></div><p>In the case of a simple spend (1 input and 2 outputs), the single input must have been used to pay both outputs. A simple spend’s intra-transaction flows only have a single interpretation. As a result, the link between the single input and each output is mathematically deterministic (<strong>certain</strong>).</p><p>The link between inputs and outputs can be displayed on the OXT transaction graph by selecting an input or output. The transaction visualiser at <a href=http://kycp.org/>kycp.org</a> also shows the intra-transaction links.</p><div class=imageWrapper><img src=/img/oxt/oxt-32-en.webp><p><em>UTXO Flow Visualisation via KYCP (<a href=https://kycp.org/#/e610d6ab26878c9f37502b3f31755ae5066d9e982613c6042757d8972d412a84>TxID</a>)</em></p></div><h2 id=breaking-links--non-deterministic-transactions>Breaking Links — Non Deterministic Transactions
<a class=anchor href=#breaking-links--non-deterministic-transactions>#</a></h2><p>Though UTXO ownership ambiguity always exists, the UTXO ownership model cannot be relied upon to obfuscate on-chain BTC flows. Without breaking deterministic links and introducing ambiguity into the transaction graph, bitcoins remain “traceable”.</p><p>Breaking deterministic links and creating on-chain ambiguity requires a specific transaction structure. Determinism is dependent on the number of transaction inputs, outputs, and the BTC amounts of each UTXO.</p><p>By themselves, transactions with multiple inputs and outputs can create a noisy transaction graph. These types of transactions are not easily interpreted without special tooling or considerations.</p><div class=imageWrapper><img src=/img/oxt/oxt-33.png><p><em>Series of Multi-Input and Output Transactions Example (<a href=https://oxt.me/transaction/c7d1e40ae001a7fe4c860f9b7ddddcf9b5a3dad461466744e9b5e28c4b47e6b7>TxID</a>)</em></p></div><p>Despite the noisy transaction graph, deterministic links between UTXOs of transactions with multiple inputs and outputs can still be evaluated. Kristov Atlas was the first to introduce this concept in his “<a href=https://github.com/kristovatlas/coinjoin-sudoku>CoinJoin Sudoku</a>” advisory and algorithm.</p><p>In a coinjoin, users pool their funds and collaborate to construct a transaction. Typically by creating a transaction with equal output amounts. The CoinJoin Sudoku algorithm uses a branch of mathematics called subset sum analysis to evaluate transactions for “common ownership” of inputs and outputs.</p><p>A discussion of these maths is beyond the scope of this guide, but the important takeaway is that a naively constructed coinjoin transaction can be evaluated for deterministic links.</p><p>Today, the coinjoin sudoku concept has been extended with the <a href=https://code.samourai.io/oxt/boltzmann>Boltzmann</a> algorithm created by the OXT lead developer, <a href=https://twitter.com/laurentmt>LaurentMT</a>. Boltzmann uses the CoinJoin Sudoku concept to evaluate transactions for several privacy related metrics.</p><p>For properly constructed coinjoins, <strong>a link between inputs and equal outputs still exists, however these links are probabalistic not deterministic</strong>. The Boltzmann algorithm calculates a Link Probability Matrix (LPM) for the relationship between a transactions inputs and outputs.</p><p>A transaction’s LPM output can be found on the TRANSACTION page on OXT. In the INPUTS&amp;OUTPUTS tab, the link subset between an input and each output can be seen by clicking the “CHAIN ICON” to the right of the desired UTXO.</p><div class=imageWrapper><img src=/img/oxt/oxt-34-en.webp><p><em>OXT Link Matrix Subset (<a href=https://oxt.me/transaction/3a7455d3f04709870f7148f9f9c8d6c8a3fd83e8c76afadf6a4acd613afdb53e>TxID</a>)</em></p></div><p>The LPM for selected UTXOs in evaluated transactions can also be found by selecting inputs and outputs on the OXT Transaction graph (see Fig 3.3). A visual of the full LPM produced by Boltzmann’s algorithm can be found at <a href=http://kycp.org/>kycp.org</a>.</p><div class=imageWrapper><img src=/img/oxt/oxt-35.png><p><em>KYCP UTXO Flows and LPM (<a href=https://kycp.org/#/aed291496b2e3fed785881a8600a0fa58dfbc706e3f9ac1f9052839b596c175a>TxID</a>)</em></p></div><h2 id=entropy--equal-output-coinjoins-and-when-is-it-appropriate-to-apply-the-cioh>Entropy — Equal Output CoinJoins And When Is It Appropriate To Apply The CIOH
<a class=anchor href=#entropy--equal-output-coinjoins-and-when-is-it-appropriate-to-apply-the-cioh>#</a></h2><p>In an equal output coinjoin, multiple users collaborate to create a transaction that pools their funds and breaks the deterministic links between their transaction input and equal output.</p><p>By including multiple users, these transactions also break the CIOH. Assuming inputs to transactions that could be coinjoins are controlled by a single wallet could result in a false positive wallet cluster by the CIOH.</p><p>To avoid this an analyst could apply an equal output heuristic to transactions that may be coinjoins. However, all transactions having multiple equal outputs are not necessarily coinjoins. If constructed naively, transactions with multiple equal outputs may still have deterministic links between inputs and <strong>equal outputs</strong>, which is evidence that a transaction is <strong>not</strong> a coinjoin.</p><div class=imageWrapper><img src=/img/oxt/oxt-36-en.webp><p><em>Equal Output Transaction with Deterministic Links (<a href=https://kycp.org/#/a9b5563592099bf6ed68e7696eeac05c8cb514e21490643e0b7a9b72dac90b07>TxID</a>)</em></p></div><p>Instead of incorrectly clustering a transaction or naively excluding transactions with identical outputs, analysts can truly evaluate transactions for coinjoin properties using Boltzmann.</p><p>Boltzmann effectively uses subset sum analysis to ask the question: <em>Are there multiple ways (interpretations) a transaction’s inputs could have paid its outputs?</em></p><p>If a transaction has multiple intra-UTXO flow interpretations, Boltzmann will score the transaction’s entropy greater than or equal to 0. The concept of entropy originates from a thermodynamic mental model. In this model, the number of interpretations can be thought of as <em>microstates</em> of the overall transaction <em>macrostate</em>.</p><p><strong><em>Entropy can be seen as a metric measuring the analysts lack of knowledge about the exact configuration of the transaction being observed.</em></strong></p><p>Transactions with entropy have coinjoin properties and broken deterministic links. Coinjoin properties are evidence that a transaction has multiple users contributing inputs to the transaction. Conservatively, the inputs to transactions with entropy should not be clustered by the CIOH.</p><div class=imageWrapper><img src=/img/oxt/oxt-37.png><p><em>KYCP Evaluation of a DarkWallet Coinjoin (<a href=https://kycp.org/#/8e56317360a548e8ef28ec475878ef70d1371bee3526c017ac22ad61ae5740b8>TxID</a>)</em></p></div><h3 id=kycp-transaction-interpretation>KYCP Transaction Interpretation
<a class=anchor href=#kycp-transaction-interpretation>#</a></h3><p>KYCP includes a significant amount of transaction information including address reuse across the transaction, deterministic and probabilistic links, and input and output merges. The example transaction above is a dark wallet coinjoin transaction. The deterministic links for equal outputs are broken, but deterministic links still exist between the inputs and “change outputs”. Also note that output 1 and 3 are sent (merged) into the same future transaction. Indicating that the same users/wallets are mixing together again.</p><h2 id=coinjoins--equal-output-encryption-vs-payjoin-steganography>CoinJoins — Equal Output (Encryption) vs. PayJoin (Steganography)
<a class=anchor href=#coinjoins--equal-output-encryption-vs-payjoin-steganography>#</a></h2><p>Equal output coinjoins have a unique on-chain footprint that can be identified by the presence of multiple equal outputs. But the flows across the transaction for equal outputs are not deterministic. If an analyst knows they are observing a coinjoin, they must consider the user they are attempting to track controls one of the many equal outputs. In most cases this is enough to stop an analyst in his tracks.</p><div class=imageWrapper><img src=/img/oxt/oxt-38.png><p><em>Whirlpool Coinjoin Transaction Graph (<a href=https://kycp.org/#/323df21f0b0756f98336437aa3d2fb87e02b59f1946b714a7b09df04d429dec2>TxID</a>)</em></p></div><p>When an analyst encounters an equal output coinjoin, they know a privacy technique is being used but cannot reliably interpret the transaction. In this way, equal output coinjoins are similar to <strong>encryption</strong>. Observers of encrypted messages know a message exists (can observe the coinjoin) but cannot decipher the message (reliably interpret the flows across the transaction).</p><p>The other type of coinjoin is called payjoin or pay-to-end-point or Stowaway in Samourai Wallet. Payjoin transactions consist of a collaborative transaction between the user making a payment and the user receiving a payment. On the blockchain, many payjoins have no discernible patterns or applicable heuristics.</p><p>In effect, payjoins are indistinguishable from a normal transaction where a user spends multiple UTXOs. Without any distinguishable on chain transaction footprint, an analyst may incorrectly apply the CIOH to these types of transactions and incorrectly assume each of the inputs are controlled by the same user.</p><p>In this way payjoin transactions are a <strong>steganographic</strong> technique. Steganography is the process of hiding a secret message (the fact that a coinjoin has occurred) within otherwise normal appearing data (a normal transaction spending multiple inputs). Because payjoins do not have any reliable on-chain footprint, they often result in false clusters by the CIOH.</p><h2 id=other-techniques--breaking-the-transaction-graph>Other Techniques — “Breaking” The Transaction Graph
<a class=anchor href=#other-techniques--breaking-the-transaction-graph>#</a></h2><p>Custodial tumblers, often referred to generically as mixers, are one of the oldest privacy techniques employed at the application layer. The purpose of custodial tumblers is to act as a swap service. Users deposit coins to the tumbler and (hopefully) receive different UTXOs with a new transaction history in return. Ideally, the swapping process results in a “broken” transaction graph that severs the link between a user’s deposits and withdrawals.</p><p>This techniques also popularised the concept of “taint”. Where tumbler users may unknowingly receive UTXOs with some “problematic history” as a part of their swap. Interested readers can see our evaluations of two of the largest custodial tumblers (ChipMixer and Blender) from <a href=https://research.oxt.me/publications>our investigation of the Kucoin Hack.</a></p><p>Additional privacy enhancements such as coinswaps aim to break the transaction graph in a non-custodial way. These techniques are still in their infancy. Without additional mitigation, these theoretical swaps will suffer from the same “taint” swapping issues as custodial tumblers. This section will be updated as additional techniques are deployed.</p><h2 id=review>Review
<a class=anchor href=#review>#</a></h2><p>In Part 3 we introduced the many tools capable of defeating the main heuristics of chain analysis.</p><p>Change detection heuristics can be defeated by avoiding round payment amounts, creating transactions with identical change output script types, and randomising change output positions.</p><p>Equal output coinjoins are collaborative transactions involving multiple users. By breaking deterministic links these transactions create ambiguous transaction graphs. By involving multiple users, they defeat the CIOH.</p><p>Payjoin transactions are also collaborative transactions. They involve the payer and payee in creating a transaction and have the same transaction fingerprint as a normal multi-input spend. Without an identifiable fingerprint, these transactions defeat the CIOH.</p><p><strong><a href=/en/privacy/oxt-4>Part 4</a> discusses:</strong></p><ol><li>Analyses needing a “starting point”</li><li>The privacy implications of sending and receiving payments</li><li>How existing privacy techniques can mitigate many of the issues discussed throughout the guide.</li></ol><div class=book-expand><label><div class="book-expand-head flex justify-between"><span>Contents</span>
<span>...</span></div><input type=checkbox class=hidden><div class="book-expand-content markdown-inner"><h2 id=understanding-bitcoin-privacy-with-oxt>Understanding Bitcoin Privacy with OXT
<a class=anchor href=#understanding-bitcoin-privacy-with-oxt>#</a></h2><p><a href=/en/privacy/oxt-1>Part 1: Chain Analysis And Transaction Privacy</a></p><p><a href=/en/privacy/oxt-2>Part 2: Chain Analysis Core Concepts</a></p><p><a href=/en/privacy/oxt-3>Part 3: Defences Against Chain Analysis</a></p><p><a href=/en/privacy/oxt-4>Part 4: Applying Chain Analysis Concepts To Improve User Privacy</a></p></div></label></div></article><hr>Подключитесь к нашему релею, чтобы оставить комментарий. <a href=https://21ideas.org/comments/>Подробнее</a>.
<zap-threads anchor=https://21ideas.org/en/privacy/oxt-3/ author=npub1lm3f47nzyf0rjp6fsl4qlnkmzed4uj4h2gnf2vhe3l3mrj85vqks6z3c7l relays=wss://21ideas.nostr1.com disable=replyAnonymously><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#introduction>Introduction</a></li><li><a href=#the-utxo-ownership-model--ambiguity-of-simple-spends>The UTXO Ownership Model & Ambiguity Of Simple Spends</a></li><li><a href=#defeating-change-detection-heuristics>Defeating Change Detection Heuristics</a><ul><li><a href=#round-number-payment-heuristic-defences>Round Number Payment Heuristic Defences</a></li><li><a href=#identical-change-output-script-type>Identical Change Output Script Type</a></li><li><a href=#randomised-change-output-position>Randomised Change Output Position</a></li><li><a href=#evaluate-the-transaction-including-external-transaction-data>Evaluate the Transaction Including External Transaction Data</a></li></ul></li><li><a href=#utxo-flows-and-deterministic-spends>UTXO Flows And Deterministic Spends</a></li><li><a href=#breaking-links--non-deterministic-transactions>Breaking Links — Non Deterministic Transactions</a></li><li><a href=#entropy--equal-output-coinjoins-and-when-is-it-appropriate-to-apply-the-cioh>Entropy — Equal Output CoinJoins And When Is It Appropriate To Apply The CIOH</a><ul><li><a href=#kycp-transaction-interpretation>KYCP Transaction Interpretation</a></li></ul></li><li><a href=#coinjoins--equal-output-encryption-vs-payjoin-steganography>CoinJoins — Equal Output (Encryption) vs. PayJoin (Steganography)</a></li><li><a href=#other-techniques--breaking-the-transaction-graph>Other Techniques — “Breaking” The Transaction Graph</a></li><li><a href=#review>Review</a></li></ul></li></ul></nav></div></aside></main></body></html>