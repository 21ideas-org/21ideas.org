<!doctype html><html lang=en dir=ltr><head><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&display=swap" rel=stylesheet><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="While Bitcoin can support strong privacy, many ways of using it are usually not very private. With a proper understanding of the technology, bitcoin can indeed be used in a very private and anonymous way."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta name=lightning content="21ideas@getalby.com"><meta property="og:title" content="Bitcoin Privacy"><meta property="og:description" content="While Bitcoin can support strong privacy, many ways of using it are usually not very private. With a proper understanding of the technology, bitcoin can indeed be used in a very private and anonymous way."><meta property="og:type" content="article"><meta property="og:url" content="https://21ideas.org/en/wiki-bitcoin-privacy/"><meta property="og:image" content="https://21ideas.org/img/priv-903.jpeg"><title>Bitcoin Privacy | 21ideas</title>
<link rel=manifest href=/manifest.json><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon media="(prefers-color-scheme: dark)" sizes=180x180 href=/apple-touch-icon-dark.png><link rel=icon type=image/png media="(prefers-color-scheme: dark)" sizes=32x32 href=/favicon-32x32-dark.png><link rel=icon type=image/png media="(prefers-color-scheme: dark)" sizes=16x16 href=/favicon-16x16-dark.png><link rel=alternate hreflang=ru-RU href=https://21ideas.org/privatnost-v-seti-bitcoin/ title="Приватность в сети Биткоин"><link rel=stylesheet href=/book.min.a88fda41628a86b0aa4a3caa9c8ab466ee8e01a433898186e506a93fb98f1884.css integrity="sha256-qI/aQWKKhrCqSjyqnIq0Zu6OAaQziYGG5QapP7mPGIQ=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script><script defer src=/en.search.min.05dff3f422690a54d2e4a82801d50d875bfcbecb8b4f97baf8bbf394e5efba10.js integrity="sha256-Bd/z9CJpClTS5KgoAdUNh1v8vsuLT5e6+LvzlOXvuhA=" crossorigin=anonymous></script><script type=text/javascript src=https://unpkg.com/zapthreads@0.5.2/dist/zapthreads.iife.js></script><script defer src=https://cloud.umami.is/script.js data-website-id=0affba7d-3c1d-4235-adb3-635b69b6f567></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/en/><picture><source srcset=/svg/logo_white.svg media="(prefers-color-scheme: dark)"><img src=/svg/logo_black.svg alt=Logo>
</picture><span>21ideas</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
English</a></label><ul><li><a href=https://21ideas.org/privatnost-v-seti-bitcoin/>Русский</a></li></ul></li></ul><ul><li><input type=checkbox id=section-2c1fc68ff68c3e454d055a4d37a4816d class=toggle>
<label for=section-2c1fc68ff68c3e454d055a4d37a4816d class="flex justify-between"><a role=button>Start</a></label><ul><li><a href=/en/start/start/>Bitcoin Basics</a></li><li><a href=/en/start/guide/>Using Bitcoin</a></li><li><a href=/en/shitcoin-gambling-games/>Don’t Play Shitcoin Gambling Games</a></li></ul></li><li><input type=checkbox id=section-0e947b637002f54ca330500896114bfb class=toggle checked>
<label for=section-0e947b637002f54ca330500896114bfb class="flex justify-between"><a href=/en/theory/>Theory</a></label><ul><li><input type=checkbox id=section-c8c88ad6975c3c08b99f7a6aaa8233c7 class=toggle>
<label for=section-c8c88ad6975c3c08b99f7a6aaa8233c7 class="flex justify-between"><a href=/en/economics/>Economics</a></label><ul><li><input type=checkbox id=section-042039620ae77f503533b4129302aa25 class=toggle>
<label for=section-042039620ae77f503533b4129302aa25 class="flex justify-between"><a href=/en/gradually-then-suddenly/>Gradually, Then Suddenly</a></label><ul><li><a href=/en/gradually-then-suddenly/intro/>Intro</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-cant-be-copied/>Bitcoin Can’t Be Copied</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-too-volatile/>Bitcoin Is Not Too Volatile</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-does-not-waste-energy/>Bitcoin Does Not Waste Energy</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-too-slow/>Bitcoin is Not Too Slow</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-fixes-this/>Bitcoin Fixes This</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-not-blockchain/>Bitcoin, Not Blockchain</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-backed-by-nothing/>Bitcoin is Not Backed by Nothing</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-a-pyramid-scheme/>Bitcoin is Not a Pyramid Scheme</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-cannot-be-banned/>Bitcoin Cannot be Banned</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-not-for-criminals/>Bitcoin is Not for Criminals</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-obsoletes-all-other-money/>Bitcoin Obsoletes All Other Money</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-a-rally-cry/>Bitcoin is a Rally Cry</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-common-sense/>Bitcoin is Common Sense</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-antifragile/>Bitcoin is Antifragile</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-one-for-all/>Bitcoin is One for All</a></li><li><a href=/en/gradually-then-suddenly/bitcoin-is-the-great-definancialization/>Bitcoin is the Great Definancialization</a></li></ul></li><li><input type=checkbox id=section-dcadc98a07b7e2ce216dc99178d52c35 class=toggle>
<label for=section-dcadc98a07b7e2ce216dc99178d52c35 class="flex justify-between"><a href=/en/discovering-bitcoin/>Discovering Bitcoin</a></label><ul><li><a href=/en/discovering-bitcoin/intro/>Introduction</a></li><li><a href=/en/discovering-bitcoin/about-time/>About Time</a></li><li><a href=/en/discovering-bitcoin/about-people/>About People</a></li><li><a href=/en/discovering-bitcoin/introducing-money/>Introducing Money</a></li><li><a href=/en/discovering-bitcoin/a-wrong-turn-new-plan-needed/>A Wrong Turn (New Plan Needed)!</a></li><li><a href=/en/discovering-bitcoin/digital-scarcity/>Digital Scarcity</a></li><li><a href=/en/discovering-bitcoin/digital-contracts/>Digital Contracts</a></li><li><a href=/en/discovering-bitcoin/the-missing-pieces/>The Missing Pieces</a></li></ul></li><li><a href=/en/bitcoin-is-not-harmful-for-the-environment/>Bitcoin Is Not Harmful For The Environment</a></li><li><a href=/en/seven-network-effects-of-bitcoin/>The Seven Network Effects of Bitcoin</a></li><li><a href=/en/masters-and-slaves-of-money/>Masters and Slaves of Money</a></li><li><a href=/en/structural-adjustment/>Structural Adjustment</a></li><li><a href=/en/in-defense-of-deflation/>In Defense Of Deflation</a></li><li><a href=/en/comparison-of-monetary-standards/>Comparison of Monetary Standards</a></li><li><a href=/en/petrodollar-negative-effects/>Petrodollar Negative Effects</a></li><li><a href=/en/shelling-out/>Shelling Out: The Origins of Money</a></li><li><a href=/en/bitcoin-rhythms-of-history/>Bitcoin and the Rhythms of History</a></li><li><a href=/en/bitcoin-and-the-hopf-cycle-of-the-internet/>Bitcoin & the HOPF Cycle of the Internet</a></li><li><a href=/en/money-blockchains-and-social-scalability/>Money, blockchains, and social scalability</a></li><li><a href=/en/what-is-money/>What Is Money</a></li><li><a href=/en/only-the-strong-survive/>Only The Strong Survive</a></li><li><a href=/en/dollar-cost-averaging/>Dollar-Cost Averaging</a></li><li><a href=/en/jevons-paradox/>Jevons Paradox: Contrary Truth</a></li></ul></li><li><input type=checkbox id=section-7607f4888796b50750900ae1fa41174c class=toggle>
<label for=section-7607f4888796b50750900ae1fa41174c class="flex justify-between"><a href=/en/security/>Security</a></label><ul><li><a href=/en/how-to-hold-private-keys/>Bitcoin Wallets: How, Why and When to Hold Your Own Private Keys</a></li><li><a href=/en/seed/>What is a bitcoin seed phrase and how does it work?</a></li><li><a href=/en/seed-security/>Ultimate guide to storing your bitcoin seed phrase backups</a></li><li><a href=/en/passphrase/>Is your passphrase strong enough?</a></li><li><a href=/en/what-is-multisig/>What is multisig?</a></li><li><a href=/en/hwws/>The best Bitcoin hardware wallets</a></li><li><a href=/en/multisig-1/>Multisig Part I: Why Multisig?</a></li><li><a href=/en/multisig-2/>Multisig Part II: Single Keys are the Foundation of Multisignature</a></li></ul></li><li><input type=checkbox id=section-6e81d9ae00d8c0e44f4b6c22008f433f class=toggle checked>
<label for=section-6e81d9ae00d8c0e44f4b6c22008f433f class="flex justify-between"><a href=/en/privacy/>Privacy</a></label><ul><li><a href=/en/privacy/best-practices/>Bitcoin Privacy: Best Practices</a></li><li><a href=/en/privacy/no-kyc/>no-KYC only. Avoid the creep</a></li><li><a href=/en/wiki-bitcoin-privacy/ class=active>Bitcoin Privacy</a></li><li><a href=/en/bitcoin-becomes-critical/>Bitcoin Becomes Critical</a></li><li><a href=/en/bip47-the-ugly-duckling/>BIP47, the ugly duckling</a></li><li><input type=checkbox id=section-fa948e4e97baac946689641ce96c1e94 class=toggle>
<label for=section-fa948e4e97baac946689641ce96c1e94 class="flex justify-between"><a href=/en/privacy/oxt/>Understanding Bitcoin Privacy with OXT</a></label><ul><li><a href=/en/privacy/oxt-1/>Part 1: Chain Analysis And Transaction Privacy</a></li><li><a href=/en/privacy/oxt-2/>Part 2: Chain Analysis Core Concepts</a></li><li><a href=/en/privacy/oxt-3/>Part 3: Defences Against Chain Analysis</a></li><li><a href=/en/privacy/oxt-4/>Part 4: Applying Chain Analysis Concepts To Improve User Privacy</a></li></ul></li><li><a href=/en/privacy/coinjoin/>CoinJoin Overview</a></li><li><a href=/en/bitcoin-fungibility/>Bitcoin Fungibility</a></li><li><a href=/en/freesamourai/>#FreeSamourai</a></li></ul></li><li><input type=checkbox id=section-7703f58e8cfca24f7e8f10e99f7fd772 class=toggle>
<label for=section-7703f58e8cfca24f7e8f10e99f7fd772 class="flex justify-between"><a href=/en/protocol/>Protocol</a></label><ul><li><a href=/en/who-controls-bitcoin-core/>Who Controls Bitcoin Core?</a></li><li><a href=/en/bitcoins-eternal-struggle/>Bitcoin's Eternal Struggle</a></li><li><a href=/en/on-bitcoins-ux/>On Bitcoin’s UX</a></li><li><a href=/en/bitcoin-digital-gold-or-ecash/>Bitcoin: Digital Gold or Peer-to-Peer Cash?</a></li><li><a href=/en/bitcoin-governance/>Bitcoin Governance</a></li><li><a href=/en/trusted-third-parties/>Trusted Third Parties are Security Holes</a></li><li><a href=/en/21-million-is-non-negotiable/>21 Million is Non-Negotiable</a></li><li><a href=/en/proof-of-work/>Proof of Work, a pictorial essay</a></li><li><a href=/en/proof-of-stake-is-a-scam/>Proof of stake is a scam</a></li><li><a href=/en/was-satoshi-a-greedy-miner/>Was Satoshi a Greedy Miner?</a></li><li><a href=/en/segwit/>What Is SegWit</a></li><li><a href=/en/taproot/>What Is Taproot</a></li><li><a href=/en/coercion-of-ethereums-difficulty-bomb/>The Coercion Of Ethereum's Difficulty Bomb</a></li><li><a href=/en/rgb/>Understanding the RGB protocol</a></li><li><a href=/en/difficulty/>Bitcoin Difficulty Adjustment</a></li><li><a href=/en/bitcoin-address-types/>Bitcoin address types</a></li><li><a href=/en/myths-about-halving/>Myths About the Bitcoin Halving</a></li><li><a href=/en/mining-walkthrough/>SHA256 and Bitcoin Mining Walkthrough</a></li><li><input type=checkbox id=section-f1564ca04cb3a2764bdfe28910075cd7 class=toggle>
<label for=section-f1564ca04cb3a2764bdfe28910075cd7 class="flex justify-between"><a href=/en/protocol/utxo/>What Is UTXO And How To Manage Them</a></label><ul><li><a href=/en/protocol/utxo-1/>What is a Bitcoin UTXO</a></li><li><a href=/en/protocol/utxo-2/>Too Many UTXOs: How To Avoid High Fees</a></li><li><a href=/en/protocol/utxo-3/>UTXOs Privacy</a></li></ul></li><li><a href=/en/transaction-size/>Transaction Size</a></li><li><a href=/en/on-ossification/>On Ossification</a></li></ul></li><li><input type=checkbox id=section-3b225c8aaa13f68b831829121e8a96ea class=toggle>
<label for=section-3b225c8aaa13f68b831829121e8a96ea class="flex justify-between"><a href=/en/history/>History</a></label><ul><li><input type=checkbox id=section-6a04f6b3dd7c2dea74ad7a9a3b27156f class=toggle>
<label for=section-6a04f6b3dd7c2dea74ad7a9a3b27156f class="flex justify-between"><a href=/en/gf/>The Genesis Files</a></label><ul><li><a href=/en/gf/genesis-intro/>Intro</a></li><li><a href=/en/gf/genesis-1/>Part I: How David Chaum’s eCash Spawned a Cypherpunk Dream</a></li><li><a href=/en/gf/genesis-2/>Part II: Hashcash or How Adam Back Designed Bitcoin’s Motor Block</a></li><li><a href=/en/gf/genesis-3/>Part III: If Bitcoin Had a First Draft, Wei Dai’s B-Money Was It</a></li><li><a href=/en/gf/genesis-4/>Part IV: With Bit Gold, Szabo Was Inches Away From Inventing Bitcoin</a></li><li><a href=/en/gf/genesis-5/>Part V: How Hal Finney’s Quest For Digital Cash Led To RPOW (And More)</a></li></ul></li><li><a href=/en/hal-finney/>Hal Finney — The Life And Death Of A Cypherpunk Legend</a></li><li><a href=/en/bitcoin-and-me/>Bitcoin and Me</a></li><li><a href=/en/bitcoin-reformation/>The Bitcoin Reformation</a></li><li><a href=/en/bitcoin-forks/>A complete history of Bitcoin’s consensus forks</a></li><li><a href=/en/analyzing-2013-fork/>Analyzing the 2013 Bitcoin fork</a></li></ul></li><li><input type=checkbox id=section-8deaa51eea3af90eb190b70b9511c351 class=toggle>
<label for=section-8deaa51eea3af90eb190b70b9511c351 class="flex justify-between"><a href=/en/philosophy/>Philosophy</a></label><ul><li><input type=checkbox id=section-c0de4237ba1d1d542c91bf085525457d class=toggle>
<label for=section-c0de4237ba1d1d542c91bf085525457d class="flex justify-between"><a href=/en/what-i-learned-from-bitcoin/>What I've Learned From Bitcoin</a></label><ul><li><a href=/en/what-i-learned-from-bitcoin-1/>Part I. Philosophical Teachings of Bitcoin</a></li><li><a href=/en/what-i-learned-from-bitcoin-2/>Part II. Economic Teachings of Bitcoin</a></li><li><a href=/en/what-i-learned-from-bitcoin-3/>Part III. Technological Teachings of Bitcoin</a></li></ul></li><li><a href=/en/not-shitcoin/>Why Bitcoin, Not Shitcoin</a></li><li><a href=/en/inalienable-property-rights/>Inalienable Property Rights</a></li><li><a href=/en/crypto-anarchist-manifesto/>The Crypto Anarchist Manifesto</a></li><li><a href=/en/cypherpunks-manifesto/>A Cypherpunk's Manifesto</a></li><li><a href=/en/dutch-tulip-bubble/>Is Bitcoin Like the Dutch Tulip Bubble?</a></li><li><a href=/en/everyones-a-scammer/>Everyone's a Scammer</a></li><li><a href=/en/freedom-of-value/>The Freedom of Value</a></li><li><a href=/en/bitcoin-meme/>Bitcoin Is The Only Real Meme</a></li><li><a href=/en/number-zero-and-bitcoin/>The Number Zero and Bitcoin</a></li><li><a href=/en/crypto-bro/>Dear Crypto & Fiat Bros</a></li><li><a href=/en/fighting-fake-bitcoin/>Fighting Fake Bitcoin</a></li><li><a href=/en/bitcoin-is-the-mycelium/>Bitcoin is The Mycelium of Money</a></li><li><a href=/en/proof-of-life/>Proof of Life. Why Bitcoin is a Living Organism</a></li><li><a href=/en/most-peaceful-revolution/>A Most Peaceful Revolution</a></li><li><a href=/en/bitcoin-universe/>Bitcoin Universe</a></li><li><a href=/en/bitcoin-dissidents/>Bitcoin Dissidents</a></li><li><a href=/en/bitcoin-equals-freedom/>Bitcoin Equals Freedom</a></li></ul></li><li><input type=checkbox id=section-acee29309cd01b51e216d2d768d75871 class=toggle>
<label for=section-acee29309cd01b51e216d2d768d75871 class="flex justify-between"><a href=/en/future/>Future</a></label><ul><li><input type=checkbox id=section-8b8bdf99eb0d858d5adbfb2d713a72dc class=toggle>
<label for=section-8b8bdf99eb0d858d5adbfb2d713a72dc class="flex justify-between"><a href=/en/ba/>Bitcoin Astronomy</a></label><ul><li><a href=/en/ba/1/>Part I</a></li><li><a href=/en/ba/2/>Part II</a></li><li><a href=/en/ba/3/>Part III</a></li></ul></li><li><a href=/en/hey-bitcoin-slow-down/>Hey Bitcoin, Slow Down!</a></li><li><a href=/en/apocalypse/>Can Bitcoin Survive An Apocalypse?</a></li><li><a href=/en/bitcoin-and-oceans/>Bitcoin and Ocean Thermal Energy</a></li></ul></li><li><input type=checkbox id=section-7273d708b600eaa6617c228cdd2d9524 class=toggle>
<label for=section-7273d708b600eaa6617c228cdd2d9524 class="flex justify-between"><a href=/en/lightning/>Lightning</a></label><ul><li><a href=/en/what-is-lightning-network/>What is Lightning Network?</a></li><li><a href=/en/lightning-wallets/>Lightning Wallets</a></li><li><a href=/en/how-lightning-address-works/>How Lightning Address Works</a></li><li><a href=/en/lightning-network-privacy/>Lightning Network Privacy</a></li><li><a href=/en/is-lightning-centralized/>Is Lightning centralized?</a></li><li><a href=/en/lightning-network-explained/>Lightning Network Explained</a></li><li><a href=/en/inbound-liquidity-problem/>Solutions to inbound liquidity problem</a></li></ul></li></ul></li><li><input type=checkbox id=section-ebedd809137a39943c3339b07b86856f class=toggle>
<label for=section-ebedd809137a39943c3339b07b86856f class="flex justify-between"><a href=/en/practice/>Practice</a></label><ul><li><input type=checkbox id=section-a04618d8af5c321dea142dada821f01f class=toggle>
<label for=section-a04618d8af5c321dea142dada821f01f class="flex justify-between"><a href=/en/practice/buy/>Buy</a></label><ul><li><a href=/en/newbie-buy/>Buy and Hodl Bitcoin for Beginners</a></li><li><a href=/en/hodl-hodl/>Buy noKYC Bitcoin with HodlHodl</a></li><li><a href=/en/robosats/>RoboSats: Private P2P Exchange</a></li></ul></li><li><input type=checkbox id=section-52e946c82575a11d29d8ca1021a1b878 class=toggle>
<label for=section-52e946c82575a11d29d8ca1021a1b878 class="flex justify-between"><a href=/en/practice/hodl/>Hodl</a></label><ul><li><a href=/en/electrum/>Electrum Bitcoin Wallet</a></li><li><a href=/en/blue/>Installing Blue Wallet</a></li><li><a href=/en/seedsigner/>SeedSigner: DIY Bitcoin Signing Device</a></li><li><a href=/en/coldcard/>What is Coldcard?</a></li></ul></li><li><input type=checkbox id=section-7778724fd028202526d77fda64e80716 class=toggle>
<label for=section-7778724fd028202526d77fda64e80716 class="flex justify-between"><a href=/en/practice/interact/>Interact</a></label><ul><li><a href=/en/practice/bitcoin-node/>Why You Should Run Your Own Bitcoin Node</a></li><li><a href=/en/orangepilling-in-5-min/>Orangepilling in 5 min</a></li><li><a href=/en/5-tips-for-teaching-bitcoin/>5 tips for teaching Bitcoin</a></li></ul></li><li><input type=checkbox id=section-42375023512d85163c1ed33595577cc3 class=toggle>
<label for=section-42375023512d85163c1ed33595577cc3 class="flex justify-between"><a href=/en/practice-privacy/>Privacy</a></label><ul><li><input type=checkbox id=section-489729314822a64eb481d2971b819168 class=toggle>
<label for=section-489729314822a64eb481d2971b819168 class="flex justify-between"><a href=/en/practice-privacy/dojo/>Dojo x86 Bitcoin Node Guide</a></label><ul><li><a href=/en/practice-privacy/dojo-0/>Introduction</a></li><li><a href=/en/practice-privacy/dojo-1/>Installing Bitcoin Core & Tor</a></li><li><a href=/en/practice-privacy/dojo-2/>Installing Fulcrum Indexer</a></li><li><a href=/en/practice-privacy/dojo-3/>Installing Mempool Explorer</a></li><li><a href=/en/practice-privacy/dojo-4/>Installing Samourai Dojo</a></li><li><a href=/en/practice-privacy/dojo-5/>Firewall Configuration</a></li><li><a href=/en/practice-privacy/dojo-6/>Installing Package Updates</a></li></ul></li><li><a href=/en/practice-privacy/ronindojo/>RoninDojo x86 Installation Guide</a></li><li><a href=/en/grapheneos/>GrapheneOS: De-Google your phone</a></li></ul></li><li><input type=checkbox id=section-1ee5fbef80ad0a274c597a531c90648c class=toggle>
<label for=section-1ee5fbef80ad0a274c597a531c90648c class="flex justify-between"><a href=/en/practice/lightning/>Lightning</a></label><ul><li><a href=/en/phoenix/>Phoenix: The Non-Custodial Lightning Wallet</a></li><li><a href=/en/lnbits/>LNbits: A Swiss knife among Lightning apps</a></li><li><a href=/en/alby-and-nostr/>Alby and Nostr</a></li><li><a href=/en/zapplanner/>Recurring Lightning Payments</a></li><li><a href=/en/lntips/>Telegram bot @LightningTipBot</a></li><li><a href=/en/lightning-liquidity-management-guide/>Lightning Liquidity Management Guide</a></li><li><a href=/en/mutiny/>Starting with Mutiny Wallet</a></li></ul></li></ul></li><li><input type=checkbox id=section-0fbeb231f88c8b74f36060fd3f3377c6 class=toggle>
<label for=section-0fbeb231f88c8b74f36060fd3f3377c6 class="flex justify-between"><a href=/en/rabbithole/>Rabbithole</a></label><ul></ul></li></ul><div class=menuSep></div><ul><li><input type=checkbox id=section-5c8dd08fbf75826bbf8b24f27b15430e class=toggle>
<label for=section-5c8dd08fbf75826bbf8b24f27b15430e class="flex justify-between"><a href=/en/contribute/>Contribute</a></label><ul><li><a href=/en/github/>Adding an Article</a></li></ul></li><li><span>Blog</span></li><li><a href=/en/feedback/>Feedback</a></li></ul><div class=menuBlock><div id=metrics-container class=metrics-container><div id=metrics-label></div><div id=metrics-value></div></div></div></nav><footer><br><a class=menuSocialButton href=https://t.me/bitcoin21ideas target=_blank title=Telegram><svg viewBox="0 0 25 25"><path d="m12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12c0-6.627-5.373-12-12-12zm5.894 8.221-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.446 1.394c-.14.18-.357.295-.6.295-.002.0-.003.0-.005.0l.213-3.054 5.56-5.022c.24-.213-.054-.334-.373-.121L8.32 13.617l-2.96-.924c-.64-.203-.658-.64.135-.954l11.566-4.458c.538-.196 1.006.128.832.941z"/></svg>
</a>&nbsp;
<a class=menuSocialButton href=https://github.com/21ideas-org/21ideas.org target=_blank title=GitHub><svg viewBox="0 0 820 820"><path d="M4e2 9.9C179.11 9.9.0 189 0 409.94.0 585.6 113.24 734.86 270.71 788.61l2.83.83c20 3.76 27.34-8.59 27.34-19.24.0-9.49-.32-34.68-.5-68-111.27 24.14-134.75-53.68-134.75-53.68a106.58 106.58.0 00-44.09-58.26l-.43-.24c-36.23-24.81 2.8-24.3 2.8-24.3A84.06 84.06.0 01185 606.54l.22.4a85.24 85.24.0 00116.92 33l-.43.21A85.16 85.16.0 01327 586.7C238.19 576.67 144.8 542.25 144.8 389c0-.72.0-1.55.0-2.38a153.82 153.82.0 0141.27-105l-.08.11a139.82 139.82.0 01-8.56-48.58 141.91 141.91.0 0112.4-58.21l-.37.91s33.51-10.72 110 41c30-8.56 64.43-13.5 1e2-13.5a378.09 378.09.0 01102.68 14.14l-2.67-.64c76-51.72 109.51-41 109.51-41a144 144 0 0112 58.07 145.56 145.56.0 01-8.35 48.82l.32-1a154.37 154.37.0 0141 105c0 .83.0 1.63.0 2.43V389c0 153.68-93.5 187.51-182.52 197.35a95.48 95.48.0 0127.27 66.93c0 2.48-.11 5-.3 7.42v-.32c0 53.54-.51 96.54-.51 109.53.0 10.51 7 23 27.51 19C686.25 734.78 8e2 585.39 8e2 409.41 8e2 188.74 621.11 9.87 400.47 9.87H4e2z"/></svg>
</a>&nbsp;
<a class=menuSocialButton href=https://njump.me/npub1lm3f47nzyf0rjp6fsl4qlnkmzed4uj4h2gnf2vhe3l3mrj85vqks6z3c7l target=_blank title=Nostr><svg viewBox="0 0 820 820"><path d="M4e2 797.5c219.53.0 397.5-178 397.5-397.5S619.53 2.5 4e2 2.5 2.5 180.47 2.5 4e2 180.47 797.5 4e2 797.5zM598.23 242.15c6.82 8.46 10.35 18.14 11.45 28.86 1.7 16.37-2.68 31.17-11.2 45-14.19 23.62-43.17 39.63-45.85 41-5.42 2.86-7.42 7.12-7.06 13.34s-1.21 37.19-20 50.83c-9.68 7-48.64 16-66.6 19.05a28.61 28.61.0 00-13.18 5.37c-1 .67-2 1.36-3.2 2.06-6.82 4.27-31.23 38-35.31 45.48l10.66-3.27c21.2-6.53 66.85-20.6 69.52-21 9-1.4 15.89 1.22 20.34 7.79 3.63 5.41 7.18 10.81 10.75 16.25.61.94 1.23 1.87 1.85 2.81 1 1.54 2 3.08 2.93 4.62.48.78 1 1.55 1.45 2.32l1.52 2.38c.09.14.19.29.28.45a10.65 10.65.0 011.37 2.83c.24 1 .91 4.14-.92 6.09-1.7 1.77-4.63 1.77-6.21 1.34a15.65 15.65.0 01-5.6-2.8l-2.49-2.13c-2-1.71-5.73-2.56-8.71-2.44-3.41.13-8-1-10.11-2.37-4.2-2.74-5.35-9.56-5.35-9.68a3.51 3.51.0 00-3.72-2.86 18.58 18.58.0 00-6.28 1.15l-.78.25q-15 4.56-29.93 9.24h0l-14.31 4.45c-7.06 2.19-14.12 4.38-21.13 6.69a37.45 37.45.0 00-5.72 2.62c-.43.21-.84.43-1.25.64l-1.24.64h0c-.85.42-1.7.85-2.55 1.34l-.27.15a30.59 30.59.0 01-5.76 2.65c-7.12 2.13-13.39-1-16.32-8.1-1.88-4.63-.18-13.76.86-16.44 5.58-14.35 21.77-39.58 26.28-46.6.75-1.17 1.17-1.83 1.17-1.86-.36-.12-23.25 9.07-27 11.93-10.35 7.86-34.64 26.49-35 28.31A22.75 22.75.0 01331 508.13c-5.66 2.19-9.13 6.7-12.48 11.08.0.0-60.88 83.83-65 88.34l-.68.74c-2.83 3-12.28 13.16-15 18.13-.46.83-1.61 3.27-2.58 5.33-.6 1.26-1.13 2.38-1.38 2.89.0.05-.05.11-.08.17-.59 1.21-1.91 3.9-6.31 3.66s-4.79-6.12-5-9.09v-.4c-.54-6.88 1-13.7 4.63-20.82a6.46 6.46.0 01.31-.58c1-1.8 3.93-7 2.61-11.36s-2.61-11.14-.6-14.61c2.84-4.77 7.62-5.48 13.92-6.41l2.64-.41c5.29-.85 9.13-3.53 12.84-8.88 4.66-6.84 17-24.51 27.65-39.67C293.62 516 3e2 507 302.66 503.09a25.55 25.55.0 003.77-9.08c1.89-9.74 7.85-16.49 18.14-20.7 2.25-.85 43.17-35.06 43.17-39.45.0-3.1-4.45-4.87-7.92-5.78-.48-.12-26.24-6.82-37.92-12.12A88.58 88.58.0 01305 406.41c-7.53-5.54-22.23-3.16-25.3-2.67l-.27.05c-11 1.58-19.12 6.51-28.37 12.78-1.65 1.16-10.05 4.2-14.31 1.77-1.32-.75-2.9-1.6-4.65-2.54-9.16-4.92-22.91-12.31-28.59-20.9-3.11-4.69-2.68-12.42-.49-20.94 7.07-19.73 17.48-28.56 36.77-33.91 11.39-3.95 32.41-5.33 46.84-6.28 2.93-.19 5.59-.37 7.84-.54.12-.05.8-.09 1.94-.18 7-.51 31.32-2.27 49.13-11.39 1.61-.82 3.59-1.92 5.91-3.2 17.67-9.8 55.68-30.86 107.76-29.25 12.95.4 32.15 7.45 49.77 13.93 14.79 5.43 28.46 10.45 36.38 10.79 17.65.73 26.54-1.22 36.77-11.81 2.92-3.05 15.16-29.53 3.59-44a108.64 108.64.0 00-13.94-14.55q-2.28-1.94-4.59-3.85a183.79 183.79.0 01-15.8-14.29c-13.82-14.61-18.09-34.58-11.51-50.17 4.14-10.9 13-15.65 25.63-13.15 6.22 1.24 11.28 5.49 15.95 9.41a73.24 73.24.0 005.84 4.59c3.6 2.38 9.56 3.78 13.46 4.69 4.93 1.16 8.65 4.93 8.4 7.49s-6.7 4.75-13 4.26c-7.36-.49-20.09-.55-27.7 2-5.05 1.83-7.3 7.49-5.84 13 1.22 4.57 10.9 12.66 14.55 15.65 1.64 1.35 3.3 2.67 5 4C587.86 231.81 593.56 236.34 598.23 242.15z" fill-rule="evenodd"/></svg>
</a>&nbsp;
<a class=menuSocialButton href=/rss title=RSS><svg viewBox="-143 145 525 525"><path d="M113 145c-141.4.0-256 114.6-256 256s114.6 256 256 256 256-114.6 256-256S254.4 145 113 145zM43.1 518.7c-6.2 6.2-14.7 9.9-24.1 9.9-9.4.0-17.8-3.8-24-9.9-6.2-6.2-10-14.6-10-23.9.0-9.4 3.8-17.8 10-24s14.6-10 24-10 17.9 3.8 24 10c6.2 6.2 10 14.6 10 24C53 504.2 49.2 512.6 43.1 518.7zM104.8 529c-.1-32.1-12.5-62.3-35.1-84.9-22.6-22.6-52.8-35.2-84.7-35.2V360c46.6.0 88.7 19 119.3 49.6s49.5 72.8 49.6 119.4H104.8zm87.2.0c-.1-114.2-92.8-207.1-206.9-207.1V273c70.6.0 134.5 28.7 180.8 75.1 46.3 46.4 75 110.3 75.1 180.9H192z"/></svg>
</a>&nbsp;
<a class=menuSocialButton href=https://www.youtube.com/@21ideas target=_blank title=YouTube><svg viewBox="0 0 25 25"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm4.441 16.892c-2.102.144-6.784.144-8.883.0C5.282 16.736 5.017 15.622 5 12c.017-3.629.285-4.736 2.558-4.892 2.099-.144 6.782-.144 8.883.0C18.718 7.264 18.982 8.378 19 12c-.018 3.629-.285 4.736-2.559 4.892zM10 9.658l4.917 2.338L10 14.342V9.658z"/></svg></a></footer><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class="book-page book-page-page"><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Bitcoin Privacy</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#summary>Summary</a></li><li><a href=#introduction>Introduction</a><ul><li><a href=#example---adversary-controls-source-and-destination-of-coins>Example - Adversary controls source and destination of coins</a></li><li><a href=#example---non-anonymous-chinese-newspaper-buying>Example - Non-anonymous Chinese newspaper buying</a></li><li><a href=#example---a-perfectly-private-donation>Example - A perfectly private donation</a></li><li><a href=#multiple-interpretations-of-a-blockchain-transaction>Multiple interpretations of a blockchain transaction</a></li><li><a href=#threat-model>Threat model</a></li><li><a href=#method-of-data-fusion>Method of data fusion</a></li><li><a href=#why-privacy>Why privacy</a></li></ul></li><li><a href=#blockchain-attacks-on-privacy>Blockchain attacks on privacy</a><ul><li><a href=#common-input-ownership-heuristic>Common-input-ownership heuristic</a></li><li><a href=#change-address-detection>Change address detection</a><ul><li><a href=#address-reuse>Address reuse</a></li><li><a href=#wallet-fingerprinting>Wallet fingerprinting</a></li><li><a href=#round-numbers>Round numbers</a></li><li><a href=#fee-bumping>Fee bumping</a></li><li><a href=#unnecessary-input-heuristic>Unnecessary input heuristic</a></li><li><a href=#sending-to-a-different-script-type>Sending to a different script type</a></li><li><a href=#wallet-bugs>Wallet bugs</a></li><li><a href=#equal-output-coinjoin>Equal-output CoinJoin</a></li><li><a href=#cluster-growth>Cluster growth</a></li></ul></li><li><a href=#transaction-graph-heuristic>Transaction graph heuristic</a><ul><li><a href=#taint-analysis>Taint analysis</a></li></ul></li><li><a href=#amount>Amount</a><ul><li><a href=#input-amounts-revealing-sender-wealth>Input amounts revealing sender wealth</a></li><li><a href=#exact-payment-amounts-no-change>Exact payment amounts (no change)</a></li></ul></li><li><a href=#batching>Batching</a></li><li><a href=#unusual-scripts>Unusual scripts</a></li><li><a href=#mystery-shopper-payment>Mystery shopper payment</a></li><li><a href=#forced-address-reuse>Forced address reuse</a></li><li><a href=#amount-correlation>Amount correlation</a></li><li><a href=#timing-correlation>Timing correlation</a></li></ul></li><li><a href=#non-blockchain-attacks-on-privacy>Non-blockchain attacks on privacy</a><ul><li><a href=#traffic-analysis>Traffic analysis</a></li><li><a href=#custodial-wallets>Custodial Wallets</a></li><li><a href=#wallet-history-retrieval-from-third-party>Wallet history retrieval from third-party</a><ul><li><a href=#blockchain-explorer-websites>Blockchain explorer websites</a></li><li><a href=#bip-37>BIP 37</a></li><li><a href=#public-electrum-servers>Public Electrum servers</a></li></ul></li><li><a href=#communication-eavesdropping>Communication eavesdropping</a></li><li><a href=#revealing-data-when-transacting-bitcoin>Revealing data when transacting bitcoin</a></li><li><a href=#digital-forensics>Digital forensics</a></li></ul></li><li><a href=#methods-for-improving-privacy-non-blockchain>Methods for improving privacy (non-blockchain)</a><ul><li><a href=#obtaining-bitcoins-anonymously>Obtaining bitcoins anonymously</a><ul><li><a href=#cash-trades>Cash trades</a></li><li><a href=#cash-substitute>Cash substitute</a></li><li><a href=#employment>Employment</a></li><li><a href=#mining>Mining</a></li><li><a href=#stealing>Stealing</a></li></ul></li><li><a href=#spending-bitcoins-anonymously>Spending bitcoins anonymously</a></li><li><a href=#wallet-history-synchronization>Wallet history synchronization</a><ul><li><a href=#full-node>Full node</a></li><li><a href=#private-information-retrieval>Private information retrieval</a></li><li><a href=#client-side-block-filtering>Client-side block filtering</a></li><li><a href=#address-query-via-onion-routing>Address query via onion routing</a></li></ul></li><li><a href=#countermeasures-to-traffic-analysis>Countermeasures to traffic analysis</a><ul><li><a href=#tor-and-tor-broadcasting>Tor and tor broadcasting</a></li><li><a href=#dandelion>Dandelion</a></li><li><a href=#interactive-peer-broadcasting>Interactive peer broadcasting</a></li><li><a href=#receiving-bitcoin-data-over-satellite>Receiving bitcoin data over satellite</a></li></ul></li></ul></li><li><a href=#methods-for-improving-privacy-blockchain>Methods for improving privacy (blockchain)</a><ul><li><a href=#avoiding-address-reuse>Avoiding address reuse</a><ul><li><a href=#avoiding-forced-address-reuse>Avoiding forced address reuse</a></li></ul></li><li><a href=#coin-control>Coin control</a></li><li><a href=#multiple-transactions>Multiple transactions</a></li><li><a href=#change-avoidance>Change avoidance</a></li><li><a href=#multiple-change-outputs>Multiple change outputs</a></li><li><a href=#script-privacy-improvements>Script privacy improvements</a></li><li><a href=#ecdh-addresses>ECDH addresses</a></li><li><a href=#centralized-mixers>Centralized mixers</a></li><li><a href=#coinjoin>CoinJoin</a><ul><li><a href=#equal-output-coinjoin-1>Equal-output CoinJoin</a></li><li><a href=#payjoin>PayJoin</a></li></ul></li><li><a href=#coinswap>CoinSwap</a></li><li><a href=#coinjoinxt>CoinJoinXT</a></li><li><a href=#tumblebit>TumbleBit</a></li><li><a href=#off-chain-transactions>Off-chain transactions</a><ul><li><a href=#blinded-bearer-certificates>Blinded bearer certificates</a></li><li><a href=#sidechains>Sidechains</a></li><li><a href=#statechains>StateChains</a></li></ul></li><li><a href=#confidential-transactions>Confidential transactions</a></li><li><a href=#discussion>Discussion</a><ul><li><a href=#privacy-vs-scalability>Privacy vs scalability</a></li><li><a href=#steganography>Steganography</a></li></ul></li></ul></li><li><a href=#lightning-network>Lightning Network</a><ul><li><a href=#onion-routing>Onion routing</a><ul><li><a href=#onion-routing-overlaid-with-network-topology>Onion routing overlaid with network topology</a></li><li><a href=#rendez-vous-routing>Rendez-vous routing</a></li></ul></li><li><a href=#atomic-multipath-payments>Atomic Multipath Payments</a></li><li><a href=#common-hashlock-value>Common hashlock value</a></li><li><a href=#custodial-wallets-1>Custodial wallets</a></li><li><a href=#private-script-types>Private script types</a></li><li><a href=#probing-payments-to-reveal-channel-states>Probing payments to reveal channel states</a></li></ul></li><li><a href=#existing-privacy-solutions>Existing privacy solutions</a><ul><li><a href=#lightning-network-1>Lightning Network</a></li><li><a href=#handmade-coinjoin>Handmade CoinJoin</a></li><li><a href=#joinmarket>JoinMarket</a></li><li><a href=#wasabi-wallet>Wasabi Wallet</a></li><li><a href=#samourai-wallet>Samourai Wallet</a></li><li><a href=#liquid-sidechain>Liquid sidechain</a></li><li><a href=#mercury-wallet>Mercury Wallet</a></li></ul></li><li><a href=#examples-and-case-studies>Examples and case studies</a><ul><li><a href=#bad-privacy-example---exchange-front-running>Bad privacy example - Exchange front running</a></li><li><a href=#bad-privacy-example---savings-revealed-with-address-reuse>Bad privacy example - Savings revealed with address reuse</a></li><li><a href=#bad-privacy-example---savings-revealed-with-data-collection>Bad privacy example - Savings revealed with data collection</a></li><li><a href=#example---evading-sanctions>Example - Evading sanctions</a></li><li><a href=#example---transacting-with-your-online-poker-buddies-without-revealing-your-real-name>Example - Transacting with your online poker buddies without revealing your real name</a></li><li><a href=#example---donation-without-your-employer-knowing>Example - Donation without your employer knowing</a></li><li><a href=#example---donation-without-anyone-knowing>Example - Donation without anyone knowing</a></li><li><a href=#example---receiving-donations-privately>Example - Receiving donations privately</a></li><li><a href=#example---storing-savings-privately>Example - Storing savings privately</a></li><li><a href=#example---stopping-incoming-payments-from-different-sources-from-being-linked-together>Example - Stopping incoming payments from different sources from being linked together</a></li><li><a href=#example---withdrawing-casino-winnings-to-a-bitcoin-exchange-without-either-entity-knowing-the-source-or-destination-of-funds>Example - Withdrawing casino winnings to a bitcoin exchange without either entity knowing the source or destination of funds</a></li><li><a href=#bad-privacy-example---using-a-blockchain-explorer>Bad privacy example - Using a blockchain explorer</a></li><li><a href=#bad-privacy-example---privacy-altcoin-mixing-failing-due-to-amount-correlation>Bad privacy example - Privacy altcoin mixing failing due to amount correlation</a></li><li><a href=#example---privacy-altcoin-mixing>Example - Privacy altcoin mixing</a></li><li><a href=#example---daily-commerce-with-lightning-network>Example - Daily commerce with Lightning Network</a></li><li><a href=#bad-privacy-example---sending-to-a-static-donation-address-without-precautions>Bad privacy example - Sending to a static donation address without precautions</a></li><li><a href=#bad-privacy-example---receiving-donations-spied-on-with-mystery-shopper-payments>Bad privacy example - Receiving donations spied on with mystery shopper payments</a></li><li><a href=#real-life-example---bitcoin-stealing-malware-using-static-addresses>Real life example - Bitcoin-stealing malware using static addresses</a></li><li><a href=#bad-privacy-example---bitcoin-stealing-malware-spied-on-with-mystery-shopper-payments>Bad privacy example - Bitcoin-stealing malware spied on with mystery shopper payments</a></li><li><a href=#example---single-use-lightweight-wallet-over-tor>Example - Single-use lightweight wallet over Tor</a></li><li><a href=#bad-privacy-example---lightweight-wallet-over-tor-used-multiple-times>Bad privacy example - Lightweight wallet over Tor used multiple times</a></li><li><a href=#real-life-example---public-donation-address-combined-with-the-common-input-ownership-heuristic>Real life example - Public donation address combined with the common-input-ownership heuristic</a></li><li><a href=#real-life-example---digital-forensics-aids-with-investigation-of-the-mtgox-exchange>Real life example - Digital forensics aids with investigation of the MtGox exchange</a></li><li><a href=#real-life-example---flawed-use-of-the-common-input-ownership-heuristic-exaggerates-donation-income>Real life example - Flawed use of the common-input-ownership heuristic exaggerates donation income</a></li><li><a href=#real-life-example---incorrect-clusters-found-by-the-common-input-ownership-heuristic>Real life example - Incorrect clusters found by the common-input-ownership heuristic</a></li><li><a href=#real-life-example---handmade-coinjoin-mislead-a-bitcoin-analyist>Real life example - Handmade coinjoin mislead a bitcoin analyist</a></li><li><a href=#real-life-example---the-quadrigacx-exchange-wallet-analysis>Real life example - The QuadrigaCX exchange wallet analysis</a></li><li><a href=#real-life-example---stopping-bustabit-casino-customers-getting-banned-from-coinbasecom>Real life example - Stopping Bustabit casino customers getting banned from Coinbase.com</a></li><li><a href=#real-life-example---rare-multisignature-scripts>Real life example - Rare multisignature scripts</a></li><li><a href=#real-life-example---freelance-it-contractor-has-his-co-workers-figure-out-his-salary>Real life example - Freelance IT contractor has his co-workers figure out his salary</a></li><li><a href=#real-life-example---hacker-hides-destination-of-445-btc-with-coinjoin>Real life example - Hacker hides destination of 445 btc with CoinJoin</a></li><li><a href=#bad-privacy-example---data-fusion-of-blockchain-data-and-web-cookies-when-online-shopping-with-bitcoin>Bad privacy example - Data fusion of blockchain data and web cookies when online shopping with Bitcoin</a></li><li><a href=#bad-privacy-example---centralized-mixers-being-easily-unmixed-with-amount-correlation>Bad privacy example - Centralized mixers being easily unmixed with amount correlation</a></li><li><a href=#bad-privacy-example---data-fusion-of-blockchain-data-and-ip-address-transaction-broadcasting-data>Bad privacy example - Data fusion of blockchain data and IP address transaction broadcasting data</a></li><li><a href=#real-life-example---2018-paper-on-analysis-of-bitcoin-ransomware-transactions>Real life example - 2018 paper on analysis of bitcoin ransomware transactions</a></li></ul></li><li><a href=#see-also>See also</a></li></ul></nav></aside></header><div class=pageCover><picture><img src=/img/priv-903.jpeg alt=Cover></picture></div><h1>Bitcoin Privacy</h1><div class=pageDate>February 1, 2019</div><article class=markdown><p>While Bitcoin can support strong <strong>privacy</strong>, many ways of using it are usually not very private. With a proper understanding of the technology, bitcoin can indeed be used in a very private and anonymous way.</p><blockquote class="book-hint btc"><p>This article was published on <a href=https://en.bitcoin.it/wiki/Privacy>en.bitcoin.it</a> wiki.</p><p><a href=/contribute/>Contribute</a>.</p></blockquote><p>As of 2019 most casual enthusiasts of bitcoin believe it is perfectly traceable; this is completely false. Around 2011 most casual enthusiasts believed it is totally private; which is also false. There is some nuance - in certain situations, bitcoin can be very private. But it is not simple to understand, and it takes some time and reading.</p><p>This article was written in February 2019. A good way to read the article is to <a href=/en/wiki-bitcoin-privacy/#examples-and-case-studies>skip to the examples</a> and then come back to read the core concepts.</p><h1 id=summary>Summary
<a class=anchor href=#summary>#</a></h1><p>To save you reading the rest of the article, here is a quick summary of how normal bitcoin users can improve their privacy:</p><ul><li>Think about what you&rsquo;re hiding from, what is your threat model and what is your adversary. Note that <a href=https://en.bitcoin.it/wiki/Transaction_surveillance_company title="Transaction surveillance company">transaction surveillance companies</a> exist which do large-scale surveillance of the bitcoin ecosystem.</li><li>Do not reuse addresses. Addresses should be shown to one entity to receive money, and never used again after the money from them is spent.</li><li>Try to reveal as little information as possible about yourself when transacting, for example, avoid AML/KYC checks and be careful when giving your real-life mail address.</li><li>Use a wallet backed by your own full node or <a href=https://en.bitcoin.it/wiki/Client-side_block_filtering title="Client-side block filtering">client-side block filtering</a>, definitely not a web wallet.</li><li>Broadcast on-chain transactions over Tor, if your wallet doesn&rsquo;t support it then copy-paste the transaction hex data into a web broadcasting form over Tor browser.</li><li>Use Lightning Network as much as possible.</li><li>If lightning is unavailable, use a wallet that correctly implements CoinJoin.</li><li>Try to avoid creating change addresses, for example when funding a lightning channel spend an entire UTXO into it without any change (assuming the amount is not too large to be safe).</li><li>If <a href=/en/wiki-bitcoin-privacy/#digital-forensics>digital forensics</a> are a concern then use a solution like <a href=https://tails.boum.org/>Tails Operating System</a>.</li></ul><p>See also <a href=/en/wiki-bitcoin-privacy/#examples-and-case-studies>the privacy examples</a> for real-life case-studies.</p><h1 id=introduction>Introduction
<a class=anchor href=#introduction>#</a></h1><p>Users interact with bitcoin through software which may leak information about them in various ways that damage their anonymity.</p><p>Bitcoin records transactions on the block chain which is visible to all and so creates the most serious damage to privacy. Bitcoins move between addresses; sender addresses are known, receiver addresses are known, and amounts are known. Only the identity of each address is not known (see first image).</p><p>The linkages between addresses made by transactions are often called the transaction graph. Alone, this information can&rsquo;t identify anyone because the addresses and transaction IDs are just random numbers. However, if <em>any</em> of the addresses in a transaction&rsquo;s past or future can be tied to an actual identity, it might be possible to work from that point and deduce who may own all of the other addresses. This identification of an address might come from network analysis, surveillance, searching the web, or a variety of other methods. The encouraged practice of using a new address for every transaction is intended to make this attack more difficult.</p><div class=imageWrapper><img src=/img/priv-904.png><p><em>The flow of Bitcoins is highly public.</em></p></div><h2 id=example---adversary-controls-source-and-destination-of-coins>Example - Adversary controls source and destination of coins
<a class=anchor href=#example---adversary-controls-source-and-destination-of-coins>#</a></h2><p>The second image shows a simple example. An adversary runs both a money exchanger and a honeypot website meant to trap people. If someone uses their exchanger to buy bitcoins and then transacts the coins to the trap website, the block chain would show:</p><div class=imageWrapper><img src=/img/priv-905.png><p><em>Finding an identity of one address allows you to attack the anonymity of the transactions.</em></p></div><ul><li>Transaction of coins on address A to address B. Authorized by &lt;signature of address A>.</li><li>Transaction of coins on address B to address C. Authorized by &lt;signature of address B>.</li></ul><p>Say that the adversary knows that Mr. Doe&rsquo;s bank account sent the government currency which were used to buy the coins, which were then transferred to address B. The adversary also knows the trap website received coins on address C that were spent from address B. Together this is a <strong>very strong indication</strong> that address B is owned by Mr. Doe and that he sent money to the trap website. This assumption is not always correct because address B may have been an address held on behalf of Mr. Doe by a third party and the transaction to C may have been unrelated, or the two transactions may actually involve a smart contract (See <a href=https://en.bitcoin.it/wiki/Off-Chain_Transactions title="Off-Chain Transactions">Off-Chain Transactions</a>) which effectively teleports the coins off-chain to a completely different address somewhere on the blockchain.</p><h2 id=example---non-anonymous-chinese-newspaper-buying>Example - Non-anonymous Chinese newspaper buying
<a class=anchor href=#example---non-anonymous-chinese-newspaper-buying>#</a></h2><p>In this example, the adversary controls the destination and finds the source from metadata.</p><ol><li>You live in China and want to buy a &ldquo;real&rdquo; online newspaper for Bitcoins.</li><li>You join the Bitcoin forum and use your address as a signature. Since you are very helpful, you manage to get a modest sum as donations after a few months.</li><li>Unfortunately, you choose poorly in who you buy the newspaper from: you&rsquo;ve chosen a government agent!</li><li>The government agent looks at the transaction used to purchase the newspaper on the block chain, and searches the web every relevant address in it. He finds your address in your signature on the Bitcoin forum. You&rsquo;ve left enough personal information in your posts to be identified, so you are now scheduled to be &ldquo;reeducated&rdquo;.</li><li>A major reason this happened is because of address reuse. Your forum signature had a single bitcoin address that never changed, so it was easy to find by searching the web.</li></ol><p>You need to protect yourself from both forward attacks (getting something that identifies you using coins that you got with methods that must remain secret, like the scammer example) and reverse attacks (getting something that must remain secret using coins that identify you, like the newspaper example).</p><h2 id=example---a-perfectly-private-donation>Example - A perfectly private donation
<a class=anchor href=#example---a-perfectly-private-donation>#</a></h2><p>On the other hand, here is an example of somebody using bitcoin to make a donation that is completely anonymous.</p><ol><li>The aim is to donate to some organization that accepts bitcoin.</li><li>You run a Bitcoin Core wallet entirely through Tor.</li><li>Download some extra few hundred gigabytes of data over Tor so that the total download bandwidth isn&rsquo;t exactly blockchain-sized.</li><li>Solo-mine a block, and have the newly-mined coins sent to your wallet.</li><li>Send the entire balance to a donation address of that organization.</li><li>Finally you destroy the computer hardware used.</li></ol><p>As your full node wallet runs entirely over Tor, your IP address is very well hidden. Tor also hides the fact that you&rsquo;re using bitcoin at all. As the coins were obtained by mining they are entirely unlinked from any other information about you. Since the transaction is a donation, there are no goods or services being sent to you, so you don&rsquo;t have to reveal any delivery mail address. As the entire balance is sent, there is no change address going back that could later leak information. Since the hardware is destroyed there is no record remaining on any discarded hard drives that can later be found. The only way I can think of to attack this scheme is to be a <a href=https://www.torproject.org/docs/faq.html.en#AttacksOnOnionRouting>global adversary</a> that can exploit the known weaknessness of Tor.</p><h2 id=multiple-interpretations-of-a-blockchain-transaction>Multiple interpretations of a blockchain transaction
<a class=anchor href=#multiple-interpretations-of-a-blockchain-transaction>#</a></h2><p>Bitcoin transactions are made up of inputs and outputs, of which there can be one or more. Previously-created outputs can be used as inputs for later transactions. Such outputs are destroyed when spent and new unspent outputs are usually created to replace them.</p><p>Consider this example transaction:</p><pre tabindex=0><code>1 btc  ----&gt;  1 btc 
3 btc         3 btc
</code></pre><p>This transaction has two inputs, worth 1 btc and 3 btc, and creates two outputs also worth 1 btc and 3 btc.</p><p>If you were to look at this on the blockchain, what would you assume is the meaning of this transaction? (for example, we usually assume a bitcoin transaction is a payment but it doesn&rsquo;t have to be).</p><p>There are <em>at least nine&rsquo;</em> possible <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> interpretations:</p><ol><li>Alice provides both inputs and pays 3 btc to Bob. Alice owns the 1 btc output (i.e. it is a change output).</li><li>Alice provides both inputs and pays 1 btc to Bob, with 3 btc paid back to Alice as the change.</li><li>Alice provides 1 btc input and Bob provides 3 btc input, Alice gets 1 btc output and Bob gets 3 btc output. This is a kind of CoinJoin transaction.</li><li>Alice pays 2 btc to Bob. Alice provides 3 btc input, gets the 1 btc output; Bob provides 1 btc input and gets 3 btc. This would be a <a href=https://en.bitcoin.it/wiki/PayJoin title=PayJoin>PayJoin</a> transaction type.</li><li>Alice pays 4 btc to Bob (but using two outputs for some reason).</li><li>Fake transaction - Alice owns all inputs and outputs, and is simply moving coins between her own addresses.</li><li>Alice pays Bob 3 btc and Carol 1 btc. This is a <a href=https://en.bitcoin.it/wiki/Techniques_to_reduce_transaction_fees#Change_avoidance title="Techniques to reduce transaction fees">batched payment with no change address</a>.</li><li>Alice pays 3, Bob pays 1; Carol gets 3 btc and David gets 1 btc. This is some kind of CoinJoined batched payment with no change address.</li><li>Alice and Bob pay 4 btc to Carol (but using two outputs).</li></ol><p>Many interpretations are possible just from such a simple transaction. Therefore it&rsquo;s completely false to say that bitcoin transactions are always perfectly traceable, the reality is much more complicated.</p><p>Privacy-relevant adversaries who analyze the blockchain usually rely on <em>heuristics</em> (or <em>idioms of use</em>) where certain assumptions are made about what is plausible. The analyst would then ignore or exclude some of these possibilities. But those are only assumptions which can be wrong. Someone who wants better privacy they can intentionally break those assumptions which will completely fool an analyst.</p><p>Units of the bitcoin currency are not watermarked within a transaction (in other words they don&rsquo;t have little serial numbers). For example the 1 btc input in that transaction may end up in the 1 btc output or part of the 3 btc output, or a mixture of both. Transactions are many-to-many mappings, so in a very important sense it&rsquo;s impossible to answer the question of where the 1 btc ended up. This fungibility of bitcoin within one transaction is an important reason for the different possibility interpretations of the above transaction.</p><h2 id=threat-model>Threat model
<a class=anchor href=#threat-model>#</a></h2><p>When considering privacy you need to think about exactly who you&rsquo;re hiding from. You must examine how a hypothetical adversary could spy on you, what kind of information is most important to you and which technology you need to use to protect your privacy. The kind of behaviour needed to protect your privacy therefore depends on your threat model.</p><p>Newcomers to privacy often think that they can simply download some software and all their privacy concerns will be solved. This is not so. Privacy requires a change in behaviour, however slight. For example, imagine if you had a perfectly private internet where who you&rsquo;re communicating with and what you say are completely private. You could still use this to communicate with a social media website to write your real name, upload a selfie and talk about what you&rsquo;re doing right now. Anybody on the internet could view that information so your privacy would be ruined even though you were using perfectly private technology.</p><p>For details read the talk <a href=https://www.slideshare.net/grugq/opsec-for-hackers>Opsec for Hackers by grugq</a>. The talk is aimed mostly at political activists who need privacy from governments, but much the advice generally applies to all of us.</p><p>Much of the time plausible deniability is not good enough because lots of spying methods only need to work on a statistical level (e.g. targeted advertising).</p><h2 id=method-of-data-fusion>Method of data fusion
<a class=anchor href=#method-of-data-fusion>#</a></h2><div class=imageWrapper><img src=/img/priv-906.png><p><em>Data fusion diagram showing how two different privacy leaks can damage privacy far more in combination.</em></p></div><p>Multiple privacy leaks when combined together can be far more damaging to privacy than any single leak. Imagine if a receiver of a transaction is trying to deanonymize the sender. Each privacy leak would eliminate many candidates for who the sender is, two different privacy leaks would eliminate <em>different</em> candidates leaving far fewer candidates remaining. See the diagram for a diagram of this.</p><div class=imageWrapper><img src=/img/priv-907.png><p><em>Data fusion diagram example with newspaper buyer.</em></p></div><p>This is why even leaks of a small amount of information should be avoided, as they can often completely ruin privacy when combined with other leaks. Going back to the example of the non-anonymous Chinese newspaper buyer, who was deanonymized because of a combination of visible transaction information and his forum signature donation address. There are many many transactions on the blockchain which on their own don&rsquo;t reveal anything about the transactor&rsquo;s identity or spending habits. There are many donation addresses placed in forum signatures which also don&rsquo;t reveal much about the owners identity or spending habits, because they are just random cryptographic information. But together the two privacy leaks resulted in a trip to the reeducation camp. The method of data fusion is very important when understanding privacy in bitcoin (and other situations).</p><h2 id=why-privacy>Why privacy
<a class=anchor href=#why-privacy>#</a></h2><p>Financial privacy is an essential element to fungibility in Bitcoin: if you can meaningfully distinguish one coin from another, then their fungibility is weak. If our fungibility is too weak in practice, then we cannot be decentralized: if someone important announces a list of stolen coins they won&rsquo;t accept coins derived from, you must carefully check coins you accept against that list and return the ones that fail. Everyone gets stuck checking blacklists issued by various authorities because in that world we&rsquo;d all not like to get stuck with bad coins. This adds friction, transactional costs and allows the blacklist provider to engage in censorship, and so makes Bitcoin less valuable as a money.</p><p>Financial privacy is an essential criteria for the efficient operation of a free market: if you run a business, you cannot effectively set prices if your suppliers and customers can see all your transactions against your will. You cannot compete effectively if your competition is tracking your sales. Individually your informational leverage is lost in your private dealings if you don&rsquo;t have privacy over your accounts: if you pay your landlord in Bitcoin without enough privacy in place, your landlord will see when you&rsquo;ve received a pay raise and can hit you up for more rent.</p><p>Financial privacy is essential for personal safety: if thieves can see your spending, income, and holdings, they can use that information to target and exploit you. Without privacy malicious parties have more ability to steal your identity, snatch your large purchases off your doorstep, or impersonate businesses you transact with towards you&mldr; they can tell exactly how much to try to scam you for.</p><p>Financial privacy is essential for human dignity: no one wants the snotty barista at the coffee shop or their nosy neighbors commenting on their income or spending habits. No one wants their baby-crazy in-laws asking why they&rsquo;re buying contraception (or sex toys). Your employer has no business knowing what church you donate to. Only in a perfectly enlightened discrimination free world where no one has undue authority over anyone else could we retain our dignity and make our lawful transactions freely without self-censorship if we don&rsquo;t have privacy.</p><p>Most importantly, financial privacy isn&rsquo;t incompatible with things like law enforcement or transparency. You can always keep records, be ordered (or volunteer) to provide them to whomever, have judges hold against your interest when you can&rsquo;t produce records (as is the case today). None of this requires <em>globally</em> visible public records.</p><p>Globally visible public records in finance are completely unheard-of. They are undesirable and arguably intolerable. The Bitcoin whitepaper made a promise of how we could get around the visibility of the ledger with pseudonymous addresses, but the ecosystem has broken that promise in a bunch of places and we ought to fix it. Bitcoin could have coded your name or IP address into every transaction. It didn&rsquo;t. The whitepaper even has a section on privacy. It&rsquo;s incorrect to say that Bitcoin isn&rsquo;t focused on privacy. Sufficient privacy is an essential prerequisite for a viable digital currency <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</p><h1 id=blockchain-attacks-on-privacy>Blockchain attacks on privacy
<a class=anchor href=#blockchain-attacks-on-privacy>#</a></h1><p>Bitcoin uses a block chain. Users can download and verify the blockchain to check that all the rules of bitcoin were followed throughout its history. For example, users can check that nobody printed infinite bitcoins and that every coin was only spent with a <a href=https://en.bitcoin.it/wiki/OP_CHECKSIG title="OP CHECKSIG">valid signature</a> created by its <a href=https://en.bitcoin.it/wiki/Private_key title="Private key">private key</a>. This is what leads to <a href=https://en.bitcoin.it/wiki/Bitcoin_as_a_medium_of_exchange title="Bitcoin as a medium of exchange">bitcoin&rsquo;s unique value proposition</a> as a form of electronic cash which requires <a href=https://en.bitcoin.it/wiki/Principles_of_Bitcoin#Low_trust title="Principles of Bitcoin">only small amounts of trust</a>. But the same blockchain structure leads to privacy problems because every transaction must be available for all to see, forever. This section discusses known methods an adversary may use for analyzing the public blockchain.</p><p>Bitcoin uses a UTXO model. Transactions have inputs and outputs, they can have one or more of each. Previous outputs can be used as inputs for later transactions. An output which hasn&rsquo;t been spent yet is called an unspent transaction output (UTXO). UXTOs are often called &ldquo;coins&rdquo;. UTXOs are associated with a bitcoin address and can be spent by creating a valid signature corresponding to the scriptPubKey of the address.</p><p>Addresses are cryptographic information, essentially random numbers. On their own they do not reveal much about the real owner of any bitcoins on them. Usually an adversary will try to link together multiple addresses which they believe belong to the same wallet. Such address collections are called &ldquo;clusters&rdquo;, &ldquo;closures&rdquo; or &ldquo;wallet clusters&rdquo;, and the activity of creating them is called &ldquo;wallet clustering&rdquo;. Once the clusters are obtained the adversary can try to link them real-world identities of entities it wants to spy on. For example, it may find wallet cluster A belonging to Alice and another wallet cluster B belonging to Bob. If a bitcoin transaction is seen paying from cluster A to cluster B then the adversary knows that Alice has sent coins to Bob.</p><p>It can be very difficult to fine-tune heuristics for wallet clustering that lead to obtaining actually correct information <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>.</p><h2 id=common-input-ownership-heuristic>Common-input-ownership heuristic
<a class=anchor href=#common-input-ownership-heuristic>#</a></h2><p>This is a heuristic or assumption which says that if a transaction has more than one input then all those inputs are owned by the same entity.</p><p>For example, consider this transaction with inputs A, B and C; and outputs X and Y.</p><pre tabindex=0><code>A (1 btc) --&gt; X (4 btc)
B (2 btc)     Y (2 btc)
C (3 btc)
</code></pre><p>This transaction would be an indication that addresses B and C are owned by the same person who owns address A.</p><p>One of the purposes of CoinJoin is to break this heuristic. Nonetheless this heuristic is very commonly true and it is widely used by <a href=https://en.bitcoin.it/wiki/Transaction_surveillance_company title="Transaction surveillance company">transaction surveillance companies</a> and other adversaries as of 2019. The heuristic is usually combined with address reuse reasoning, which along with the somewhat-centralized bitcoin economy as of 2018 is why this heuristic can be unreasonably effective <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>. The heuristic&rsquo;s success also depends on the wallet behaviour: for example, if a wallet usually receives small amounts and sends large amounts then it will create many multi-input transactions.</p><h2 id=change-address-detection>Change address detection
<a class=anchor href=#change-address-detection>#</a></h2><p>Many bitcoin transactions have change outputs. It would be a serious privacy leak if the change address can be somehow found, as it would link the ownership of the (now spent) inputs with a new output. Change outputs can be very effective when combined with other privacy leaks like the common-input-ownership heuristic or address reuse. Change address detection allows the adversary to cluster together newly created address, which the common-input-ownership heuristic and address reuse allows past addresses to be clustered.</p><p>Change addresses lead to a common usage pattern called the <strong>peeling chain</strong>. It is seen after a large transactions from exchanges, marketplaces, mining pools and salary payments. In a peeling chain, a single address begins with a relatively large amount of bitcoins. A smaller amount is then peeled off this larger amount, creating a transaction in which a small amount is transferred to one address, and the remainder is transferred to a one-time change address. This process is repeated - potentially for hundreds or thousands of hops - until the larger amount is pared down, at which point (in one usage) the amount remaining in the address might be aggregated with other such addresses to again yield a large amount in a single address, and the peeling process begins again <sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>.</p><p>Now are listed possible ways to infer which of the outputs of a transaction is the change output:</p><h3 id=address-reuse>Address reuse
<a class=anchor href=#address-reuse>#</a></h3><p>If an output address has been reused it is very likely to be a payment output, not a change output. This is because change addresses are created automatically by wallet software but payment addresses are manually sent between humans. The address reuse would happen because the human user reused an address out of ignorance or apathy. This heuristic is probably the most accurate, as it is very hard to imagine how false positives would arise (except by intentional design of wallets). This heuristic is also called the &ldquo;shadow heuristic&rdquo;.</p><p>Some very old software (from the 2010-2011 era which did not have <a href=https://en.bitcoin.it/wiki/Deterministic_wallet title="Deterministic wallet">Deterministic wallets</a>) did not use a new address change but sent the change back to the input address. This reveals the change address exactly.</p><p>Avoiding address reuse is an obvious remedy. Another idea is that those wallets could automatically detect when a payment address has been used before (perhaps by asking the user) and then use a reused address as their change address; so both outputs would be reused addresses.</p><p>Also, most reused addresses are mentioned on the internet, forums, social networks like Facebook, Reddit, Stackoverflow&mldr;etc. These addresses you can find and check on <a href=https://checkbitcoinaddress.com/>https://checkbitcoinaddress.com/</a> site. It&rsquo;s like a little bit de-anonymization of pseudo-anonymized blockchain.</p><h3 id=wallet-fingerprinting>Wallet fingerprinting
<a class=anchor href=#wallet-fingerprinting>#</a></h3><p>A careful analyst sometimes deduce which software created a certain transaction, because the many different wallet softwares don&rsquo;t always create transactions in exactly the same way. Wallet fingerprinting can be used to detect change outputs because a change output is the one spent with the same wallet fingerprint.</p><p>As an example, consider five typical transactions that consume one input each and produce two outputs. A, B, C, D, E refer to transactions. A1, A2, etc refer to output addresses of those transactions</p><pre tabindex=0><code>           --&gt; C1
A1 --&gt; B1  --&gt; C2
   --&gt; B2  --&gt; D1
           --&gt; D2 --&gt; E1
                  --&gt; E2
</code></pre><p>If wallet fingerprinting finds that transactions A, B, D and E are created by the same wallet software, and the other transactions are created by other software, then the change addresses become obvious. The same transactions with non-matching addresses replaced by X is shown. The peel chain is visible, it&rsquo;s clear that B2, D2, E1 are change addresses which belong to the same wallet as A1.</p><pre tabindex=0><code>           --&gt; X
A1 --&gt; X   --&gt; X
   --&gt; B2  --&gt; X
           --&gt; D2 --&gt; E1
                  --&gt; X
</code></pre><p>There are a number of ways to get evidence used for identifying wallet software:</p><ul><li><p>Address formats. Wallets generally only use one address type. If a transaction has all inputs and one output of the same address type (e.g. p2pkh), with the remaining output of a different type (p2sh), then a reasonable assumption is that the same-address-format output (p2pkh) is change and the different-address-format output (p2sh) is the payment which belongs to someone else.</p></li><li><p><a href=https://en.bitcoin.it/wiki/Script title=Script>Script</a> types. Each wallet generally uses only one script. For example, the sending wallet may be a <a href=https://en.bitcoin.it/wiki/P2SH title=P2SH>P2SH</a> 2-of-3 <a href=https://en.bitcoin.it/wiki/Multisignature title=Multisignature>multisignature</a> wallet, which makes a transaction to two outputs: one 2-of-3 multisignature address and the other 2-of-2 multisignature address. The different script is a strong indication that the output is payment and the other output is change.</p></li><li><p><a href=https://en.bitcoin.it/wiki/BIP_0069 title="BIP 0069">BIP69</a> Lexicographical Indexing of Transaction Inputs and Outputs. This BIP describes a standard way for wallets to order their inputs and outputs for privacy. Right now the wallet ecosystem has a mixture of wallets which do and don&rsquo;t implement the standard, which helps with fingerprinting. Note that the common one-input-two-output transaction with random ordering will follow BIP69 just by chance 50% of the time.</p></li><li><p>Number of inputs and outputs. Different users often construct transactions differently. For example, individuals often make transaction with just two outputs; a payment and change, while high-volume institutions like casinos or exchanges use <a href=https://en.bitcoin.it/wiki/Techniques_to_reduce_transaction_fees#Consolidation title="Techniques to reduce transaction fees">consolidation</a> and <a href=https://en.bitcoin.it/wiki/Techniques_to_reduce_transaction_fees#Payment_batching title="Techniques to reduce transaction fees">batching</a> <sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup> <sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup>. An output that is later use to create a batching transaction was probably not the change. This heuristic is also called the &ldquo;consumer heuristic&rdquo;.</p></li><li><p>Transaction fields. Values in the transaction format which may vary depending on the wallet software: <a href=https://en.bitcoin.it/wiki/NLockTime title=NLockTime>nLockTime</a> is a field in transactions set by some wallets to make <a href=https://en.bitcoin.it/wiki/Fee_sniping title="Fee sniping">fee sniping</a> less profitable. A mixture of wallets in the ecosystem do and don&rsquo;t implement this feature. nLockTime can also be used as in certain privacy protocols like <a href=https://en.bitcoin.it/wiki/CoinSwap title=CoinSwap>CoinSwap</a>. <a href=https://en.bitcoin.it/wiki/Transaction#General_format_.28inside_a_block.29_of_each_input_of_a_transaction_-_Txin title=Transaction>nSequence</a> is another example. Also the version number.</p></li><li><p>Low-R value signatures. The DER format used to encode Bitcoin signatures requires adding an entire extra byte to a signature just to indicate when the signature’s R value is on the top-half of the elliptical curve used for Bitcoin. The R value is randomly derived, so half of all signatures have this extra byte. As of July 2018 <sup id=fnref:8><a href=#fn:8 class=footnote-ref role=doc-noteref>8</a></sup> Bitcoin Core only generates signatures with a low-R value that don&rsquo;t require this extra byte. By doing so, Bitcoin Core transactions will save one byte per every two signatures (on average). As of 2019 no other wallet does this, so a high-R signature is evidence that Bitcoin Core is not being used <sup id=fnref:9><a href=#fn:9 class=footnote-ref role=doc-noteref>9</a></sup>.</p></li><li><p>Uncompressed and compressed public keys. Older wallet software uses uncompressed public keys <sup id=fnref:10><a href=#fn:10 class=footnote-ref role=doc-noteref>10</a></sup>. A mixture of compressed and uncompressed keys can be used for fingerprinting.</p></li><li><p>Miner fees. Various wallet softwares may respond to block space pressure in different ways which could lead to different kinds of miner fees being paid. This might also be a way of fingerprinting wallets.</p></li><li><p>Coin Selection. Various wallet softwares may choose which UTXOs to spend using different algorithms that could be used for fingerprinting.</p></li></ul><p>If multiple users are using the same wallet software, then wallet fingerprinting cannot detect the change address. It is also possible that a single user owns two different wallets which use different software (for example a hot wallet and cold wallet) and then transactions between different softwares would not indicate a change of ownership. Wallet fingerprinting on its own is never decisive evidence, but as with all other privacy leaks it works best with data fusion when multiple privacy leaks are combined.</p><h3 id=round-numbers>Round numbers
<a class=anchor href=#round-numbers>#</a></h3><p>Many payment amounts are round numbers, for example 1 BTC or 0.1 BTC. The leftover change amount would then be a non-round number (e.g. 1.78213974 BTC). This potentially useful for finding the change address. The amount may be a round number in another currency. The amount 2.24159873 BTC isn&rsquo;t round in bitcoin but when converted to USD it may be close to $100.</p><h3 id=fee-bumping>Fee bumping
<a class=anchor href=#fee-bumping>#</a></h3><p><a href=https://en.bitcoin.it/wiki/BIP_0125 title="BIP 0125">BIP 0125</a> defines a mechanism for replacing an unconfirmed transaction with another transaction that pays a higher fee. In the context of the <a href=https://en.bitcoin.it/wiki/Miner_fees#The_market_for_block_space title="Miner fees">market for block space</a>, a user may find their transaction isn&rsquo;t confirming fast enough so they opt to <a href=https://en.bitcoin.it/wiki/Fee_bumping title="Fee bumping">&ldquo;fee bump&rdquo;</a> or pay a higher miner fee. However generally the new higher miner fee will happen by reducing the change amount. So if an adversary is observing all unconfirmed transactions they could see both the earlier low-fee transaction and later high-fee transaction, and the output with the reduced amount would be the change output.</p><p>This could be mitigated by some of the time reducing the amount of both outputs, reducing the payment amount instead of change (in a receiver-pays-for-fee model), or replacing both addresses in each RBF transaction (this would require obtaining multiple payment addresses from the receiver).</p><h3 id=unnecessary-input-heuristic>Unnecessary input heuristic
<a class=anchor href=#unnecessary-input-heuristic>#</a></h3><p>Also called the &ldquo;optimal change heuristic&rdquo;. Consider this bitcoin transaction. It has two inputs worth 2 BTC and 3 BTC and two outputs worth 4 BTC and 1 BTC.</p><pre tabindex=0><code>2 btc --&gt; 4 btc
3 btc     1 btc
</code></pre><p>Assuming one of the outputs is change and the other output is the payment. There are two interpretations: the payment output is either the 4 BTC output or the 1 BTC output. But if the 1 BTC output is the payment amount then the 3 BTC input is unnecessary, as the wallet could have spent only the 2 BTC input and paid lower miner fees for doing so. This is an indication that the real payment output is 4 BTC and that 1 BTC is the change output.</p><p>This is an issue for transactions which have more than one input. One way to fix this leak is to add more inputs until the change output is higher than any input, for example:</p><pre tabindex=0><code>2 btc --&gt; 4 btc
3 btc     6 btc
5 btc
</code></pre><p>Now both interpretations imply that some inputs are unnecessary. Unfortunately this costs more in miner fees and can only be done if the wallet actually owns other UTXOs.</p><p>Some wallets have a coin selection algorithm which violates this heuristic. An example might be because the wallets want to <a href=https://en.bitcoin.it/wiki/Techniques_to_reduce_transaction_fees#Consolidation title="Techniques to reduce transaction fees">consolidate inputs</a> in times of cheap miner fees. So this heuristic is not decisive evidence.</p><h3 id=sending-to-a-different-script-type>Sending to a different script type
<a class=anchor href=#sending-to-a-different-script-type>#</a></h3><p>Sending funds to a different script type than the one you&rsquo;re spending from makes it easier to tell which output is the change.</p><p>For example, for a transaction with 1 input spending a p2pkh coin and creating 2 outputs, one of p2pkh and one of p2sh, it is very likely that the p2pkh output is the change while the p2sh one is the payment.</p><p>This is also possible if the inputs are of mixed types (created by wallets supporting multiple script types for backwards compatibility). If one of the output script types is known to be used by the wallet (because the same script type is spent by at least one of the inputs) while the other is not, the other one is likely to be the payment.</p><p>This has the most effect on early adopters of new wallet technology, like p2sh or segwit. The more rare it is to pay to people using the same script type as you do, the more you leak the identity of your change output. This will improve over time as the new technology gains wider adoption.</p><h3 id=wallet-bugs>Wallet bugs
<a class=anchor href=#wallet-bugs>#</a></h3><p>Some wallet software handles change in a very un-private way. For example certain old wallets would always put the change output in last place in the transaction. An old version of Bitcoin Core would add input UTXOs to the transaction until the change amount was around 0.1 BTC, so an amount of slightly over 0.1 BTC would always be change.</p><h3 id=equal-output-coinjoin>Equal-output CoinJoin
<a class=anchor href=#equal-output-coinjoin>#</a></h3><p>Equal-output-CoinJoin transactions trivially reveal the change address because it is the outputs which are not equal-valued. For example consider this equal-output-coinjoin:</p><pre tabindex=0><code>              A (1btc)
X (5btc) ---&gt; B (1btc)
Y (3btc)      C (4btc)
              D (2btc)
</code></pre><p>There is a very strong indication that output D is change belongs to the owner of input Y, while output C is change belonging to input X. However, CoinJoin breaks the common-input-ownership heuristic and effectively hides the ownership of payment outputs (A and B), so the tradeoffs are still heavily in favour of using coinjoin.</p><h3 id=cluster-growth>Cluster growth
<a class=anchor href=#cluster-growth>#</a></h3><p>Wallet clusters created by using the common-input-ownership heuristic usually grow (in number of addresses) slowly and incrementally <sup id=fnref:11><a href=#fn:11 class=footnote-ref role=doc-noteref>11</a></sup>. Two large clusters merging is rare and may indicate that the heuristics are flawed. So another way to deduce the change address is to find which output causes the clusters to grow only slowly. The exact value for &ldquo;how slowly&rdquo; a cluster is allowed to grow is an open question.</p><h2 id=transaction-graph-heuristic>Transaction graph heuristic
<a class=anchor href=#transaction-graph-heuristic>#</a></h2><p>As described in the introduction, addresses are connected together by transactions on the block chain. The mathematical concept of a <a href=https://en.wikipedia.org/wiki/Graph_%28discrete_mathematics%29>graph</a> can be used to describe the structure where addresses are connected with transactions. Addresses are vertices while transactions are edges in this transaction graph.</p><p>This is called a heuristic because transactions on the block chain do not necessarily correspond to real economic transactions. For example the transaction may represent someone sending bitcoins to themselves. Also, real economic transactions may not appear on the block chain but be <a href=https://en.bitcoin.it/wiki/Off-Chain_Transactions title="Off-Chain Transactions">off-chain</a>; either via a custodial entity like an exchange, or non-custodial off-chain like Lightning Network.</p><h3 id=taint-analysis>Taint analysis
<a class=anchor href=#taint-analysis>#</a></h3><p><em>Taint analysis</em> is a technique sometimes used to study the flow of bitcoins and extract privacy-relevant information. If an address A is connected to privacy-relevant information (such as a real name) and it makes a transaction sending coins to address B, then address B is said to be <em>tainted</em> with coins from address A. In this way taint is spread by &ldquo;touching&rdquo; via transactions <sup id=fnref:12><a href=#fn:12 class=footnote-ref role=doc-noteref>12</a></sup>. It is unclear how useful taint analysis is for spying, as it does not take into account transfer of ownership. For example an owner of tainted coins may donate some of them to some charity, the donated coins could be said to be tainted yet the charity does not care and could not give any information about the source of those coins. Taint analysis may only be useful for breaking schemes where someone tries to hide the origin of coins by sending dozens of fake transactions to themselves many times.</p><h2 id=amount>Amount
<a class=anchor href=#amount>#</a></h2><p>Blockchain transactions contain amount information of the transaction inputs and outputs, as well as an implicit amount of the miner fee. This is visible to all.</p><p>Often the payment amount of a transaction is a round number, possibly when converted to another currency. An analysis of round numbers in bitcoin transactions has been used to measure the countries or regions where payment have happened <sup id=fnref:13><a href=#fn:13 class=footnote-ref role=doc-noteref>13</a></sup>.</p><h3 id=input-amounts-revealing-sender-wealth>Input amounts revealing sender wealth
<a class=anchor href=#input-amounts-revealing-sender-wealth>#</a></h3><p>A mismatch in the sizes of available input vs what is required can result in a privacy leak of the total wealth of the sender. For example, when intending to send 1 bitcoins to somebody a user may only have an input worth 10 bitcoins. They create a transaction with 1 bitcoin going to the recipient and 9 bitcoins going to a change address. The recipient can look at the transaction on the blockchain and deduce that the sender owned at least 10 bitcoins.</p><p>By analogy with paper money, if you hand over a 100 USD note to pay for a drink costing only 5 USD the bartender learns that your balance is at least 95 USD. It may well be higher of course, but it&rsquo;s at least not lower <sup id=fnref:14><a href=#fn:14 class=footnote-ref role=doc-noteref>14</a></sup>.</p><h3 id=exact-payment-amounts-no-change>Exact payment amounts (no change)
<a class=anchor href=#exact-payment-amounts-no-change>#</a></h3><p>Payments that send exact amounts and take no change are a likely indication that the bitcoins didn&rsquo;t move hands.</p><p>This usually means that the user used the &ldquo;send maximum amount&rdquo; wallet feature to transfer funds to her new wallet, to an exchange account, to fund a lightning channel, or other similar cases where the bitcoins remain under the same ownership.</p><p>Other possible reasons for sending exact amounts with no change is that the coin-selection algorithm was smart and lucky enough to find a suitable set of inputs for the intended payment amount that didn&rsquo;t require change (or required a change amount that is negligible enough to waive), or advanced users using manual coin selection to explicitly avoid change.</p><h2 id=batching>Batching
<a class=anchor href=#batching>#</a></h2><p><a href=https://en.bitcoin.it/wiki/Techniques_to_reduce_transaction_fees#Payment_batching title="Techniques to reduce transaction fees">Payment batching</a> is a technique to reduce the miner fee of a payment. It works by batching up several payments into one block chain transaction. It is typically used by exchanges, casinos and other high-volume spenders.</p><p>The privacy implication comes in that recipients can see the amount and address of recipients <sup id=fnref:15><a href=#fn:15 class=footnote-ref role=doc-noteref>15</a></sup>.</p><p>When you receive your withdrawal from Kraken, you can look up your transaction on a block chain explorer and see the addresses of everyone else who received a payment in the same transaction. You don’t know who those recipients are, but you do know they received bitcoins from Kraken the same as you.</p><p>That’s not good for privacy, but it’s also perhaps not the worst thing. If Kraken made each of those payments separately, they might still be connected together through the change outputs and perhaps also by certain other identifying characteristics that block chain analysis companies and private individuals use to fingerprint particular spenders.</p><p>However, it is something to keep in mind if you’re considering batching payments where privacy might be especially important or already somewhat weak, such as making payroll in a small company where you don’t want each employee to learn the other employees’ salaries.</p><h2 id=unusual-scripts>Unusual scripts
<a class=anchor href=#unusual-scripts>#</a></h2><p>Most but not all bitcoin <a href=https://en.bitcoin.it/wiki/Script title=Script>scripts</a> are single-signature. Other scripts are possible with the most common being <a href=https://en.bitcoin.it/wiki/Multisignature title=Multisignature>multisignature</a>. A script which is particularly unusual can leak information simply by being so unique.</p><p>2-of-3 multisig is by far the most common non-single-signature script as of 2019.</p><h2 id=mystery-shopper-payment>Mystery shopper payment
<a class=anchor href=#mystery-shopper-payment>#</a></h2><p>A <a href=https://en.bitcoin.it/wiki/Mystery_shopper_payments title="Mystery shopper payments">mystery shopper payment</a> is when an adversary pays bitcoin to a target in order to obtain privacy-relevant information. It will work even if address reuse is avoided. For example, if the target is an online merchant then the adversary could buy a small item. On the payment interface they would be shown one of the merchant&rsquo;s bitcoin addresses. The adversary now knows that this address belongs to the merchant and by watching the blockchain for later transactions other information would be revealed, which when combined with other techniques could reveal a lot of data about the merchant. The common-input-ownership heuristic and change address detection could reveal other addresses belonging to the merchant (assuming countermeasures like CoinJoin are not used) and could give a lower-bound for the sales volume. This works because anybody on the entire internet can request one of the merchant&rsquo;s addresses.</p><h2 id=forced-address-reuse>Forced address reuse
<a class=anchor href=#forced-address-reuse>#</a></h2><p><strong>Forced address reuse</strong> is when an adversary pays an (often small) amount of bitcoin to addresses that have already been used on the block chain. The adversary hopes that users or their wallet software will use these <em>forced payments</em> as inputs to a larger transaction which will reveal other addresses via the the common-input-ownership heuristic and thereby leak more privacy-relevant information. These payments can be understood as a way to coerce the address owner into unintentional address reuse <sup id=fnref:16><a href=#fn:16 class=footnote-ref role=doc-noteref>16</a></sup> <sup id=fnref:17><a href=#fn:17 class=footnote-ref role=doc-noteref>17</a></sup>.</p><p>This attack is sometimes incorrectly called a <strong>dust attack</strong> <sup id=fnref:18><a href=#fn:18 class=footnote-ref role=doc-noteref>18</a></sup>.</p><p>If the forced-payment coins have landed on already-used <em>empty</em> addresses, then the correct behaviour by wallets is to not spend those coins ever. If the coins have landed on addresses which are not empty, then the correct behaviour by wallets is to fully-spend all the coins on that address in the same transaction.</p><h2 id=amount-correlation>Amount correlation
<a class=anchor href=#amount-correlation>#</a></h2><p>Amounts correlation refers to searching the entire block chain for output amounts.</p><p>For example, say we&rsquo;re using any black box privacy technology that breaks the transaction graph.</p><pre tabindex=0><code>V --&gt; [black box privacy tech] --&gt; V - fee
</code></pre><p>The privacy tech is used to mix V amount of bitcoins, and it returns V bitcoins minus fees back to the user. Amount correlation could be used to unmix this tech by searching the blockchain for transactions with an output amount close to V.</p><p>A way to resist amount correlation is to split up the sending of bitcoins back to user into many transactions with output amounts (w0, w1, w2) which together add up to V minus fees.</p><pre tabindex=0><code>V --&gt; [privacy tech] 	--&gt; w0
			--&gt; w1
			--&gt; w2
</code></pre><p>Another way of using amount correlation is to use it to find a starting point. For example, if Bob wants to spy on Alice. Say that Alice happens to mention in passing that she&rsquo;s going on holiday costing $5000 with her boyfriend, Bob can search all transactions on the blockchain in the right time period and find transactions with output amounts close to $5000. Even if multiple matches are found it still gives Bob a good idea of which bitcoin addresses belong to Alice.</p><h2 id=timing-correlation>Timing correlation
<a class=anchor href=#timing-correlation>#</a></h2><p>Timing correlation refers to using the time information of transactions on the blockchain. Similar to amount correlation, if an adversary somehow finds out the time that an interesting transaction happened they can search the blockchain in that time period to narrow down their candidates.</p><p>This can be beaten by uniform-randomly choosing a time between now and an appropriate time_period in which to broadcast the bitcoin transaction. This forces an adversary to search much more of the existing transactions; they have to equally consider the entire anonymity set between now and time_period.</p><h1 id=non-blockchain-attacks-on-privacy>Non-blockchain attacks on privacy
<a class=anchor href=#non-blockchain-attacks-on-privacy>#</a></h1><h2 id=traffic-analysis>Traffic analysis
<a class=anchor href=#traffic-analysis>#</a></h2><p>Bitcoin nodes communicate with each other via a <a href=https://en.bitcoin.it/wiki/Network title=Network>peer-to-peer network</a> to transmit transactions and blocks. <a href=https://en.bitcoin.it/wiki/Network#Standard_relaying title=Network>Nodes relay</a> these packets to all their connections, which has good privacy properties because a connected node doesn&rsquo;t know whether the transmitted data originated from its peer or whether the peer was merely relaying it.</p><p>An adversary able to snoop on your internet connection (such as your government, ISP, Wifi provider or VPN provider) can see data sent and received by your node. This would reveal that you are a bitcoin user. Even if a connection is encrypted the adversary could still see the timings and sizes of data packets. A block being mined results in a largely synchronized burst of identically-sized traffic for every bitcoin node, because of this bitcoin nodes are very vulnerable to traffic analysis revealing the fact that bitcoin is being used.</p><p>If the adversary sees a transaction or block coming out of your node which did not previously enter, then it can know with near-certainty that the transaction was made by you or the block was mined by you. As internet connections are involved, the adversary will be able to link the IP address with the discovered bitcoin information.</p><p>A certain kind of <a href=https://en.bitcoin.it/wiki/Weaknesses#Sybil_attack title=Weaknesses>sybil attack</a> can be used to discover the source of a transaction or block without the adversary entirely controlling the victims internet connection. It works by the adversary creating many of their own fake nodes on different IP addresses which aggressively announce themselves in an effort to attract more nodes to connect to them, they also try to connect to as many other listening nodes as they can. This high connectivity help the adversary to locate the source newly-broadcasted transactions and blocks by tracking them as they propagate through the <a href=https://en.bitcoin.it/wiki/Network title=Network>network</a> <sup id=fnref:19><a href=#fn:19 class=footnote-ref role=doc-noteref>19</a></sup> <sup id=fnref:20><a href=#fn:20 class=footnote-ref role=doc-noteref>20</a></sup> <sup id=fnref:21><a href=#fn:21 class=footnote-ref role=doc-noteref>21</a></sup> <sup id=fnref:22><a href=#fn:22 class=footnote-ref role=doc-noteref>22</a></sup>. Some wallets periodically rebroadcast their unconfirmed transactions so that they are more likely to propagate widely through the network and be <a href=https://en.bitcoin.it/wiki/Confirmation title=Confirmation>mined</a>.</p><p>Some wallets are not full nodes but are lightweight nodes which function in a different way. They generally have far worse privacy properties, but how badly depends on the details of each wallet. Some <a href=https://en.bitcoin.it/wiki/Lightweight_node title="Lightweight node">lightweight wallets</a> can be connected only to your own full node, and if that is done then their privacy with respect to traffic analysis will be improved to the level of a full node.</p><h2 id=custodial-wallets>Custodial Wallets
<a class=anchor href=#custodial-wallets>#</a></h2><p>Some bitcoin wallets are just front-ends that connects to a back-end server run by some company. This kind of wallet has no privacy at all, the operating company can see all the user&rsquo;s addresses and all their transactions, most of the time they&rsquo;ll see the user&rsquo;s IP address too. Users should not use web wallets.</p><p>Main article: <a href=https://en.bitcoin.it/wiki/Browser-based_wallet title="Browser-based wallet">Browser-based wallet</a></p><h2 id=wallet-history-retrieval-from-third-party>Wallet history retrieval from third-party
<a class=anchor href=#wallet-history-retrieval-from-third-party>#</a></h2><p>All bitcoin wallets must somehow obtain information about their balance and history, which may leak information about which addresses and transactions belong to them.</p><h3 id=blockchain-explorer-websites>Blockchain explorer websites
<a class=anchor href=#blockchain-explorer-websites>#</a></h3><p><a href=https://en.bitcoin.it/wiki/Block_chain_browser title="Block chain browser">Blockchain explorer websites</a> are commonly used. Some users even search for their transaction on those websites and refresh it until it reaches 3 confirmations. This is very bad for privacy as the website can easily link the user&rsquo;s IP address to their bitcoin transaction (unless Tor is used), and the queries to their website reveal that the transaction or address is of interest to somebody who has certain behavioural patterns.</p><p>To get information about your transactions it is much better to use your wallet software, not some website.</p><h3 id=bip-37>BIP 37
<a class=anchor href=#bip-37>#</a></h3><p>Many <a href=https://en.bitcoin.it/wiki/Lightweight_node title="Lightweight node">lightweight wallets</a> use the <a href=https://en.bitcoin.it/wiki/BIP_0037 title="BIP 0037">BIP37</a> standard, which has serious design flaws leading to privacy leaks. Any wallet that uses <a href=https://en.bitcoin.it/wiki/BIP_0037 title="BIP 0037">BIP37</a> provides no privacy at all and is equivalent to sending all the wallets addresses to a random server. That server can easily spy on the wallet. Lessons from the failure of BIP37 can be useful when designing and understanding other privacy solutions, especially with the point about data fusion of combining BIP37 bloom filter leaks with blockchain transaction information leaks.</p><p>Main article: <a href=https://en.bitcoin.it/wiki/BIP37_privacy_problems title="BIP37 privacy problems">BIP37 privacy problems</a></p><h3 id=public-electrum-servers>Public Electrum servers
<a class=anchor href=#public-electrum-servers>#</a></h3><p>Electrum is a popular software wallet which works by connecting to special purpose servers. These servers receive hashes of the bitcoin addresses in the wallet and reply with transaction information. The Electrum wallet is fast and low-resource but by default it connects to these servers which can easily spy on the user. Some other software aside from Electrum uses the public Electrum servers. As of 2019 it is a faster and better alternative for <a href=https://en.bitcoin.it/wiki/Lightweight_node title="Lightweight node">lightweight wallets</a> than BIP37.</p><p>Servers only learn the hashes of addresses rather than addresses themselves, in practice they only know the actual address and associated transactions if it&rsquo;s been used on the blockchain at least once.</p><p>It is not very difficult to run your own Electrum server and point your wallet to use only it. This restores Electrum to have the same privacy and security properties as a full node where nobody else can see which addresses or transactions the wallet is interested in. Then Electrum becomes a full node wallet.</p><h2 id=communication-eavesdropping>Communication eavesdropping
<a class=anchor href=#communication-eavesdropping>#</a></h2><p>A simple but effective privacy leak. Alice gives Bob one of her addresses to receive a payment, but the communication has been eavesdropped by Eve who saw the address and now knows it belongs to Alice. The solution is to encrypt addresses where appropriate or use another way of somehow hiding them from an adversary as per the threat model.</p><p>Sometimes the eavesdropping can be very trivial, for example some forum users publish a bitcoin donation address on their website, forum signature, profile, twitter page, etc where it can be picked up by search engines. In the example of the non-anonymous Chinese newspaper buyer from the introduction, his address being publicly visible on his forum signature was a crucial part of his deanonymization. The solution here is to show each potential donator a new address, for example <a href=https://en.bitcoin.it/wiki/Receiving_donations_with_bitcoin#Improving_privacy_by_avoiding_address_re-use title="Receiving donations with bitcoin">by setting up a web server to hand out unique addresses to each visitor</a>.</p><h2 id=revealing-data-when-transacting-bitcoin>Revealing data when transacting bitcoin
<a class=anchor href=#revealing-data-when-transacting-bitcoin>#</a></h2><p>Sometimes users may voluntarily reveal data about themselves, or be required to by the entity they interact with. For example many exchanges require users to undergo Anti-Money Laundering and Know-Your-Customer (AML/KYC) checks, which requires users to reveal all kinds of invasive personal information such as their real name, residence, occupation and income. All this information is then linked with the bitcoin addresses and transactions that are later used.</p><p>When buying goods online with bitcoin a delivery mail address is needed. This links the bitcoin transaction with the delivery address. The same applies to the user&rsquo;s IP address (unless privacy technology like Tor is used).</p><h2 id=digital-forensics>Digital forensics
<a class=anchor href=#digital-forensics>#</a></h2><p>Wallet software usually stores information it needs to operate on the disk of the computer it runs on. If an adversary has access to that disk it can extract bitcoin addresses and transactions which are known to be linked with the owner of that disk. The same disk might contain other personal information (such as a scan of an ID card). Digital forensics is one reason why all good wallet software encrypts wallet files, although that can be beaten if a weak encryption password is used.</p><p>For example if you have a bitcoin wallet installed on your PC and give the computer to a repair shop to fix, then the repair shop operator could find the wallet file and records of all your transactions. Other examples might be if an old hard disk is thrown away. Other software installed on the same computer (such as malware) can also read from disk or RAM to spy on the bitcoin transactions made by the user.</p><p>For privacy don&rsquo;t leave data on your computer available to others. Exactly how depends on your threat model. Encryption and physical protection are options, as is using special operating systems like <a href=https://tails.boum.org/>Tails OS</a> which does not read or write from the hard drive but only uses RAM, and then deletes all data on shutdown.</p><h1 id=methods-for-improving-privacy-non-blockchain>Methods for improving privacy (non-blockchain)
<a class=anchor href=#methods-for-improving-privacy-non-blockchain>#</a></h1><h2 id=obtaining-bitcoins-anonymously>Obtaining bitcoins anonymously
<a class=anchor href=#obtaining-bitcoins-anonymously>#</a></h2><p>If the adversary has not linked your bitcoin address with your identity then privacy is much easier. Blockchain spying methods like the common-input-ownership heuristic, detecting change addresses and amount correlation are not very effective on their own if there is no starting point to link back to.</p><p>Many exchanges require users to undergo Anti-Money Laundering and Know-Your-Customer (AML/KYC) checks, which requires users to reveal all kinds of invasive personal information such as their real name, residence, occupation and income. All this information is then linked with the bitcoin addresses and transactions that are later used.</p><p>Avoiding the privacy invasion of AML/KYC is probably the single most important thing an individual can do to improve their privacy. It works far better than any actual technology like CoinJoin. Indeed all the cryptography and privacy tricks are irrelevant if all users only ever transact between AML/KYC institutions <sup id=fnref:23><a href=#fn:23 class=footnote-ref role=doc-noteref>23</a></sup>.</p><h3 id=cash-trades>Cash trades
<a class=anchor href=#cash-trades>#</a></h3><p>Physical cash is an anonymous medium of exchange, so using it is a way to obtain bitcoin anonymously where no one except trading partners exchange identifying data.</p><p>This section won&rsquo;t list websites to find such meetups because the information can go out of date, but try searching the web with &ldquo;buy bitcoin for cash &lt;your location>&rdquo;. Note that some services still require ID so that is worth checking. Some services require ID only for the trader placing the advert. As of late-2018 there is at least one <a href=https://en.bitcoin.it/wiki/Bisq title=Bisq>decentralized exchange open source project</a> in development which aims to facilitate this kind of trading without a needing a centralized third party at all but instead using a peer-to-peer network.</p><p><strong>Cash-in-person</strong> trades are an old and popular method. Two traders arrange to meet up somewhere and the buyer hands over cash while the seller makes a bitcoin transaction to the buyer. This is similar to other internet phenomena like Craigslist which organize meetups for exchange. <a href=https://en.bitcoin.it/wiki/Secure_Trading#Use_an_Escrow_Service title="Secure Trading">Escrow can be used</a> to improve safety or to avoid the need to wait for confirmations at the meetup.</p><p><strong>Cash-by-mail</strong> works by having the buyer send physical cash through the mail. <a href=https://en.bitcoin.it/wiki/Secure_Trading#Use_an_Escrow_Service title="Secure Trading">Escrow is always used</a> to prevent scamming. The buyer of bitcoins can be very anonymous but the seller must reveal a mail address to the buyer. Cash-by-mail can work over long distances but does depend on the postal service infrastructure. Users should check with their local postal service if there are any guidelines around sending cash-by-mail. Often the cash can also be insured.</p><p><strong>Cash deposit</strong> is a method where the buyer deposits cash directly into the seller&rsquo;s bank account. Again <a href=https://en.bitcoin.it/wiki/Secure_Trading#Use_an_Escrow_Service title="Secure Trading">escrow is used</a>, and again the buyer of bitcoins can be near-anonymous but the seller must sign up with a bank or financial institution and share with them rather invasive details about one&rsquo;s identity and financial history. This method relies on the personal banking infrastructure so works over long distances.</p><p><strong>Cash dead drop</strong> is a rarely used method. It is similar to a cash-in-person trade but the traders never meet up. The buyer chooses a location to hide the cash in a public location, next the buyer sends a message to the seller telling them the location, finally the seller picks up the cash from the hidden location. <a href=https://en.bitcoin.it/wiki/Secure_Trading#Use_an_Escrow_Service title="Secure Trading">Escrow is a requirement</a> to avoid scamming. This method is very anonymous for the buyer as the seller won&rsquo;t even learn their physical appearance, for the seller it is slightly less anonymous as the buyer can stalk the location to watch the seller collect the cash.</p><h3 id=cash-substitute>Cash substitute
<a class=anchor href=#cash-substitute>#</a></h3><p>Cash substitutes like gift cards, mobile phone credits or prepaid debit cards can often be bought from regular stores with cash and then traded online for bitcoin.</p><h3 id=employment>Employment
<a class=anchor href=#employment>#</a></h3><p>Bitcoins accepted as payment for work done can be anonymous if the employer does not request much personal information. This may work well in a freelancing or contracting setting. Although if your adversary is your own employer then obviously this is not good privacy.</p><h3 id=mining>Mining
<a class=anchor href=#mining>#</a></h3><p>Mining is the most anonymous way to obtain bitcoin. This applies to solo-mining as mining pools generally know the hasher&rsquo;s IP address. Depending on the size of operation mining may use a lot of electrical power which may attract suspicion. Also the <a href=https://en.bitcoin.it/wiki/ASIC title=ASIC>specialized mining hardware</a> may be difficult to get hold of anonymously (although they wouldn&rsquo;t be linked to the resulting mined bitcoins).</p><h3 id=stealing>Stealing
<a class=anchor href=#stealing>#</a></h3><p>In theory another way of obtaining anonymous bitcoin is to steal them <sup id=fnref:24><a href=#fn:24 class=footnote-ref role=doc-noteref>24</a></sup>.</p><p>There is at least one situation where this happened. In May 2015 a hacker known as Phineas Fisher <sup id=fnref:25><a href=#fn:25 class=footnote-ref role=doc-noteref>25</a></sup> hacked a spyware company that was selling surveillance products to dictators <sup id=fnref:26><a href=#fn:26 class=footnote-ref role=doc-noteref>26</a></sup>. The hacker used bitcoin stolen from other people to anonymously rent infrastructure for later attacks.</p><h2 id=spending-bitcoins-anonymously>Spending bitcoins anonymously
<a class=anchor href=#spending-bitcoins-anonymously>#</a></h2><p>If you give up your delivery address (which you&rsquo;ll have to if you&rsquo;re buying physical goods online) then that will be a data leak. Obviously this is unavoidable in many cases.</p><h2 id=wallet-history-synchronization>Wallet history synchronization
<a class=anchor href=#wallet-history-synchronization>#</a></h2><p>Bitcoin wallets must somehow obtain information about their balance and history. As of late-2018 the most practical and private existing solutions are to use a full node wallet (which is maximally private) and <a href=https://en.bitcoin.it/wiki/Client-side_block_filtering title="Client-side block filtering">client-side block filtering</a> (which is very good).</p><p>One issue with these technologies is that they always costs more resources (time, bandwidth, storage, etc) than non-private solutions like web wallets and centralized Electrum servers. There are measurements indicating that very few people actually use <a href=https://en.bitcoin.it/wiki/BIP_0037 title="BIP 0037">BIP37</a> because of how slow it is <sup id=fnref:27><a href=#fn:27 class=footnote-ref role=doc-noteref>27</a></sup>, so even <a href=https://en.bitcoin.it/wiki/Client-side_block_filtering title="Client-side block filtering">client-side block filtering</a> may not be used very much.</p><h3 id=full-node>Full node
<a class=anchor href=#full-node>#</a></h3><p>Full nodes download the entire blockchain which contains every on-chain transaction that has ever happened in bitcoin. So an adversary watching the user&rsquo;s internet connection <a href=https://en.bitcoin.it/wiki/Full_node#Privacy title="Full node">will not be able to learn</a> which transactions or addresses the user is interested in. This is the best solution to wallet history synchronization with privacy, but unfortunately it costs a significant amount in time and bandwidth.</p><h3 id=private-information-retrieval>Private information retrieval
<a class=anchor href=#private-information-retrieval>#</a></h3><p>In cryptography, a private information retrieval (PIR) protocol is a protocol that allows a user to retrieve an item from a server in possession of a database without revealing which item is retrieved. This has been proposed as a way to private synchronize wallet history but as PIR is so resource-intensive, users who don&rsquo;t mind spending bandwidth and time could just run a full node instead.</p><h3 id=client-side-block-filtering>Client-side block filtering
<a class=anchor href=#client-side-block-filtering>#</a></h3><p><a href=https://en.bitcoin.it/wiki/Client-side_block_filtering title="Client-side block filtering">Client-side block filtering</a> works by having filters created that contains all the addresses for every transaction in a block. The filters can test whether an element is in the set; false positives are possible but not false negatives. A lightweight wallet would download all the filters for every block in the blockchain and check for matches with its own addresses. Blocks which contain matches would be downloaded in full from the <a href=https://en.bitcoin.it/wiki/Network title=Network>peer-to-peer network</a>, and those blocks would be used to obtain the wallet&rsquo;s history and current balance.</p><h3 id=address-query-via-onion-routing>Address query via onion routing
<a class=anchor href=#address-query-via-onion-routing>#</a></h3><p>Wallet histories can be obtained from centralized servers (such as Electrum servers) but using a new Tor circuit for each address. A closely-related idea is to connect together Electrum servers in an onion-routing network <sup id=fnref:28><a href=#fn:28 class=footnote-ref role=doc-noteref>28</a></sup>. When creating such a scheme, care should be taken to avoid timing correlation linking the addresses together, otherwise the server could use the fact that the addresses were requested close to each other in time.</p><h2 id=countermeasures-to-traffic-analysis>Countermeasures to traffic analysis
<a class=anchor href=#countermeasures-to-traffic-analysis>#</a></h2><p>Bitcoin Core and its forks have countermeasures against <a href=https://en.bitcoin.it/wiki/Weaknesses#Sybil_attack title=Weaknesses>sybil attack</a> and eclipse attacks. Eclipse attacks are sybil attacks where the adversary attempts to control all the peers of its target and block or control access to the rest of the network <sup id=fnref:29><a href=#fn:29 class=footnote-ref role=doc-noteref>29</a></sup>. Such attacks have been extensively studied in a 2015 paper <a href=https://eprint.iacr.org/2015/263.pdf>Eclipse Attacks on Bitcoin’s Peer-to-Peer Network</a> which has led to new code written for Bitcoin Core for mitigation <sup id=fnref:30><a href=#fn:30 class=footnote-ref role=doc-noteref>30</a></sup> <sup id=fnref:31><a href=#fn:31 class=footnote-ref role=doc-noteref>31</a></sup> <sup id=fnref:32><a href=#fn:32 class=footnote-ref role=doc-noteref>32</a></sup> <sup id=fnref:33><a href=#fn:33 class=footnote-ref role=doc-noteref>33</a></sup> <sup id=fnref:34><a href=#fn:34 class=footnote-ref role=doc-noteref>34</a></sup>.</p><p>Bitcoin Core and its forks use an algorithm known as trickling when relaying unconfirmed transactions, with the aim of making it as difficult as possible for sybil attackers to find the source IP address of a transaction. For each peer, the node keeps a list of transactions that it is going to <a href=https://en.bitcoin.it/wiki/Network#Messages title=Network>inv</a> to it. It sends <a href=https://en.bitcoin.it/wiki/Network#Messages title=Network>inv&rsquo;s</a> for transactions periodically with a random delay between each <a href=https://en.bitcoin.it/wiki/Network#Messages title=Network>inv</a>. Transactions are selected to go into the <a href=https://en.bitcoin.it/wiki/Network#Messages title=Network>inv</a> message somewhat randomly and according to some metrics involving fee rate. It selects a limited number of transactions to <a href=https://en.bitcoin.it/wiki/Network#Messages title=Network>inv</a>. The algorithm creates the possibility that a peered node may hear about an unconfirmed transaction from the creator&rsquo;s neighbours rather than the creator node itself <sup id=fnref:35><a href=#fn:35 class=footnote-ref role=doc-noteref>35</a></sup> <sup id=fnref:36><a href=#fn:36 class=footnote-ref role=doc-noteref>36</a></sup> <sup id=fnref:37><a href=#fn:37 class=footnote-ref role=doc-noteref>37</a></sup> <sup id=fnref:38><a href=#fn:38 class=footnote-ref role=doc-noteref>38</a></sup>. However adversaries can still sometimes obtain privacy-relevant information.</p><p>Encrypting messages between peers as in <a href=https://github.com/bitcoin/bips/blob/master/bip-0151.mediawiki>BIP 151</a> would make it harder for a passive attacker such as an ISP or Wifi provider to see the exact messages sent and received by a bitcoin node.</p><h3 id=tor-and-tor-broadcasting>Tor and tor broadcasting
<a class=anchor href=#tor-and-tor-broadcasting>#</a></h3><p>If a connection-controlling adversary is a concern, then bitcoin can be run entirely over Tor. Tor is encrypted and hides endpoints, so an ISP or Wifi providers won&rsquo;t even know you&rsquo;re using bitcoin. The other connected bitcoin nodes won&rsquo;t be able to see your IP address as Tor hides it. Bitcoin Core and its forks have features to make setting up and using Tor easier. Some <a href=https://en.bitcoin.it/wiki/Lightweight_node title="Lightweight node">lightweight wallets</a> also run entirely over Tor.</p><p>Running entirely over Tor has the downside that synchronizing the node requires downloading the entire blockchain over tor, which would be very slow. Downloading blocks over Tor only helps in the situation where you want to hide the fact that bitcoin is even being used from the internet service provider <sup id=fnref:39><a href=#fn:39 class=footnote-ref role=doc-noteref>39</a></sup>. It is possible to download <a href=https://en.bitcoin.it/wiki/Blocks title=Blocks>blocks</a> and unconfirmed transactions over clearnet but broadcast your own transactions over Tor, allowing a fast clearnet connection to be used while still providing privacy when broadcasting.</p><p>Bitcoin Core being configured with the option <code>walletbroadcast=0</code> will stop transactions belonging to the user from being broadcast and rebroadcast, allowing them to be broadcast instead via Tor or another privacy-preserving method <sup id=fnref:40><a href=#fn:40 class=footnote-ref role=doc-noteref>40</a></sup>.</p><h3 id=dandelion>Dandelion
<a class=anchor href=#dandelion>#</a></h3><p>Dandelion is another technology for private transaction broadcasting. The main idea is that transaction propagation proceeds in two phases: first the &ldquo;stem&rdquo; phase, and then &ldquo;fluff&rdquo; phase. During the stem phase, each node relays the transaction to a <em>single</em> peer. After a random number of hops along the stem, the transaction enters the fluff phase, which behaves just like ordinary transaction flooding/diffusion. Even when an attacker can identify the location of the fluff phase, it is much more difficult to identify the source of the stem <sup id=fnref:41><a href=#fn:41 class=footnote-ref role=doc-noteref>41</a></sup> <sup id=fnref:42><a href=#fn:42 class=footnote-ref role=doc-noteref>42</a></sup> <sup id=fnref:43><a href=#fn:43 class=footnote-ref role=doc-noteref>43</a></sup> <sup id=fnref:44><a href=#fn:44 class=footnote-ref role=doc-noteref>44</a></sup>.</p><h3 id=interactive-peer-broadcasting>Interactive peer broadcasting
<a class=anchor href=#interactive-peer-broadcasting>#</a></h3><p>Some privacy technologies like CoinJoin and <a href=https://en.bitcoin.it/wiki/CoinSwap title=CoinSwap>CoinSwap</a> require interactivity between many bitcoin entities. They can also be used to broadcast transactions with more privacy, because peers in the privacy protocols can send each other unconfirmed transactions using the already-existing protocol they use to interact with each other.</p><p>For example, in <a href=https://en.bitcoin.it/wiki/JoinMarket title=JoinMarket>JoinMarket</a> market takers can send transactions to market makers who will broadcast them and so improve the taker&rsquo;s privacy. This can be a more convenient for the taker than setting up Tor for use with <a href=/en/wiki-bitcoin-privacy/#tor-and-tor-broadcasting>tor broadcasting</a>.</p><h3 id=receiving-bitcoin-data-over-satellite>Receiving bitcoin data over satellite
<a class=anchor href=#receiving-bitcoin-data-over-satellite>#</a></h3><p>At least one bitcoin company offers a satellite bitcoin service <sup id=fnref:45><a href=#fn:45 class=footnote-ref role=doc-noteref>45</a></sup>. This is a free service where satellites broadcast the bitcoin blockchain to nearly anywhere in the world. If users set up a dish antenna pointing at a satellite in space, then they can receive bitcoin blocks needed to run a full node. As the satellite setups are receive-only nobody can detect that the user is even running bitcoin, and certainly not which addresses or transactions belong to them.</p><p>As of 2019 the company offers a paid-for API which allows broadcasting any data to anywhere in the world via satellite, which seems to be how they make their money. But it appears the base service of broadcasting the blockchain will always be free.</p><p>Main article: <a href=https://blockstream.com/satellite/>https://blockstream.com/satellite/</a></p><h1 id=methods-for-improving-privacy-blockchain>Methods for improving privacy (blockchain)
<a class=anchor href=#methods-for-improving-privacy-blockchain>#</a></h1><p>This section describes different techniques for improving the privacy of transactions related to the permanent record of transactions on the blockchain. Some techniques are trivial and are included in all good bitcoin wallets. Others have been implemented in some open source projects or services, which may use more than one technique at a time. Other techniques have yet to be been implemented. Many of these techniques focus on breaking different heuristics and assumptions about the blockchain, so they work best when combined together.</p><h2 id=avoiding-address-reuse>Avoiding address reuse
<a class=anchor href=#avoiding-address-reuse>#</a></h2><p>Addresses being used more than once is very damaging to privacy because that links together more blockchain transactions with proof that they were created by the same entity. The most private and secure way to use bitcoin is to send a brand new address to each person who pays you. After the received coins have been spent the address should never be used again. Also, a brand new bitcoin address should be demanded when sending bitcoin. All good bitcoin wallets have a user interface which discourages address reuse.</p><p>It has been argued that the phrase &ldquo;bitcoin address&rdquo; was a bad name for this object because it implies it can be reused like an email address. A better name would be something like &ldquo;bitcoin invoice&rdquo;.</p><p>Bitcoin isn&rsquo;t anonymous but pseudonymous, and the pseudonyms are bitcoin addresses. Avoiding address reuse is like throwing away a pseudonym after its been used.</p><p>Bitcoin Core 0.17 includes an update to improve the privacy situation with address reuse <sup id=fnref:46><a href=#fn:46 class=footnote-ref role=doc-noteref>46</a></sup>. When an address is paid multiple times the coins from those separate payments can be spent separately which hurts privacy due to linking otherwise separate addresses. A -avoidpartialspends flag has been added (default=false), if enabled the wallet will always spend existing UTXO to the same address together even if it results in higher fees. If someone were to send coins to an address after it was used, those coins will still be included in future coin selections.</p><h3 id=avoiding-forced-address-reuse>Avoiding forced address reuse
<a class=anchor href=#avoiding-forced-address-reuse>#</a></h3><p>The easiest way to avoid the privacy loss from <a href=/en/wiki-bitcoin-privacy/#forced-address-reuse>forced address reuse</a> to not spend coins that have landed on an already-used and empty addresses. Usually the payments are of a very low value so no relevant money is lost by simply not spending the coins.</p><p>Another option is to spend the coins individual directly to miner fees. Here are instructions for how to do this with Electrum or Bitcoin Core: <a href=https://gist.github.com/ncstdc/90fe6209a0b3ae815a6eaa2aef53524c>https://gist.github.com/ncstdc/90fe6209a0b3ae815a6eaa2aef53524c</a></p><p>Dust-b-gone is an old project <sup id=fnref:47><a href=#fn:47 class=footnote-ref role=doc-noteref>47</a></sup> which aimed to safely spend forced-address-reuse payments. It signs all the UTXOs together with other people&rsquo;s and spends them to miner fees. The transactions use rare <a href=https://en.bitcoin.it/wiki/OP_CHECKSIG title="OP CHECKSIG">OP_CHECKSIG</a> sighash flags so they can be easily eliminated from the adversary&rsquo;s analysis, but at least the forced address reuse payments don&rsquo;t lead to further privacy loss.</p><h2 id=coin-control>Coin control
<a class=anchor href=#coin-control>#</a></h2><p>Coin control is a feature of some bitcoin wallets that allow the user to choose which <a href=https://en.bitcoin.it/wiki/Coin_analogy title="Coin analogy">coins</a> are to be spent as inputs in an outgoing transaction. Coin control is aimed to avoid as much as possible transactions where privacy leaks are caused by amounts, change addresses, the transaction graph and the common-input-ownership heuristic <sup id=fnref:48><a href=#fn:48 class=footnote-ref role=doc-noteref>48</a></sup> <sup id=fnref:49><a href=#fn:49 class=footnote-ref role=doc-noteref>49</a></sup>.</p><p>An example for avoiding a transaction graph privacy leak with coin control: A user is paid bitcoin for their employment, but also sometimes buys bitcoin with cash. The user wants to donate some money to a charitable cause they feel passionately about, but doesn&rsquo;t want their employer to know. The charity also has a publicly-visible donation address which can been found by web search engines. If the user paid to the charity without coin control, his wallet may use coins that came from the employer, which would allow the employer to figure out which charity the user donated to. By using coin control, the user can make sure that only coins that were obtained anonymously with cash were sent to the charity. This avoids the employer ever knowing that the user financially supports this charity.</p><h2 id=multiple-transactions>Multiple transactions
<a class=anchor href=#multiple-transactions>#</a></h2><p>Paying someone with more than one on-chain transaction can greatly reduce the power of amount-based privacy attacks such as amount correlation and round numbers. For example, if the user wants to pay 5 BTC to somebody and they don&rsquo;t want the 5 BTC value to be easily searched for, then they can send two transactions for the value of 2 BTC and 3 BTC which together add up to 5 BTC.</p><p>Privacy-conscious merchants and services should provide customers with more than one bitcoin address that can be paid.</p><h2 id=change-avoidance>Change avoidance
<a class=anchor href=#change-avoidance>#</a></h2><p>Change avoidance is where transaction inputs and outputs are carefully chosen to not require a change output at all. Not having a change output is excellent for privacy, as it breaks change detection heuristics.</p><p>Change avoidance is practical for high-volume bitcoin services, which typically have a large number of inputs available to spend and a large number of required outputs for each of their customers that they&rsquo;re sending money to. This kind of change avoidance also lowers miner fees because the transactions uses less block space overall.</p><p>Main article: <a href=https://en.bitcoin.it/wiki/Techniques_to_reduce_transaction_fees#Change_avoidance title="Techniques to reduce transaction fees">Techniques_to_reduce_transaction_fees#Change_avoidance</a></p><p>Another way to avoid creating a change output is in cases where the exact amount isn&rsquo;t important and an entire UTXO or group of UTXOs can be fully-spent. An example is when opening a Lightning Network <a href=https://en.bitcoin.it/wiki/Payment_channel title="Payment channel">payment channel</a>. Another example would be when sweeping funds into a <a href=https://en.bitcoin.it/wiki/Cold_storage title="Cold storage">cold storage</a> wallet where the exact amount may not matter.</p><h2 id=multiple-change-outputs>Multiple change outputs
<a class=anchor href=#multiple-change-outputs>#</a></h2><p>If <a href=/en/wiki-bitcoin-privacy/#change-avoidance>change avoidance</a> is not an option then creating more than one change output can improve privacy. This also breaks change detection heuristics which usually assume there is only a single change output. As this method uses more block space than usual, change avoidance is preferable.</p><h2 id=script-privacy-improvements>Script privacy improvements
<a class=anchor href=#script-privacy-improvements>#</a></h2><p>The <a href=https://en.bitcoin.it/wiki/Script title=Script>script</a> of each bitcoin output leaks privacy-relevant information. For example as of late-2018 around 70% of bitcoin addresses are single-signature and 30% are <a href=https://en.bitcoin.it/wiki/Multisignature title=Multisignature>multisignature</a> <sup id=fnref:50><a href=#fn:50 class=footnote-ref role=doc-noteref>50</a></sup>. Much research has gone into improving the privacy of scripts by finding ways to make several different script kinds look the same. As well as improving privacy, these ideas also improve the scalability of the system by reducing storage and bandwidth requirements.</p><p><strong>ECDSA-2P</strong> is a cryptographic scheme which allows the creation of a 2-of-2 <a href=https://en.bitcoin.it/wiki/Multisignature title=Multisignature>multisignature</a> scheme but which results in a regular single-sig <a href=https://en.bitcoin.it/wiki/Elliptic_Curve_Digital_Signature_Algorithm title="Elliptic Curve Digital Signature Algorithm">ECDSA</a> signature when included on the blockchain <sup id=fnref:51><a href=#fn:51 class=footnote-ref role=doc-noteref>51</a></sup>. It doesn&rsquo;t need any consensus changes because bitcoin already uses <a href=https://en.bitcoin.it/wiki/Elliptic_Curve_Digital_Signature_Algorithm title="Elliptic Curve Digital Signature Algorithm">ECDSA</a>.</p><p><strong><a href=https://en.bitcoin.it/wiki/Schnorr title=Schnorr>Schnorr</a></strong> is a digital signature scheme which has many benefits over the status-quo <a href=https://en.bitcoin.it/wiki/Elliptic_Curve_Digital_Signature_Algorithm title="Elliptic Curve Digital Signature Algorithm">ECDSA</a> <sup id=fnref:52><a href=#fn:52 class=footnote-ref role=doc-noteref>52</a></sup> <sup id=fnref:53><a href=#fn:53 class=footnote-ref role=doc-noteref>53</a></sup>. One side effect is that any N-of-N <sup id=fnref:54><a href=#fn:54 class=footnote-ref role=doc-noteref>54</a></sup> and M-of-N <a href=https://en.bitcoin.it/wiki/Multisignature title=Multisignature>multisignature</a> can be easily made to look like a single-sig when included on the blockchain. Adding <a href=https://en.bitcoin.it/wiki/Schnorr title=Schnorr>Schnorr</a> to bitcoin requires a <a href=https://en.bitcoin.it/wiki/Softfork title=Softfork>Softfork</a> consensus change. As of 2019 a design for the signature scheme has been proposed <sup id=fnref:55><a href=#fn:55 class=footnote-ref role=doc-noteref>55</a></sup>. The required <a href=https://en.bitcoin.it/wiki/Softfork title=Softfork>softfork</a> consensus change is still in the design stage as of early-2019.</p><p><strong>Scriptless scripts</strong> are a set of cryptographic protocols which provide a way of replicating the logic of <a href=https://en.bitcoin.it/wiki/Script title=Script>script</a> without actually having the script conditions visible, which increases privacy and scalability by removing information from the blockchain <sup id=fnref:56><a href=#fn:56 class=footnote-ref role=doc-noteref>56</a></sup> <sup id=fnref:57><a href=#fn:57 class=footnote-ref role=doc-noteref>57</a></sup> <sup id=fnref:58><a href=#fn:58 class=footnote-ref role=doc-noteref>58</a></sup> <sup id=fnref:59><a href=#fn:59 class=footnote-ref role=doc-noteref>59</a></sup>. This is generally aimed at protocols involving <a href=https://en.bitcoin.it/wiki/Hash_Time_Locked_Contracts title="Hash Time Locked Contracts">Hash Time Locked Contracts</a> such as Lightning Network and <a href=https://en.bitcoin.it/wiki/CoinSwap title=CoinSwap>CoinSwap</a>.</p><p>With scriptless scripts, nearly the only thing visible is the public keys and signatures. More than that, in multi-party settings, there will be a single public key and a single signature for all the actors. Everything looks the same&ndash; <a href=https://en.bitcoin.it/wiki/Lightning_Network title="Lightning Network">lightning</a> <a href=https://en.bitcoin.it/wiki/Payment_channels title="Payment channels">payment channels</a> would look the same as single-sig payments, escrows, <a href=https://en.bitcoin.it/wiki/Atomic_swap title="Atomic swap">atomic swaps</a>, or sidechain federation pegs. Pretty much anything you think about that people are doing on bitcoin in 2019, can be made to look essentially the same <sup id=fnref:60><a href=#fn:60 class=footnote-ref role=doc-noteref>60</a></sup>.</p><p><strong>MAST</strong> is short for Merkelized Abstract Syntax Tree, which is a scheme for hiding unexecuted branches of a <a href=https://en.bitcoin.it/wiki/Script title=Script>script</a> contract. It improves privacy and scalability by removing information from the blockchain <sup id=fnref:61><a href=#fn:61 class=footnote-ref role=doc-noteref>61</a></sup> <sup id=fnref:62><a href=#fn:62 class=footnote-ref role=doc-noteref>62</a></sup>.</p><p><strong>Taproot</strong> is a way to combine Schnorr signatures with MAST <sup id=fnref:63><a href=#fn:63 class=footnote-ref role=doc-noteref>63</a></sup>. The Schnorr signature can be used to spend the coin, but also a MAST tree can be revealed only when the user wants to use it. The schnorr signature can be any N-of-N or use any scriptless script contract. The consequence of taproot is a much larger anonymity set for interesting smart contracts, as any contract such as Lightning Network, <a href=https://en.bitcoin.it/wiki/CoinSwap title=CoinSwap>CoinSwap</a>, <a href=https://en.bitcoin.it/wiki/Multisignature title=Multisignature>multisignature</a>, etc would appear indistinguishable from regular single-signature on-chain transaction.</p><p>The taproot scheme is so useful because it is almost always the case that interesting scripts have a logical top level branch which allows satisfaction of the contract with nothing other than a signature by all parties. Other branches would only be used where some participant is failing to cooperate.</p><p><strong>Graftroot</strong> is a smart contract scheme similar to taproot. It allows users to include other possible <a href=https://en.bitcoin.it/wiki/Script title=Script>scripts</a> for spending the coin but with less resources used even than taproot. The tradeoff is that interactivity is required between the participants <sup id=fnref:64><a href=#fn:64 class=footnote-ref role=doc-noteref>64</a></sup> <sup id=fnref:65><a href=#fn:65 class=footnote-ref role=doc-noteref>65</a></sup> <sup id=fnref:66><a href=#fn:66 class=footnote-ref role=doc-noteref>66</a></sup>.</p><p><strong><a href=https://en.bitcoin.it/wiki/NLockTime title=NLockTime>nLockTime</a></strong> is a field in the serialized transaction format. It can be used in certain situations to create a more private <a href=https://en.bitcoin.it/wiki/Timelock title=Timelock>timelock</a> which avoids using <a href=https://en.bitcoin.it/wiki/Script title=Script>script</a> opcodes.</p><h2 id=ecdh-addresses>ECDH addresses
<a class=anchor href=#ecdh-addresses>#</a></h2><p><a href=https://en.bitcoin.it/wiki/ECDH_address title="ECDH address">ECDH addresses</a> can be used to improve privacy by helping avoid address reuse. For example, a user can publish a <a href=https://en.bitcoin.it/wiki/ECDH_address title="ECDH address">ECDH address</a> as a <a href=https://en.bitcoin.it/wiki/Receiving_donations_with_bitcoin title="Receiving donations with bitcoin">donation address</a> which is usable by people who want to donate. An adversary can see the ECDH donation address but won&rsquo;t be able to easily find any transactions spending to and from it.</p><p>However <a href=https://en.bitcoin.it/wiki/ECDH_address title="ECDH address">ECDH addresses</a> do not solve all privacy problems as they are still vulnerable to <a href=https://en.bitcoin.it/wiki/Mystery_shopper_payments title="Mystery shopper payments">mystery shopper payments</a>; an adversary can donate some bitcoins and watch on the blockchain to see where they go afterwards, using heuristics like the common-input-ownership heuristic to obtain more information such as donation volume and final destination of funds.</p><p>ECDH addresses have <a href=https://en.bitcoin.it/wiki/ECDH_address title="ECDH address">some practicality issues</a> and are very closely equivalent to <a href=https://en.bitcoin.it/wiki/Receiving_donations_with_bitcoin#Improving_privacy_by_avoiding_address_re-use title="Receiving donations with bitcoin">running a http website which hands out bitcoin addresses to anybody who wants to donate</a> except without an added step of interactivity. It is therefore unclear whether ECDH are useful outside the use-case of non-interactive donations or a self-contained application which sends money to one destination without any interactivity.</p><h2 id=centralized-mixers>Centralized mixers
<a class=anchor href=#centralized-mixers>#</a></h2><p>This is an old method for breaking the <a href=/en/wiki-bitcoin-privacy/#transaction-graph-heuristic>transaction graph</a>. Also called &ldquo;tumblers&rdquo; or &ldquo;washers&rdquo;. A user would send bitcoins to a <a href=https://en.bitcoin.it/wiki/Bitcoin_mixer title="Bitcoin mixer">mixing service</a> and the service would send different bitcoins back to the user, minus a fee. In theory an adversary observing the blockchain would be unable to link the incoming and outgoing transactions.</p><p>There are several downsides to this. The mixer it must be trusted to keep secret the linkage between the incoming and outgoing transactions. Also the mixer must be trusted not to steal coins. This risk of stealing creates reputation effects; older and more established mixers will have a better reputation and will be able to charge fees far above the marginal cost of mixing coins. Also as there is no way to sell reputation, the ecosystem of mixers will be filled with occasional exit scams.</p><p>There is a better alternative to mixers which has essentially the same privacy and custody risks. A user could deposit and then withdraw coins from any regular bitcoin website that has a hot wallet. As long as the bitcoin service doesn&rsquo;t require any other information from the user, it has the same privacy and custody aspects as a centralized mixer and is also much cheaper. Examples of suitable bitcoin services are bitcoin casinos, bitcoin poker websites, tipping websites, altcoin exchanges or online marketplaces <sup id=fnref:67><a href=#fn:67 class=footnote-ref role=doc-noteref>67</a></sup>.</p><p>The problem of the service having full knowledge of the transactions could be remedied by cascading several services together. A user who wants to avoid tracking by passive observers of the blockchain could first send coins to a bitcoin casino, from them withdraw and send directly to an altcoin exchange, and so on until the user is happy with the privacy gained.</p><p>Main article: <a href=https://en.bitcoin.it/wiki/Bitcoin_mixer title="Bitcoin mixer">Bitcoin mixer</a></p><h2 id=coinjoin>CoinJoin
<a class=anchor href=#coinjoin>#</a></h2><p>CoinJoin is a special kind of bitcoin transaction where multiple people or entities cooperate to create a single transaction involving all their inputs. It has the effect of breaking the common-input-ownership heuristic and it makes use of the <a href=https://en.bitcoin.it/wiki/Coin_analogy#Fungibility title="Coin analogy">inherent fungibility of bitcoin within transactions</a>. The CoinJoin technique has been possible since the very start of bitcoin and cannot be blocked except in the ways that any other bitcoin transactions can be blocked. Just by looking at a transaction it is not possible to tell for sure whether it is a coinjoin. CoinJoins are non-custodial as they can be done without any party involved in a coinjoin being able to steal anybody else&rsquo;s bitcoins <sup id=fnref:68><a href=#fn:68 class=footnote-ref role=doc-noteref>68</a></sup>.</p><h3 id=equal-output-coinjoin-1>Equal-output CoinJoin
<a class=anchor href=#equal-output-coinjoin-1>#</a></h3><p>Say this transaction is a CoinJoin, meaning that the 2 BTC and 3 BTC inputs were actually owned by different entities.</p><pre tabindex=0><code>2 btc --&gt; 3 btc
3 btc     2 btc
</code></pre><p>This transaction breaks the common-input-ownership heuristic, because its inputs are not all owned by the same person but it is still easy to tell where the bitcoins of each input ended up. By looking at the amounts (and assuming that the two entities do not pay each other) it is obvious that the 2 BTC input ends up in the 2 BTC output, and the same for the 3 BTC. To really improve privacy you need CoinJoin transaction that have a more than one equal-sized output:</p><pre tabindex=0><code>2 btc --&gt; 2 btc
3 btc     2 btc
          1 btc
</code></pre><p>In this transaction the two outputs of value 2 BTC cannot be linked to the inputs. They could have come from either input. This is the crux of how CoinJoin can be used to improve privacy, not so much breaking the transaction graph rather fusing it together. Note that the 1 BTC output has not gained much privacy, as it is easy to link it with the 3 BTC input. The privacy gain of these CoinJoins is compounded when the they are repeated several times.</p><p>As of late-2018 CoinJoin is the only decentralized bitcoin privacy method that has been deployed. Examples of (likely) CoinJoin transactions IDs on bitcoin&rsquo;s blockchain are <code>402d3e1df685d1fdf82f36b220079c1bf44db227df2d676625ebcbee3f6cb22a</code> and <code>85378815f6ee170aa8c26694ee2df42b99cff7fa9357f073c1192fff1f540238</code>. Note that these coinjoins involve more than two people, so each individual user involved cannot know the true connection between inputs and outputs (unless they collude).</p><h3 id=payjoin>PayJoin
<a class=anchor href=#payjoin>#</a></h3><p><em>Main article: <a href=https://en.bitcoin.it/wiki/PayJoin title=PayJoin>PayJoin</a></em></p><p>The type of CoinJoin discussed in the previous section can be easily identified as such by checking for the multiple outputs with the same value. It&rsquo;s important to note that such identification is always deniable, because somebody could make fake <a href=https://en.bitcoin.it/wiki/CoinJoin title=CoinJoin>CoinJoins</a> that have the same structure as a coinjoin transaction but are made by a single person.</p><p>PayJoin (also called pay-to-end-point or P2EP) <sup id=fnref:69><a href=#fn:69 class=footnote-ref role=doc-noteref>69</a></sup> <sup id=fnref:70><a href=#fn:70 class=footnote-ref role=doc-noteref>70</a></sup> <sup id=fnref:71><a href=#fn:71 class=footnote-ref role=doc-noteref>71</a></sup> is a special type of CoinJoin between two parties where one party pays the other. The transaction then doesn&rsquo;t have the distinctive multiple outputs with the same value, and so is not obviously visible as an equal-output CoinJoin. Consider this transaction:</p><pre tabindex=0><code>2 btc --&gt; 3 btc
5 btc     4 btc
</code></pre><p>It could be interpreted as a simple transaction paying to somewhere with leftover change (ignore for now the question of which output is payment and which is change). Another way to interpret this transaction is that the 2 BTC input is owned by a merchant and 5 BTC is owned by their customer, and that this transaction involves the customer paying 1 BTC to the merchant. There is no way to tell which of these two interpretations is correct. The result is a coinjoin transaction that breaks the common-input-ownership heuristic and improves privacy, but is also undetectable and indistinguishable from any regular bitcoin transaction.</p><p>If PayJoin transactions became even moderately used then it would make the common-input-ownership heuristic be completely flawed in practice. As they are undetectable we wouldn&rsquo;t even know whether they are being used today. As <a href=https://en.bitcoin.it/wiki/Transaction_surveillance_company title="Transaction surveillance company">transaction surveillance companies</a> mostly depend on that heuristic, as of 2019 there is great excitement about the PayJoin idea <sup id=fnref:72><a href=#fn:72 class=footnote-ref role=doc-noteref>72</a></sup>.</p><h2 id=coinswap>CoinSwap
<a class=anchor href=#coinswap>#</a></h2><p><em>Main article: <a href=https://en.bitcoin.it/wiki/CoinSwap title=CoinSwap>CoinSwap</a></em></p><p><strong>CoinSwap</strong> is a non-custodial privacy technique for bitcoin based on the idea of <a href=https://en.bitcoin.it/wiki/Atomic_swap title="Atomic swap">atomic swaps</a> <sup id=fnref:73><a href=#fn:73 class=footnote-ref role=doc-noteref>73</a></sup>. If Alice and Bob want to do a coinswap; then it can be understood as Alice exchanging her bitcoin for the same amount (minus fees) of Bob&rsquo;s bitcoins, but done with <a href=https://en.bitcoin.it/wiki/Contracts title=Contracts>bitcoin smart contracts</a> to eliminate the possibility of cheating by either side.</p><p><a href=https://en.bitcoin.it/wiki/CoinSwap title=CoinSwap>CoinSwaps</a> break the transaction graph between the sent and received bitcoins. On the block chain it looks like two sets of completely disconnected transactions:</p><pre tabindex=0><code>Alice&#39;s Address ---&gt; escrow address 1 ---&gt; Bob&#39;s Address
Bob&#39;s Address   ---&gt; escrow address 2 ---&gt; Alice&#39;s Address
</code></pre><p>Obviously Alice and Bob generate new addresses each to avoid the privacy loss due to address reuse.</p><p>It is possible to have CoinSwaps that are completely indistinguishable from any other transaction on the blockchain. They could be said to allow bitcoins to teleport undetectably to anywhere else on the blockchain. Non-CoinSwap transactions would benefit because a large-scale analyst of the blockchain like a <a href=https://en.bitcoin.it/wiki/Transaction_surveillance_company title="Transaction surveillance company">transaction surveillance company</a> could never be sure that ordinary transactions are not actually <a href=https://en.bitcoin.it/wiki/CoinSwap title=CoinSwap>CoinSwaps</a>. They also do not require much block space compared to the amount of privacy they provide.</p><p>CoinSwaps require a lot of interaction between the involved parties, which can make this kind of system tricky to design while avoiding denial-of-service attacks. They also have a liveness requirement and non-censorship requirement, meaning that the entities taking part must always be able to freely access the bitcoin network; If the internet was down for days or weeks then half-completed CoinSwaps could end with one side having their money stolen.</p><p>In of February 2022, <strong>MercuryWallet</strong> was the first implementation has been deployed <sup id=fnref:74><a href=#fn:74 class=footnote-ref role=doc-noteref>74</a></sup> <sup id=fnref:75><a href=#fn:75 class=footnote-ref role=doc-noteref>75</a></sup>. In June 2020, the <a href=https://en.wikipedia.org/wiki/Human_Rights_Foundation>Human Rights Foundation</a> (a New York-based nonprofit that promotes and protects human rights globally) granted $50,000 to <a href=https://en.bitcoin.it/wiki/User:Belcher>Chris Belcher</a> (one of the main contributors to this very page) to work on the project <sup id=fnref:76><a href=#fn:76 class=footnote-ref role=doc-noteref>76</a></sup>.</p><h2 id=coinjoinxt>CoinJoinXT
<a class=anchor href=#coinjoinxt>#</a></h2><p>CoinJoinXT is non-custodial privacy technique which is closely related to CoinJoin <sup id=fnref:77><a href=#fn:77 class=footnote-ref role=doc-noteref>77</a></sup>. It allows for any number of entities to between them create a so-called <em>proposed transaction graph</em> (PTG) which is a list of connected transactions. In the PTG the bitcoins belonging to the entities are sent to and fro in all the transactions, but at the end of the PTG they are all returned to their rightful owners. The system is set up so that the process of the PTG being mined is atomic, so either the entire PTG is <a href=https://en.bitcoin.it/wiki/Confirmation title=Confirmation>confirmed</a> on the blockchain or none of it is, this means none of the participating entities can steal from each other.</p><p>The <em>proposed transaction graph</em> has the freedom to be any list of transactions that obfuscate the transaction graph. For best results the PTG would perfectly mimic the natural transaction graph due to normal economic activity in bitcoin, and so an adversary would not know where the PTG started or ended, resulting in a massive privacy gain.</p><p>Like CoinJoin, CoinJoinXT is easy to make DOS-resistant and doesn&rsquo;t require a prohibitive number of interaction steps. Unlike <a href=https://en.bitcoin.it/wiki/CoinSwap title=CoinSwap>CoinSwap</a> there is no liveness or non-censorship requirement so funds are secure even if bitcoin is under temporary censorship. However CoinJoinXT uses a lot of block space compared the privacy gain. And CoinJoinXT requires a malleability fix so all the transactions in the PTG have to be <a href=https://en.bitcoin.it/wiki/Segregated_Witness title="Segregated Witness">segwit</a>-only. As of 2019 only around 40% of transactions are segwit, so an observer of the blockchain could easily eliminate non-PTG transactions by checking whether they are legacy or segwit.</p><h2 id=tumblebit>TumbleBit
<a class=anchor href=#tumblebit>#</a></h2><p><a href=https://en.bitcoin.it/wiki/TumbleBit title=TumbleBit>TumbleBit</a> is privacy technology which is non-custodial and where the coordinating server cannot tell the true linkage between input and output. This is achieved by a cryptographic construct where the server facilitates a private exchange of digital signatures. The protocol is very interesting to any privacy and bitcoin enthusiast.</p><p>From the point of view of an observer of the blockchain, TumbleBit transactions appear as two transactions with many (800 in the author&rsquo;s example) outputs and all transaction outputs must be of the same amount.</p><h2 id=off-chain-transactions>Off-chain transactions
<a class=anchor href=#off-chain-transactions>#</a></h2><p>Off-chain transactions refer to any technology which allows bitcoin transactions on a layer above the blockchain. Bitcoin payments done off-chain are not broadcast to every node in the network and are not mined and stored forever on a public blockchain, this automatically improves privacy because much less information is visible to most adversaries. With <a href=https://en.bitcoin.it/wiki/Off-Chain_Transactions title="Off-Chain Transactions">Off-Chain Transactions</a> there are no public addresses, no address clusters, no public transactions, no transaction amounts or any other privacy-relevant attacks that happen with on-chain transactions.</p><p>Main article: <a href=https://en.bitcoin.it/wiki/Off-Chain_Transactions title="Off-Chain Transactions">Off-Chain Transactions</a></p><p><strong>Lightning Network</strong> is a huge topic in bitcoin privacy so it is <a href=/en/wiki-bitcoin-privacy/#lightning-network>discussed in its own section</a>.</p><h3 id=blinded-bearer-certificates>Blinded bearer certificates
<a class=anchor href=#blinded-bearer-certificates>#</a></h3><p>This is another way of doing <a href=https://en.bitcoin.it/wiki/Off-Chain_Transactions title="Off-Chain Transactions">Off-Chain Transactions</a> which is based on blind signatures. The payments through such a system would be very very private. It has been known about since 1983. But the system is custodial so as the issuing server is a central point of failure which can steal all the money. However the concept may still be useful in certain situations where Lightning is not, for example blinded bearer certificates support payments where the receiver is offline.</p><p>Main article: <a href=https://en.bitcoin.it/wiki/Blinded_bearer_certificates title="Blinded bearer certificates">Blinded bearer certificates</a></p><h3 id=sidechains>Sidechains
<a class=anchor href=#sidechains>#</a></h3><p><a href=https://en.bitcoin.it/wiki/Sidechain title=Sidechain>Sidechains</a> are when another blockchain is created which uses bitcoins as its currency unit. Bitcoins can be moved from the main bitcoin blockchain onto the sidechain which allows them to transact following different consensus rules. Sidechains can have different and better privacy properties than the regular bitcoin blockchain.</p><p>Main article: <a href=https://en.bitcoin.it/wiki/Sidechain title=Sidechain>Sidechain</a></p><h3 id=statechains>StateChains
<a class=anchor href=#statechains>#</a></h3><p><a href=https://en.bitcoin.it/wiki/StateChain title=StateChain>StateChains</a> are a cryptographic structure that consists of a chain of digital signatures transfering ownership of a specific statecoin (a bitcoin UTO) between owners. Similar to a blockchain or sidechain, the statechain acts as immutable cryptographic proof of ownership and a proof that a statecoin(bitcoin UTXO) has not been double spent.</p><h2 id=confidential-transactions>Confidential transactions
<a class=anchor href=#confidential-transactions>#</a></h2><p><em>Main article: <a href=https://en.bitcoin.it/wiki/Confidential_transactions title="Confidential transactions">Confidential transactions</a></em></p><p><a href=https://en.bitcoin.it/wiki/Confidential_transactions title="Confidential transactions">Confidential transactions</a> (CT) is a cryptographic protocol which results in the amount value of a transaction being encrypted. The encryption is special because it is still possible to verify that no bitcoins can been created or destroyed within a transaction but without revealing the exact transaction amounts. Confidential transactions requires a <a href=https://en.bitcoin.it/wiki/Softfork title=Softfork>softfork</a> consensus change to be added to bitcoin, although they could be added to a <a href=https://en.bitcoin.it/wiki/Sidechain title=Sidechain>sidechain</a> too.</p><h2 id=discussion>Discussion
<a class=anchor href=#discussion>#</a></h2><h3 id=privacy-vs-scalability>Privacy vs scalability
<a class=anchor href=#privacy-vs-scalability>#</a></h3><p>Many of the previously-mentioned privacy technologies work by adding extra data to the bitcoin blockchain which is used to hide privacy-relevant information. This has the side-effect of degrading the scalability of bitcoin by adding more data which must be handled by system. This harms privacy because full nodes become more resource-costly to run and they are the most private way for a user to learn their history and balance. Adding data to blocks also <a href=https://en.bitcoin.it/wiki/Full_node#Economic_strength title="Full node">degrades the security of the system</a>, and there isn&rsquo;t much point in having a private bitcoin if the poor security leads to it being successfully attacked and destroyed. The resource cost of using more block space is shown to the user as a higher <a href=https://en.bitcoin.it/wiki/Miner_fees title="Miner fees">miner fee</a>; so privacy technology which uses too much block space may not even be used much if users find the fees too expensive. During the <a href=https://en.bitcoin.it/wiki/Miner_fees#The_market_for_block_space title="Miner fees">period of high block space demand</a> in late-2017, low-value <a href=https://en.bitcoin.it/wiki/JoinMarket title=JoinMarket>JoinMarket</a> CoinJoin transactions mostly disappeared (as did most low-valued bitcoin transactions).</p><p><a href=https://en.bitcoin.it/wiki/Off-Chain_Transactions title="Off-Chain Transactions">Off-Chain Transactions</a> are one way to avoid this trade-off between privacy and scalability. These kind of solutions improve privacy by entirely removing data from the blockchain, not by adding more decoy data. <a href=/en/wiki-bitcoin-privacy/#change-avoidance>Change avoidance</a> and <a href=/en/wiki-bitcoin-privacy/#script-privacy-improvements>Script privacy improvements</a> also reduce costs to the system while improving privacy. <a href=https://en.bitcoin.it/wiki/CoinJoinXT title=CoinJoinXT>CoinJoinXT</a>, equal-output CoinJoin, <a href=https://en.bitcoin.it/wiki/TumbleBit title=TumbleBit>TumbleBit</a> use a lot of block space relative to the privacy gain. <a href=https://en.bitcoin.it/wiki/PayJoin title=PayJoin>PayJoin</a> does not use much extra block space over making an ordinary transaction; relative to the gain of breaking the common-input-ownership heuristic it is very space-efficent. <a href=https://en.bitcoin.it/wiki/CoinSwap title=CoinSwap>CoinSwap</a> uses very little block space relative to privacy, as it can be understood as an <a href=https://en.bitcoin.it/wiki/Off-Chain_Transactions title="Off-Chain Transactions">off-chain transaction</a> system which makes a single transaction and then comes back on-chain. <a href=https://en.bitcoin.it/wiki/Confidential_transactions title="Confidential transactions">Confidential transactions</a> requires a lot of block space along with associated bandwidth and CPU costs, but its privacy gain is substantial, so the debate on that topic could go either way.</p><p>In the long term as bitcoin <a href=https://en.bitcoin.it/wiki/Miner_fees title="Miner fees">miner fees</a> go up, resource-costly privacy technologies will be priced out and replaced by resource-efficient ones.</p><h3 id=steganography>Steganography
<a class=anchor href=#steganography>#</a></h3><p>Steganography is used in cryptography to mean the act of hiding the fact that something is being hidden. For example the content of an encrypted message cant be read by an eavesdropper but it still shows that something is being hidden. Steganographic encryption of a message can be done by embedding an encrypted message into an audio file or image which hides the message in the noise.</p><p>An equal-output CoinJoin hides the source and destination of a certain coin, but the structure of the transactions reveals that something is being hidden. So even though coinjoin breaks the common-input-ownership heuristic, the fact that equal-output coinjoins can be detected (even if the detection is imperfect) allows them to be excluded from by the adversary&rsquo;s analysis. Also the distinguishability of the coinjoins may attract suspicion and prompt more investigation.</p><p>The idea of steganography is a good thing to aim for <sup id=fnref:78><a href=#fn:78 class=footnote-ref role=doc-noteref>78</a></sup>. It greatly increases the privacy because the transactions made by such technology cannot be distinguished from regular transactions. Also it improves the privacy of users who don&rsquo;t even use the technology, as their transactions can always be confused with actual private transactions. <a href="https://en.bitcoin.it/w/index.php?title=Scriptless_scripts&amp;action=edit&amp;redlink=1" title="Scriptless scripts (page does not exist)">Scriptless scripts</a> are a great example of a steganographic privacy technology where the privacy-relevant information is hidden in the random numbers of the digital signatures. <a href=https://en.bitcoin.it/wiki/PayJoin title=PayJoin>PayJoin</a>, <a href=https://en.bitcoin.it/wiki/CoinSwap title=CoinSwap>CoinSwap</a> and <a href=https://en.bitcoin.it/wiki/CoinJoinXT title=CoinJoinXT>CoinJoinXT</a> are good steganographic privacy technologies because they can be made indistinguishable from regular bitcoin transactions. Equal-output coinjoins and <a href=https://en.bitcoin.it/wiki/TumbleBit title=TumbleBit>TumbleBit</a> are not steganographic. Also it is usually easy to see when a centralized <a href=https://en.bitcoin.it/wiki/Bitcoin_mixer title="Bitcoin mixer">mixing service</a> is being used with common-input-ownership heuristic analysis, but depositing and then withdrawing from a high-volume bitcoin website like a casino or altcoin exchange is better because its possible that the user simply wanted to gamble.</p><h1 id=lightning-network>Lightning Network
<a class=anchor href=#lightning-network>#</a></h1><p>Lightning Network is an <a href=https://en.bitcoin.it/wiki/Off-Chain_Transactions title="Off-Chain Transactions">off-chain transaction</a> technology based on <a href=https://en.bitcoin.it/wiki/Payment_channels title="Payment channels">payment channels</a>. It has nearly the same security model as bitcoin on-chain transactions. It is not an overstatement to say that Lightning Network is a revolution for bitcoin. See the previous section on <a href=/en/wiki-bitcoin-privacy/#off-chain-transactions>#Off-chain transactions</a>.</p><p>As well as greatly improving privacy, Lightning Network transactions are also much faster (usually instant) and cheaper than on-chain transactions. Lightning nodes create two-way <a href=https://en.bitcoin.it/wiki/Payment_channels title="Payment channels">payment channels</a> between them, and lightning transactions are routed from one node to another. The source and destination node don&rsquo;t need to have a payment channel directly between them as transactions can be routed over many intermediate nodes.</p><p>As Lightning Network transactions happen off-chain, they are not broadcast to every node in the network and are not stored forever in a publicly-visible blockchain. Adversaries cannot look at a public permanent record of all transactions because there isn&rsquo;t one. Instead adversaries would possibly have to run intermediate nodes and possibly extract information that way. On-chain privacy attacks like the common-input-ownership heuristic, address reuse, change address detection, input amounts revealing sender wealth or mystery shopper payments fundamentally don&rsquo;t work because there are no addresses or transaction inputs/outputs that work in the same way.</p><p>However Lightning Network may introduce other privacy problems, mostly due to how the network is made up of nodes having <a href=https://en.bitcoin.it/wiki/Payment_channel title="Payment channel">connections</a> between them <sup id=fnref:79><a href=#fn:79 class=footnote-ref role=doc-noteref>79</a></sup>. The parts of this network which can be intermediate routing nodes are usually public, and this network information could be overlaid with information about routed packets such as their amount. Lightning nodes also reveal their IP addresses unless run over Tor, and the payment channels are made up of on-chain transactions which could be analyzed using regular blockchain analysis techniques. Payment channels look like 2-of-2 <a href=https://en.bitcoin.it/wiki/Multisignature title=Multisignature>multisignature</a> on the blockchain. Bilaterial closing transactions look like the 2-of-2 outputs have been spent, but unilateral close transactions have a complicated <a href=https://en.bitcoin.it/wiki/Hash_Time_Locked_Contracts title="Hash Time Locked Contracts">HTLC</a> <a href=https://en.bitcoin.it/wiki/Script title=Script>scripts</a> that is visible on the blockchain.</p><p>As of 2019 Lightning is in beta and development continues; the development community is still studying all its privacy properties. Certainly its privacy is better than the privacy of on-chain transactions.</p><h2 id=onion-routing>Onion routing
<a class=anchor href=#onion-routing>#</a></h2><p>The Lightning protocol uses onion routing <sup id=fnref:80><a href=#fn:80 class=footnote-ref role=doc-noteref>80</a></sup> <sup id=fnref:81><a href=#fn:81 class=footnote-ref role=doc-noteref>81</a></sup> to improve privacy from the intermediate routing notes. The protocol is aimed to prevent intermediate nodes along a payment route learning which other nodes, besides their predecessor or successor, are part of the packet&rsquo;s route; it also aims to hide the length of the route and the node&rsquo;s position within it.</p><h3 id=onion-routing-overlaid-with-network-topology>Onion routing overlaid with network topology
<a class=anchor href=#onion-routing-overlaid-with-network-topology>#</a></h3><p>Lightning Network&rsquo;s onion routing is usually compared with Tor onion routing. However, Tor&rsquo;s network is fully-connected; every node on Tor is directly connected (or has the potential to directly connect) with every other node, meaning that an onion-routed packet can be relayed from and to potentially any other node. This is not so in the Lightning Network, where <a href=https://en.bitcoin.it/wiki/Payment_channels title="Payment channels">payment channels</a> do not fully-connect the entire network, and where the network topology is publicly known for routing nodes. Data fusion of the network topology and the small amount of information from onion-routed packets may still be enough to uncover information in certain cirumstances <sup id=fnref:82><a href=#fn:82 class=footnote-ref role=doc-noteref>82</a></sup> <sup id=fnref:83><a href=#fn:83 class=footnote-ref role=doc-noteref>83</a></sup>. For example, if a Lightning node wallet has only a single payment channel connection going to one intermediate node, then any payments sent to and from the node wallet will have to pass through the intermediate node, which would be able to obtain a lot of information about the wallet node&rsquo;s payments regardless of the onion-routing used.</p><p>A mitigation to this topology problem may be that the entire topology of the Lightning Network is not known. Only nodes which intend to route transactions need to be publicly announced. It is possible for &ldquo;private channels&rdquo; to exist which are payment channels that exist, but whose existence is not published.</p><p>This doesn&rsquo;t mean the onion routing used by Lightning Network is useless, far from it, but the privacy is not as strong as with Tor.</p><h3 id=rendez-vous-routing>Rendez-vous routing
<a class=anchor href=#rendez-vous-routing>#</a></h3><p>Onion routing from the sender still requires that the destination Lightning node is known to the sender (along with all associated information like channel UTXO). This would mean that a user cannot receive Lightning payments without revealing one or more UTXOs associated with their payment channels. A solution is rendez-vous routing <sup id=fnref:84><a href=#fn:84 class=footnote-ref role=doc-noteref>84</a></sup> <sup id=fnref:85><a href=#fn:85 class=footnote-ref role=doc-noteref>85</a></sup>, also called Hidden Destinations <sup id=fnref:86><a href=#fn:86 class=footnote-ref role=doc-noteref>86</a></sup>, which allow Lightning payments to be sent from a source node to destination node without either the source or destination needing to reveal their nodes and associated information.</p><p>A good analogy is that source onion routing is like a Tor connection going via a Tor exit node to its destination, and rendez-vous onion routing is like a Tor connection going to a Tor hidden service.</p><h2 id=atomic-multipath-payments>Atomic Multipath Payments
<a class=anchor href=#atomic-multipath-payments>#</a></h2><p>Atomic Multipath Payments (AMP) is a protocol in Lightning which allows a single payment to be routed over multiple lightning network transactions <sup id=fnref:87><a href=#fn:87 class=footnote-ref role=doc-noteref>87</a></sup>. For example if a user has five channels each with balance 2 btc, they can send a single payment of 7 btc using the AMP protocol over multiple lightning network paths. In terms of privacy, AMP would result in intermediate nodes not observing the full payment amount of 7 btc but only the partial payment amounts of 2 btc or 1 btc (or any other combination). This is positive for privacy as routed payments would no longer leak the exact payment amount, but only a lower bound.</p><h2 id=common-hashlock-value>Common hashlock value
<a class=anchor href=#common-hashlock-value>#</a></h2><p>For non-AMP payments, the payment hash is the same for all nodes along the route of a payment. This could allow multiple nodes if they co-operate to know that they routed the same payment based on this common hash value. Although this could also be done using the timestamp of each routed payment.</p><p><a href="https://en.bitcoin.it/w/index.php?title=Scriptless_scripts&amp;action=edit&amp;redlink=1" title="Scriptless scripts (page does not exist)">Scriptless scripts</a> used as a replacement to explicit <a href=https://en.bitcoin.it/wiki/Hash_Time_Locked_Contracts title="Hash Time Locked Contracts">hash time locked contracts</a> can be used to solve the common hashlock problem. It is possible to add a different random tweak value to the committed random value at each step, as a result there can be a multi-hop path through payment channels in which individual participants in the path wouldn&rsquo;t be able to tell that they&rsquo;re in the same path unless they&rsquo;re directly connected because of this re-blinding <sup id=fnref:88><a href=#fn:88 class=footnote-ref role=doc-noteref>88</a></sup> <sup id=fnref:89><a href=#fn:89 class=footnote-ref role=doc-noteref>89</a></sup>.</p><p>A 2017 paper called Concurrency and Privacy with Payment-Channel Networks <sup id=fnref:90><a href=#fn:90 class=footnote-ref role=doc-noteref>90</a></sup> <sup id=fnref:91><a href=#fn:91 class=footnote-ref role=doc-noteref>91</a></sup> writes about a scheme using zero-knowledge proofs which would allow each hash value in the payment route to be different. The scheme is much more expensive in terms of computation, but it may still be practical.</p><h2 id=custodial-wallets-1>Custodial wallets
<a class=anchor href=#custodial-wallets-1>#</a></h2><p>Lightning-enabled wallets can be of the custodial type, where the wallet is just a front-end that connects to a back-end server run by some company. This is the same situation for web wallets in the on-chain bitcoin ecosystem.</p><p>This kind of setup would result in all the user&rsquo;s Lightning Network transactions being visible to that company and so they would have no privacy, in the same way that using a web wallet has no privacy for the on-chain bitcoin space. As of 2019 Zap Wallet and Lightning Peach work on this model. Peach wallet actually has checkboxes in its GUI saying &ldquo;I agree to the privacy policy&rdquo; and looking through the privacy policy reveals the wallet tracks all kinds of privacy-relevant stuff. Needless to say a privacy-conscious user shouldn&rsquo;t use these kind of lightning wallets but use non-custodial lightning wallets instead <sup id=fnref:92><a href=#fn:92 class=footnote-ref role=doc-noteref>92</a></sup>.</p><p>Lightning-enabled wallets still need to interface with the underlying bitcoin network, which can leak privacy-relevant information if done incorrectly. For example, if the wallet obtains blockchain transaction information from a centralized server then that server can spy on all the channel opening and closing transaction. Privacy-aware lightweight wallets usually make use of <a href=https://en.bitcoin.it/wiki/Client-side_block_filtering title="Client-side block filtering">Client-side block filtering</a> which is a very good fit for Lightning Network-enabled wallets.</p><h2 id=private-script-types>Private script types
<a class=anchor href=#private-script-types>#</a></h2><p>Advances in script type privacy like <a href=https://en.bitcoin.it/wiki/Schnorr title=Schnorr>Schnorr</a>, scriptless scripts, taproot and ECDSA-2P benefit Lightning Network privacy by making its <a href=https://en.bitcoin.it/wiki/Payment_channel title="Payment channel">payment channel</a> blockchain transactions appear indistinguishable from regular single-signature blockchain transactions.</p><h2 id=probing-payments-to-reveal-channel-states>Probing payments to reveal channel states
<a class=anchor href=#probing-payments-to-reveal-channel-states>#</a></h2><p>The balance state of each channel is hidden from the public and is only known to the two entities making up the <a href=https://en.bitcoin.it/wiki/Payment_channel title="Payment channel">payment channel</a>. This provides a lot of privacy, as amounts and changes of the amounts are not visible to all. A possible way to defeat this privacy is for an active adversary to send probing payments until the balance is obtained. Such attack has been proved possible, as described in a paper from the beginning of 2019 <sup id=fnref:93><a href=#fn:93 class=footnote-ref role=doc-noteref>93</a></sup>, due to the level of detail that lightning implementations provide about routing errors. Although it would seem that such attack would need to pay the routing fees for the probing payments, the attacker may provide a fake invoice, so even when the payment passes through all the route, the last node will send back an error message and will not be able to execute the payment. So the cost for such attack is reduced to the fees needed to open and close the channels used for the attack.</p><p>Such an attack can be used for disclosing the balances of a single or a selected group of nodes of the network and even on a large scale to obtain the balance of each channel in the network. In case the adversary repeats this procedure for every <a href=https://en.bitcoin.it/wiki/Payment_channel title="Payment channel">payment channel</a> in the entire Lightning Network and continues probing very frequently, then by watching the change in channel states, they could observe payment being routed around the network. A possible way to remedy this attack would be for routing nodes to randomly (for example 1-out-of-20 times) return a routing error even if the channel balance state is actually adequate. This likely would not degrade the user experience of Lightning Network much, but would impose a serious cost on the attacker.</p><h1 id=existing-privacy-solutions>Existing privacy solutions
<a class=anchor href=#existing-privacy-solutions>#</a></h1><p>This section is about bitcoin software which implements privacy features as its main goal, especially avoiding the privacy leaks due to the blockchain.</p><p>Privacy cannot be easily separated from any other aspect of bitcoin. It is unusual to have entirely separate solutions only for privacy, the dream is that one day all bitcoin wallets will include privacy tech already built in. But as of late-2018 many privacy implementations are separate applications.</p><h2 id=lightning-network-1>Lightning Network
<a class=anchor href=#lightning-network-1>#</a></h2><p>There are several implementations of Lightning Network as of early-2019; such as <a href="https://en.bitcoin.it/w/index.php?title=LND&amp;action=edit&amp;redlink=1" title="LND (page does not exist)">LND</a>, <a href="https://en.bitcoin.it/w/index.php?title=C-lightning&amp;action=edit&amp;redlink=1" title="C-lightning (page does not exist)">c-lightning</a>, <a href="https://en.bitcoin.it/w/index.php?title=Eclair&amp;action=edit&amp;redlink=1" title="Eclair (page does not exist)">eclair</a>, etc.</p><p>The network itself can be used on bitcoin mainnet and several merchants and other projects accept it. It is still not usable by the general public. It is expected that one day every bitcoin wallet will be able to send and receive lightning network transactions and so the massive privacy benefits will be included in how regular users use bitcoin all the time.</p><p>Lightning Network wallets usually the standard privacy tech like <a href=https://en.bitcoin.it/wiki/Deterministic_wallet title="Deterministic wallet">Deterministic wallets</a> and warnings against address reuse.</p><p>Some LN wallets such as Zap Wallet and Lightning Peach are actually custodial, they are backed by a centralized server which can spy on everything the user does, so they should be avoided.</p><h2 id=handmade-coinjoin>Handmade CoinJoin
<a class=anchor href=#handmade-coinjoin>#</a></h2><p>CoinJoin transactions can be hand-made without a special wallet just using <a href=https://en.bitcoin.it/wiki/Raw_Transactions title="Raw Transactions">Raw Transactions</a>. This can be very flexible as the coinjoins can take any number of forms. It might be practical in between bitcoin merchants, several of whom might decide to coinjoin together some of their transactions so that the common-input-ownership heuristic would imply they are all the same wallet cluster.</p><h2 id=joinmarket>JoinMarket
<a class=anchor href=#joinmarket>#</a></h2><p><a href=https://en.bitcoin.it/wiki/JoinMarket title=JoinMarket>JoinMarket</a> is an implementation of CoinJoin where the required liquidity is paid for in a market. In JoinMarket terminology there are <em>liquidity taker</em> users who can create a coinjoin for whatever amount they want at any time, they also pay a small coinjoin fee. <em>Liquidity makers</em> are online 24 hours a day and are ready to create a coinjoin at any time for any amount they can, in return they earn coinjoin fees from liquidity takers. Because of this market for coinjoins, JoinMarket users can create coinjoins at any time and for any amount (up to a limit based on available liquidity).</p><p>Other people are always available for coinjoining because they earn fees, and coinjoins can be of any amount and happen at any time. <a href=https://en.bitcoin.it/wiki/JoinMarket title=JoinMarket>JoinMarket</a> can also be a small source of income for operators of liquidity maker bots, who earn coinjoin fees by allowing other people to create coinjoins with their bitcoins.</p><p>Privacy is greatly improved by repeating coinjoins many times, for this reason the <a href=https://en.bitcoin.it/wiki/JoinMarket title=JoinMarket>JoinMarket</a> project includes the tumbler script where coinjoins are automatically created at random times and for random amounts. Bitcoins can be deposited into the JoinMarket <a href=https://en.bitcoin.it/wiki/Deterministic_wallet title="Deterministic wallet">HD wallet</a> and the tumbler script will send them via many coinjoins to three or more destination addresses. This feature of using more than one destination address is required to beat amount correlation. For example a user who wants to deposit coins into an exchange would make use of the <em>Generate New Deposit Address</em> button to obtain more than one destination address, the exchange may then combine those coins with deposits from other customers which should resist any tracking based on amounts.</p><p>JoinMarket can interface with a Bitcoin Core full node in order to privately obtain the history of its own wallet. There is also an option to use Electrum server, but users are discouraged from using it. There are plans to replace the Electrum interface with one that uses <a href=https://en.bitcoin.it/wiki/Client-side_block_filtering title="Client-side block filtering">Client-side block filtering</a>.</p><p>The software is an open source project with a community based around it. Unfortunately JoinMarket can be difficult to install for people not used to Linux or the command line interface. It is hoped one day there may be work done to make this easier, but as all development is done by volunteers there can be no roadmap for this.</p><p>Main article: <a href=https://en.bitcoin.it/wiki/JoinMarket title=JoinMarket>JoinMarket</a></p><h2 id=wasabi-wallet>Wasabi Wallet
<a class=anchor href=#wasabi-wallet>#</a></h2><p><strong>Wasabi Wallet</strong> is an open-source, non-custodial, <strong>privacy-focused</strong> Bitcoin wallet for Desktop, that implements trustless <strong>CoinJoin</strong>. The CoinJoin coordinator (run by zkSNACKs Ltd., the company that is sponsoring the development of Wasabi) cannot steal from, nor breach the privacy of the participants.</p><p>The package includes built-in Tor and, by default, all traffic between the clients and the server goes through it, so IP addresses are hidden and privacy of the users is respected. Under normal conditions, Wasabi Wallet never leaves Tor onion network and it never uses Tor exit relays, significantly decreasing the network attack surface.</p><p>Wasabi also includes all standard privacy tech like a Hierarchical <a href=https://en.bitcoin.it/wiki/Deterministic_wallet title="Deterministic wallet">Deterministic wallet</a> and address reuse avoidance, as well as mandatory coin control and labeling. The wallet uses BIP-158 <a href=https://en.bitcoin.it/wiki/Client-side_block_filtering title="Client-side block filtering">Client-side block filtering</a> to obtain its own transaction history in a private way and it has a one-click partial full node integration as it ships with Bitcoin Knots. If the user already has a Bitcoin full node on a local or remote device, then it is possible to specify the IP address and port, or the Tor onion service, and Wasabi will use it to verify and enforce rules of Bitcoin.</p><p>In addition to this, it has advanced cutting-edges features like:</p><ul><li>Opt-in <a href=https://en.bitcoin.it/wiki/PayJoin title=PayJoin>PayJoin</a></li><li>Dust attack protections</li><li>Custom change address</li><li>Anti wallet fingerprinting</li></ul><p>Wasabi also has a <a href=https://docs.wasabiwallet.io/>complete and detailed documentation</a> containing explanations on the architecture of the program, on its functioning and tutorials on how to use it.</p><p>Main article: <a href=https://en.bitcoin.it/wiki/Wasabi_Wallet title="Wasabi Wallet">Wasabi Wallet</a></p><h2 id=samourai-wallet>Samourai Wallet
<a class=anchor href=#samourai-wallet>#</a></h2><p>Samourai Wallet is a smartphone wallet which implements some privacy features. Stowaway is an implementation of <a href=https://en.bitcoin.it/wiki/PayJoin title=PayJoin>PayJoin</a>. Stonewall is a scheme which creates transactions that look like <a href=https://en.bitcoin.it/wiki/CoinJoin title=CoinJoin>CoinJoins</a> but actually involve only one person; these fake coinjoins are intended to create false positives in algorithms used by a hypothetical <a href=https://en.bitcoin.it/wiki/Transaction_surveillance_company title="Transaction surveillance company">transaction surveillance company</a>. StonewallX2 is a scheme that creates transactions that are identical to Stonewall but involve two participants, making it an actual CoinJoin transaction. PayNyms are an implementation of <a href=https://en.bitcoin.it/wiki/ECDH_address title="ECDH address">ECDH addresses</a>. The wallet also has a feature called like-type change outputs where it generates a change address which is of the same type as the payment address; this avoids <a href=/en/wiki-bitcoin-privacy/#wallet-fingerprinting>wallet fingerprinting</a> using address types which leads to change address detection.</p><p>By default, Samourai Wallet obtains information about the user&rsquo;s history and balance by querying their own server. This server knows all the user&rsquo;s addresses and transactions, and can spy on them. Therefore using the default configuration of Samourai Wallet is only useful in a threat model where the adversary can analyze the blockchain but cannot access this server. In June 2019 with the release and open sourcing of the Samourai Wallet server, Dojo, users may now host their own server privately and direct their Samourai Wallet to connect to it.</p><h2 id=liquid-sidechain>Liquid sidechain
<a class=anchor href=#liquid-sidechain>#</a></h2><p>As of 2018 the Liquid <a href=https://en.bitcoin.it/wiki/Sidechain title=Sidechain>sidechain</a> implements Confidential Transaction (CT) which allows bitcoins to be transferred on that sidechain while keeping the transaction amounts hidden. The product is developed by the Blockstream company and is aimed at exchanges and traders. It allows fast transfer of bitcoin in a very private way.</p><p>As Liquid is a federated sidechain, users generally need to pass AML checks and give up their personal data in order to use it. Its security model is quite close to having bitcoins on an exchange, because if enough of the functionaries get hacked then all the bitcoins on the sidechain could be stolen. However within that security model you get excellent privacy, and the <a href=https://en.bitcoin.it/wiki/Sidechain title=Sidechain>sidechain</a> itself is marketed towards traders and hedgers who certainly want to keep their trading activities private to stop other traders front-running them.</p><h2 id=mercury-wallet>Mercury Wallet
<a class=anchor href=#mercury-wallet>#</a></h2><p><strong>Mercury</strong> is a new Bitcoin layer-2 scaling technology, based on the concept of statechains, that enables private keys for BTC deposits (UTXOs) to be transfered securely between owners without requiring an on-chain transaction.</p><p>This enables users to transfer full custody of an amount of BTC to anyone almost instantly, with increased privacy, and without having to pay miner fees. Mercury also supports the first production <strong><a href=https://en.bitcoin.it/wiki/CoinSwap title=CoinSwap>CoinSwap</a></strong> implementation.</p><p>Main article: <a href=https://en.bitcoin.it/wiki/MercuryWallet title=MercuryWallet>MercuryWallet</a></p><h1 id=examples-and-case-studies>Examples and case studies
<a class=anchor href=#examples-and-case-studies>#</a></h1><p>Privacy is a very multifaceted and practical topic, it is helpful to follow examples to better understand how all the concepts are related.</p><h2 id=bad-privacy-example---exchange-front-running>Bad privacy example - Exchange front running
<a class=anchor href=#bad-privacy-example---exchange-front-running>#</a></h2><ol><li>You are a trader and have an account on a bitcoin <a href=https://en.bitcoin.it/wiki/Exchange title=Exchange>exchange</a>.</li><li>You want to deposit some bitcoins to sell.</li><li>You send bitcoins to the same exchange deposit address you have used in the past.</li><li>Because of the address reuse, its easy to see on the blockchain that some bitcoins are being sent to the exchange.</li><li>The exchange requires 3 confirmations before crediting your account, but in that time the price has already moved against you as other traders become aware of your deposit transaction.</li><li>You sell the bitcoins for a less attractive price than you otherwise would have.</li><li>This is easily avoided by clicking the <strong>Generate New Deposit Address</strong> button on the exchange&rsquo;s website and depositing there.</li></ol><p>Lesson: <a href=https://en.bitcoin.it/wiki/Address_reuse title="Address reuse">Address reuse</a> is terrible for privacy.</p><h2 id=bad-privacy-example---savings-revealed-with-address-reuse>Bad privacy example - Savings revealed with address reuse
<a class=anchor href=#bad-privacy-example---savings-revealed-with-address-reuse>#</a></h2><ol><li>You save in bitcoin, using a <a href=https://en.bitcoin.it/wiki/Paper_Wallet title="Paper Wallet">single-address paper wallet</a> which results in address reuse.</li><li>All your bitcoin savings to this same address, let&rsquo;s say it contains $1 million worth.</li><li>You buy a small amount of bitcoins to add to your savings, depositing in the paper wallet.</li><li>The person who sold you the bitcoins follows their trail on the blockchain and finds your paper wallet containing $1 million.</li><li>He mentions it to someone in a cafe or bar.</li><li>Word gets around. A burglar raids your home and holds you hostage until $1 million in bitcoin is handed over <sup id=fnref:94><a href=#fn:94 class=footnote-ref role=doc-noteref>94</a></sup>.</li></ol><p>Lesson: <a href=https://en.bitcoin.it/wiki/Address_reuse title="Address reuse">Address reuse</a> is terrible for privacy.</p><h2 id=bad-privacy-example---savings-revealed-with-data-collection>Bad privacy example - Savings revealed with data collection
<a class=anchor href=#bad-privacy-example---savings-revealed-with-data-collection>#</a></h2><ol><li>You save in bitcoin. Trading on an exchange which you <a href=/en/wiki-bitcoin-privacy/#revealing-data-when-transacting-bitcoin>reveal all your data to</a>.</li><li>Mostly you buy coins but sometimes you sell. You only ever use this one exchange.</li><li>Regardless of any blockchain privacy technology you use, the exchange still knows all your trades and can find exactly how much bitcoin you hold at any time.</li></ol><h2 id=example---evading-sanctions>Example - Evading sanctions
<a class=anchor href=#example---evading-sanctions>#</a></h2><ol><li>You live in a country that is under international trade sanctions from other countries.</li><li>Because of this you cannot buy the online newspaper you want.</li><li>You navigate to the newspaper website with Tor so that they can&rsquo;t tell your origin country from your IP address.</li><li>You buy bitcoins with cash and send them to wallet software on your computer, then use the bitcoins to buy the newspaper.</li><li>Bitcoin transactions don&rsquo;t have geographical information about them, so your payment is not discovered as coming from a sanctioned country.</li></ol><h2 id=example---transacting-with-your-online-poker-buddies-without-revealing-your-real-name>Example - Transacting with your online poker buddies without revealing your real name
<a class=anchor href=#example---transacting-with-your-online-poker-buddies-without-revealing-your-real-name>#</a></h2><ol><li>You play online poker with some people (for real money).</li><li>You win big. Lots of money goes to you and your buddies are annoyed.</li><li>The stakes are in bitcoin which you receive. You sell the coins for cash or via an <a href=https://en.bitcoin.it/wiki/Exchange title=Exchange>exchange</a>, or use them to directly buy goods and services.</li><li>Your irritated poker buddies can&rsquo;t find your real name.</li></ol><p>This example has a very mild threat model where the adversary can&rsquo;t access the exchange&rsquo;s AML/KYC records (if you didn&rsquo;t trade with cash), and they are not your ISP so cannot easily link your bitcoin addresses with your IP address (in the case that you used a <a href=https://en.bitcoin.it/wiki/Lightweight_node title="Lightweight node">lightweight node</a> instead of a full node).</p><h2 id=example---donation-without-your-employer-knowing>Example - Donation without your employer knowing
<a class=anchor href=#example---donation-without-your-employer-knowing>#</a></h2><ol><li>You earn money in bitcoin, your employer has sent you bitcoins as salary.</li><li>You want to support X charity or political group with a donation of 0.1 BTC, but don&rsquo;t want your employer knowing.</li><li>Deposit 0.3 BTC into a bitcoin casino, altcoin exchange or another bitcoin service website that allows anonymous bitcoin deposit and withdrawals from the general public.</li><li>Withdraw 0.1 BTC and put the desired donation address as the withdrawal address.</li><li>Withdraw the remaining 0.2 BTC back into your own wallet (to a brand new address, avoiding address reuse).</li></ol><p>If your employer casually analyses the blockchain they will think you are a gambler instead of a supporter of group X. The bitcoin casino doesn&rsquo;t care who you donate to. The employer also can&rsquo;t correlate the amounts, because they see you deposit 0.3 BTC but only 0.1 BTC is sent to the group. Privacy comes from mixing your coins with the coins of everybody else who uses that casino in the time period that your coins were deposited.</p><h2 id=example---donation-without-anyone-knowing>Example - Donation without anyone knowing
<a class=anchor href=#example---donation-without-anyone-knowing>#</a></h2><ol><li>You want to support X charity or political group without anyone knowing.</li><li>Download and install a wallet which is backed by a full node such as Bitcoin Core.</li><li>Buy the exact amount of bitcoin for cash (get slightly more because of transaction fees and volatility), have the coins sent to your wallet.</li><li>Send the coins to the group to donation. The transaction should be broadcasted over Tor.</li></ol><p>Instead of direct cash trading, the user could have also bought a cash substitute like a gift card and traded it online for bitcoin that wasn&rsquo;t link to their identity.</p><p>The full node is required in this threat model, because otherwise your ISP or another adversary could likely spy on <a href=https://en.bitcoin.it/wiki/Lightweight_node title="Lightweight node">lightweight node</a> communications and discover the user&rsquo;s bitcoin addresses. Broadcasting the transaction over Tor is required to stop your ISP or a <a href=https://en.bitcoin.it/wiki/Transaction_surveillance_company title="Transaction surveillance company">transaction surveillance company</a> from learning that your IP address broadcast the transaction.</p><h2 id=example---receiving-donations-privately>Example - Receiving donations privately
<a class=anchor href=#example---receiving-donations-privately>#</a></h2><ol><li>You have a single donation address for your group or project, anybody can see all donations and their amounts by putting your donation address into a blockchain explorer.</li><li>You want to spend the donations without anyone on the internet knowing.</li><li>The donation address is part of a wallet backed by a full node such as <a href=https://en.bitcoin.it/wiki/Armory title=Armory>Armory</a>.</li><li>Broadcast a transaction over Tor to deposit the donation money into a bitcoin website which allows anonymous deposits and withdrawals.</li><li>Withdraw the money straight into another similar bitcoin service website.</li><li>Take care to use different transactions in order to stop the amounts being correlated.</li><li>Make sure to wait a little while to stop the timings being used to link together transactions</li><li>Repeat this for many different bitcoin websites <sup id=fnref:95><a href=#fn:95 class=footnote-ref role=doc-noteref>95</a></sup> before finally sending the coins back to your own wallet.</li></ol><p>Take an example with 1 BTC. Each arrow -> is a new withdrawal transaction.</p><pre tabindex=0><code>Wallet    Casino1           Altcoin Exchange          Casino2            Futures Exchange   Wallet
1btc  -&gt;  1addrA  1btc      -&gt;  1addrB 0.1btc     -&gt;  1addrE 0.1btc  -&gt;  1addrG 0.4btc  -&gt;  1addrH 0.25btc
                            -&gt;  1addrC 0.2btc     -&gt;  1addrF 0.9btc  -&gt;  1addrF 0.6btc  -&gt;  1addrI 0.25btc
                            -&gt;  1addrD 0.7btc                                           -&gt;  1addrJ 0.25btc
                                                                                        -&gt;  1addrK 0.25btc
</code></pre><p>As before the full node wallet allows your wallet to learn its own history privately, while Tor broadcasting hides your IP address used when sending a transaction. Using many different amounts stops <a href=/en/wiki-bitcoin-privacy/#amount-correlation>amount correlation</a> from providing clues that can ruin your privacy. Using multiple bitcoin websites means a single website which co-operates with the adversary won&rsquo;t be enough to completely ruin your privacy. There is custodial risk as each website has the power to steal your money, but in this example the bitcoin amount is relatively low so the risk is acceptable.</p><h2 id=example---storing-savings-privately>Example - Storing savings privately
<a class=anchor href=#example---storing-savings-privately>#</a></h2><ol><li>You want to <a href=https://en.bitcoin.it/wiki/Bitcoin_as_an_investment title="Bitcoin as an investment">store value in bitcoin</a> without anybody else knowing what you do with that value, or even that you own bitcoin.</li><li>Buy the coins in some way and have them sent to your <a href=https://en.bitcoin.it/wiki/JoinMarket title=JoinMarket>JoinMarket</a> wallet which you&rsquo;ve configured to use your own full node, all of which run entirely over Tor.</li><li>Run JoinMarket&rsquo;s tumbler script which has it create many CoinJoin transactions with the aim to break the link between addresses.</li><li>Have the coins sent to another wallet which will be used for <a href=https://en.bitcoin.it/wiki/Storing_bitcoins title="Storing bitcoins">storing the bitcoins</a> long term. The wallet should be backed by a full node such as Electrum pointed to your own <a href=https://en.bitcoin.it/wiki/Electrum#Server_software title=Electrum>Electrum server</a>.</li></ol><p>Note that bitcoin privacy technology like <a href=https://en.bitcoin.it/wiki/JoinMarket title=JoinMarket>JoinMarket</a> can hide private-relevant information from your transactions but it cant add privacy in other places; for example if you buy the bitcoins in a non-anonymous way such as using an AML/KYC exchange then that exchange will know that your real-life identity bought bitcoins at that time.</p><p>Using <a href=https://en.bitcoin.it/wiki/JoinMarket title=JoinMarket>JoinMarket</a> is non-custodial unlike the previous method which sends bitcoin through many bitcoin service websites, so it is useful where the custody risk is unacceptably high (such as where you&rsquo;re anonymizing all your hard-earned savings). All the wallets are backed by full nodes in this example to stop a third-party service being able to link together your addresses or link them with your IP address. The full node is run entirely over Tor to stop your internet service provider or any network-level adversary from seeing that you run a bitcoin node.</p><h2 id=example---stopping-incoming-payments-from-different-sources-from-being-linked-together>Example - Stopping incoming payments from different sources from being linked together
<a class=anchor href=#example---stopping-incoming-payments-from-different-sources-from-being-linked-together>#</a></h2><ol><li>If you had both payments in the same wallet they may be linked together with the common-input-ownership heuristic.</li><li>You have a job as a nurse, you also moonlight as a stripper for extra income. Both jobs pay in bitcoin and you don&rsquo;t want them to be linked together.</li><li>You send the nurse income into one <a href=https://en.bitcoin.it/wiki/JoinMarket title=JoinMarket>JoinMarket</a> mixdepth and the stripper income into another mixdepth.</li><li>You run the JoinMarket tumbler script which will combine both balances without linking them together.</li></ol><p>Another way to do this (but with custodial risk) is to deposit the nurse income into a bitcoin service website (like a casino) and then deposit the stripper income but to a different deposit address. After you withdraw both with be combined with all the other deposits of other users of the casino. Probably the best way to do this is to receive one or both of the income streams over Lightning Network.</p><h2 id=example---withdrawing-casino-winnings-to-a-bitcoin-exchange-without-either-entity-knowing-the-source-or-destination-of-funds>Example - Withdrawing casino winnings to a bitcoin exchange without either entity knowing the source or destination of funds
<a class=anchor href=#example---withdrawing-casino-winnings-to-a-bitcoin-exchange-without-either-entity-knowing-the-source-or-destination-of-funds>#</a></h2><ol><li>You have won 10 BTC at a bitcoin casino, you want withdraw them to a bitcoin exchange to sell without either party knowing (maybe because online gambling is blocked in your jurisdiction).</li><li>Install <a href=https://en.bitcoin.it/wiki/JoinMarket title=JoinMarket>JoinMarket</a> and point it at your own full node.</li><li>Have the casino winnings sent to your JoinMarket wallet in three different payments of 5btc + 2btc + 3btc, they should go to seperate mixdepths.</li><li>Run the JoinMarket tumbler script to mix the coins and have them sent to three different deposit address of the exchange with amounts (for example) 1btc + 2btc + 7btc.</li><li>Then neither the online casino nor the exchange can use amount correlation to figure out the source or destination. The coinjoin transactions stop them using the common-input-ownership heuristic, and the other JoinMarket features stop address reuse and analysis of the transaction graph <sup id=fnref:96><a href=#fn:96 class=footnote-ref role=doc-noteref>96</a></sup>.</li></ol><h2 id=bad-privacy-example---using-a-blockchain-explorer>Bad privacy example - Using a blockchain explorer
<a class=anchor href=#bad-privacy-example---using-a-blockchain-explorer>#</a></h2><ol><li>You receive a payment of bitcoin at one of your addresses.</li><li>You copy and paste the address into a <a href=https://en.bitcoin.it/wiki/Block_chain_browser title="Block chain browser">blockchain explorer website</a> and press <em>Refresh</em> until the incoming transaction reaches 3 confirmations.</li><li>The blockchain explorer website now knows that your IP address is very interested in that particular bitcoin address.</li><li>This is best avoided by using your own bitcoin wallet (backed by a full node) to tell you when payments have arrived and how many confirmations they have, without any other entity knowing.</li></ol><p>This privacy break can be almost entirely fixed by navigating to the blockchain explorer website over Tor. It still reveals that <em>somebody</em> is interested in that bitcoin address but doesn&rsquo;t reveal their IP address, and does not reveal any other bitcoin addresses controlled by the same user.</p><h2 id=bad-privacy-example---privacy-altcoin-mixing-failing-due-to-amount-correlation>Bad privacy example - Privacy altcoin mixing failing due to amount correlation
<a class=anchor href=#bad-privacy-example---privacy-altcoin-mixing-failing-due-to-amount-correlation>#</a></h2><ol><li>You own 1.456225 BTC for which some privacy-relevant information has been leaked (maybe you bought it from a AML/KYC exchange) and want to send it to another address while breaking the link between the two.</li><li>You trade the bitcoins for an altcoin which implements some blockchain privacy technology, a so-called &ldquo;privacy coin&rdquo;, then you trade the altcoin back to bitcoin after making a few altcoin transactions.</li><li>You send the bitcoins back to your wallet in one transaction.</li><li>Because the transaction amount is very close to the initial 1.456225 BTC, its not very hard for an adversary to search the entire blockchain and link the two similar-amount transaction going into and out of the altcoin exchange you used.</li></ol><p>Lesson: Transactions have amounts visible to all which must be treated with care for privacy.</p><h2 id=example---privacy-altcoin-mixing>Example - Privacy altcoin mixing
<a class=anchor href=#example---privacy-altcoin-mixing>#</a></h2><ol><li>Similar to the previous example, you have bitcoins you want to mix. You trade into and out of a privacy altcoin to do it.</li><li>When trading back into bitcoin you deposit the privacy altcoin into an exchange to sell, you use several transactions so that the exchange and any observer of the blockchain cannot easily use amounts to link together the before and after addresses.</li></ol><p>This method may still fail because privacy altcoins have fewer transactions than bitcoin by a factor of a few hundred, so the anonymity set may be lower. Also there are custodial risks with using exchanges so this method may not be appropriate for large amounts of coin. As privacy altcoins are usually much less scalable than bitcoin, their full node wallets may be more resources-costly to run than bitcoin&rsquo;s. Privacy altcoins are likely to have a more volatile price than bitcoin which increases the risk of losing part of the money due to price movements.</p><h2 id=example---daily-commerce-with-lightning-network>Example - Daily commerce with Lightning Network
<a class=anchor href=#example---daily-commerce-with-lightning-network>#</a></h2><ol><li>You have some bitcoin and want to spend it on regular goods and services. (Coffee, phone credit, VPN, hosting, hotel and apartment rentals, flights, food, drinks, clothes, etc etc) and you want to be as private as possible.</li><li>You download and install a Lightning Network wallet and use that for all purchases.</li><li>Privacy attacks like common-input-ownership heuristic, address reuse and change address detection fundamentally don&rsquo;t work on any <a href=https://en.bitcoin.it/wiki/Off-Chain_Transactions title="Off-Chain Transactions">Off-Chain Transactions</a> technology.</li></ol><h2 id=bad-privacy-example---sending-to-a-static-donation-address-without-precautions>Bad privacy example - Sending to a static donation address without precautions
<a class=anchor href=#bad-privacy-example---sending-to-a-static-donation-address-without-precautions>#</a></h2><ol><li>You own bitcoin and keep it in a custodial wallet.</li><li>You want to donate to charity or political group X.</li><li>You create a transaction on the custodial wallet&rsquo;s website sending some money to the group&rsquo;s donation address.</li><li>The custodial wallet server can see where you&rsquo;re sending it (especially easily if the group uses a static donation address).</li><li>They disagree with your views and then they close your account.</li></ol><p>Lesson: Using a custodial wallet is bad for privacy because the custodian can see everything you do. <a href=https://en.bitcoin.it/wiki/Address_reuse title="Address reuse">Address reuse</a> is harmful to privacy (but common with donation addresses).</p><h2 id=bad-privacy-example---receiving-donations-spied-on-with-mystery-shopper-payments>Bad privacy example - Receiving donations spied on with mystery shopper payments
<a class=anchor href=#bad-privacy-example---receiving-donations-spied-on-with-mystery-shopper-payments>#</a></h2><ol><li>You want to accept bitcoin donations but don&rsquo;t want to reveal the total donated amount.</li><li>You set up a web server to give out unique addresses for each visitor.</li><li>An adversary who wants to get an idea of your total donation income donates a small amount of bitcoin to you.</li><li>You combine all donations to use as inputs one transaction, thereby linking them together with the common-input-ownership heuristic.</li><li>The adversary now has a good idea of your total donation income.</li></ol><p>Lesson: <a href=https://en.bitcoin.it/wiki/Mystery_shopper_payments title="Mystery shopper payments">mystery shopper payments</a> can be used to spy on people, even then they avoid address reuse. Be mindful of what is being revealed with the common-input-ownership heuristic.</p><h2 id=real-life-example---bitcoin-stealing-malware-using-static-addresses>Real life example - Bitcoin-stealing malware using static addresses
<a class=anchor href=#real-life-example---bitcoin-stealing-malware-using-static-addresses>#</a></h2><ol><li>You are a creator of stealware (malware that steals money from its victim).</li><li>You hardcode some bitcoin address into your malware where the ill-gottens are sent to.</li><li>Any malware researcher can now see how many bitcoins you have stolen simply by putting the addresses into a blockchain explorer.</li></ol><p>This has been done in many cases including: the Wannacry malware <sup id=fnref:97><a href=#fn:97 class=footnote-ref role=doc-noteref>97</a></sup> <sup id=fnref:98><a href=#fn:98 class=footnote-ref role=doc-noteref>98</a></sup> and Electrum stealware <sup id=fnref:99><a href=#fn:99 class=footnote-ref role=doc-noteref>99</a></sup> <sup id=fnref:100><a href=#fn:100 class=footnote-ref role=doc-noteref>100</a></sup>.</p><h2 id=bad-privacy-example---bitcoin-stealing-malware-spied-on-with-mystery-shopper-payments>Bad privacy example - Bitcoin-stealing malware spied on with mystery shopper payments
<a class=anchor href=#bad-privacy-example---bitcoin-stealing-malware-spied-on-with-mystery-shopper-payments>#</a></h2><ol><li>You are an infosec researcher studying bitcoin-stealing malware.</li><li>The malware author has coded a <a href=https://en.bitcoin.it/wiki/ECDH_address title="ECDH address">ECDH address scheme</a> into their malware.</li><li>Your analysis of the malware only reveals the ECDH public key rather than bitcoin addresses, so the malware author thinks he is private.</li><li>You send a small amount of bitcoin to an address derived from the ECDH public key as a <a href=https://en.bitcoin.it/wiki/Mystery_shopper_payments title="Mystery shopper payments">mystery shopper payment</a>.</li><li>The malware author sends all their received stolen coins to an exchange in one transaction, including your payment.</li><li>You can now look on the blockchain and use the common-input-ownership heuristic to get an idea of total amount of bitcoins stolen by the malware.</li><li>Also you can now contact the exchange who will tell you the real life identity of the malware author, who can now be put in jail.</li></ol><p>Lesson: <a href=https://en.bitcoin.it/wiki/Mystery_shopper_payments title="Mystery shopper payments">mystery shopper payments</a> along with the common-input-ownership heuristic can be used to deanonymize even people who avoid address reuse.</p><h2 id=example---single-use-lightweight-wallet-over-tor>Example - Single-use lightweight wallet over Tor
<a class=anchor href=#example---single-use-lightweight-wallet-over-tor>#</a></h2><ol><li>You want to anonymously buy something or donate to something online.</li><li>You install Electrum wallet and configure it to use Tor, or use <a href=https://tails.boum.org>Tails OS</a>.</li><li>You buy bitcoins anonymously with cash and have them sent to your Electrum wallet.</li><li>You spend the entire balance of bitcoins buying or donating to the thing you want.</li><li>After you&rsquo;re done you delete the wallet and never use it again.</li></ol><p>Your Electrum wallet used a third-party server which can see all your bitcoin addresses and transaction. As you&rsquo;ve connected to it over Tor, the server does not learn your real IP address. As you only use a single bitcoin address once and never again, the server isn&rsquo;t able to cluster together any other addresses. As you spent the entire balance there is no change address which can leak information. This setup actually results in strong privacy even though a third-party server is used.</p><h2 id=bad-privacy-example---lightweight-wallet-over-tor-used-multiple-times>Bad privacy example - Lightweight wallet over Tor used multiple times
<a class=anchor href=#bad-privacy-example---lightweight-wallet-over-tor-used-multiple-times>#</a></h2><p>Very similar to the previous example, but more than one address and transaction is used.</p><ol><li>You want to use bitcoin for more than one use-case, for example buying a novelty hat and paying for a VPN.</li><li>You install Electrum wallet and configure it to use Tor.</li><li>You pay for the novelty hat and have it sent to your mail address.</li><li>You pay for the VPN to improve your web browsing privacy.</li><li>As the Electrum wallet queries a third-party Electrum server, that server can link together the two transactions and knows which address is the change address.</li><li>Therefore the server can easily see that the same person who bought the hat also paid for the VPN. As the hat purchase required revealing your mail address, your mail address can now be linked with the VPN account. So much for anonymous web browsing!</li></ol><p>Lesson: The third-party Electrum server was able to link together your two transactions. Avoid this by <a href=https://en.bitcoin.it/wiki/Electrum#Server_software title=Electrum>running your own Electrum server</a> which is backed by your own full node.</p><p>Lesson 2: Note that <a href=https://tails.boum.org>TailsOS</a> as of 2018 uses this privacy model for Electrum(!)</p><h2 id=real-life-example---public-donation-address-combined-with-the-common-input-ownership-heuristic>Real life example - Public donation address combined with the common-input-ownership heuristic
<a class=anchor href=#real-life-example---public-donation-address-combined-with-the-common-input-ownership-heuristic>#</a></h2><ol><li>Go to a website which accepts bitcoin donations like the <a href=https://tails.boum.org/donate/>Tails OS donation page</a>.</li><li>Take their donation address (in this case <code>1BvBMSEYstWetqTFn5Au4m4GFg7xJaNVN2</code>) and search it in the <a href=https://www.walletexplorer.com>www.walletexplorer.com</a> site.</li><li>The site uses the common-input-ownership heuristic, address reuse and possibly other techniques to cluster together addresses.</li><li>We can see the amount and volume of donations to the Tails OS project: <a href="https://www.walletexplorer.com/wallet/04d3d17f766c4e53?from_address=1BvBMSEYstWetqTFn5Au4m4GFg7xJaNVN2">https://www.walletexplorer.com/wallet/04d3d17f766c4e53?from_address=1BvBMSEYstWetqTFn5Au4m4GFg7xJaNVN2</a> The amounts look realistic so we&rsquo;re probably on the right lines.</li></ol><h2 id=real-life-example---digital-forensics-aids-with-investigation-of-the-mtgox-exchange>Real life example - Digital forensics aids with investigation of the MtGox exchange
<a class=anchor href=#real-life-example---digital-forensics-aids-with-investigation-of-the-mtgox-exchange>#</a></h2><ol><li><a href=https://en.bitcoin.it/wiki/Mt._Gox title="Mt. Gox">Mt. Gox</a> is a now-defunct bitcoin exchange which shut down in 2013 due to insolvency.</li><li>Its internal database was leaked in March 2014, from which it was possible to build up a near-complete picture of the deposits and withdrawals of its wallets.</li><li>Address reuse was also a big factor. The common-input-ownership heuristic was less of a factor because that heuristic was broken by mtgox&rsquo;s import private key feature.</li><li>Analysis information was also cross-checked by searching the web for all forum posts where a customer writes something like: <em>Help! I made a deposit to MtGox of amount 0.12345 BTC. As I write my transaction has 20 confirmations but the deposit hasn&rsquo;t appeared in the exchange.</em> The forum posts include a date and time. These posts include enough information to search for the corresponding blockchain transaction.</li><li>The analysis revealed that there were multiple thefts from mtgox and the exchange was insolvent for most of its existence.</li></ol><p>Full talk: <a href="https://www.youtube.com/watch?v=l70iRcSxqzo">Breaking Bitcoin 2017 conference. Kim Nilsson - Cracking MtGox</a> <a href=https://breaking-bitcoin.com/slides/CrackingMtGox.pdf>Slides</a>.</p><h2 id=real-life-example---flawed-use-of-the-common-input-ownership-heuristic-exaggerates-donation-income>Real life example - Flawed use of the common-input-ownership heuristic exaggerates donation income
<a class=anchor href=#real-life-example---flawed-use-of-the-common-input-ownership-heuristic-exaggerates-donation-income>#</a></h2><ol><li>Go to a website which accepts bitcoin donations like ThePirateBay.</li><li>Take their donation address (in this case <code>1z8Tep4BNS79W3kYH8CHA8tWj6nuHYcCM</code>) and search it in the <a href=https://www.walletexplorer.com>www.walletexplorer.com</a> site.</li><li>The site uses the common-input-ownership heuristic, address reuse and possibly other techniques to cluster together addresses.</li><li>We can see most of the amount and volume of donations to ThePirateBay: <a href="https://www.walletexplorer.com/wallet/00005c945dba011c?from_address=1z8Tep4BNS79W3kYH8CHA8tWj6nuHYcCM">https://www.walletexplorer.com/wallet/00005c945dba011c?from_address=1z8Tep4BNS79W3kYH8CHA8tWj6nuHYcCM</a></li><li>The results indicate that ThePirateBay is making hundreds of millions of dollars in donations per day, which is not believable.</li><li>A possible explanation of what&rsquo;s actually happening is ThePirateBay accepts donations straight into its account at a bitcoin <a href=https://en.bitcoin.it/wiki/Exchange title=Exchange>exchange</a>, which would result that analysis based on the common-input-ownership heuristic gives highly exaggerated figures because it actually finds all deposits to that entire exchange. This has a danger for ThePirateBay that the custodial exchange could block or censor incoming donations.</li><li>Another possibility is that ThePirateBay is using CoinJoin.</li></ol><h2 id=real-life-example---incorrect-clusters-found-by-the-common-input-ownership-heuristic>Real life example - Incorrect clusters found by the common-input-ownership heuristic
<a class=anchor href=#real-life-example---incorrect-clusters-found-by-the-common-input-ownership-heuristic>#</a></h2><ol><li>The <a href=https://www.walletexplorer.com>www.walletexplorer.com</a> website uses the common-input-ownership heuristic, address reuse and possibly other techniques to cluster together addresses.</li><li>It has a big named cluster called <a href=https://www.walletexplorer.com/wallet/MtGoxAndOthers>MtGoxAndOthers</a> which has 8.6 million transactions and 3.6 million addresses associated with it as of January 2019.</li><li>The old <a href=https://en.bitcoin.it/wiki/Mt._Gox title="Mt. Gox">Mt. Gox</a> exchange had a feature where users could import bitcoin private keys from their personal wallet straight into the website <sup id=fnref:101><a href=#fn:101 class=footnote-ref role=doc-noteref>101</a></sup>. There it would be merged with UTXOs from MtGox&rsquo;s own wallet.</li><li>It seems some CoinJoin transactions have also ended up in the cluster <sup id=fnref:102><a href=#fn:102 class=footnote-ref role=doc-noteref>102</a></sup>.</li><li>For example the transaction <code>5ac0210febf7ce07a737bae8c32f84c1c54d131c21a16ca6b02b6f1edcad15c3</code> which is probably a <a href=https://en.bitcoin.it/wiki/JoinMarket title=JoinMarket>JoinMarket</a> transaction belongs to the MtGoxAndOthers cluster <sup id=fnref:103><a href=#fn:103 class=footnote-ref role=doc-noteref>103</a></sup>.</li><li>Another example is the transaction <code>52757ed33a235ce8e48aeaabab7f6dd9cd3445c3642630123103b154ee59f3f5</code> which is a coinjoin created by the old SharedCoin centralized service <sup id=fnref:104><a href=#fn:104 class=footnote-ref role=doc-noteref>104</a></sup>, it is also in the MtGoxAndOthers cluster according to walletexplorer.</li></ol><h2 id=real-life-example---handmade-coinjoin-mislead-a-bitcoin-analyist>Real life example - Handmade coinjoin mislead a bitcoin analyist
<a class=anchor href=#real-life-example---handmade-coinjoin-mislead-a-bitcoin-analyist>#</a></h2><ol><li>The inventor of CoinJoin Greg Maxwell posted a thread on <a href="https://bitcointalk.org/index.php?topic=139581.0">bitcointalk forums called &ldquo;I taint rich!&rdquo;</a> which aimed to demonstrate coinjoin and how the common-input-ownership heuristic is not always correct.</li><li>The thread invited forum readers to create <a href=https://en.bitcoin.it/wiki/CoinJoin title=CoinJoin>CoinJoins</a> by hand with Greg Maxwell&rsquo;s vanity address, which he hopes would be a strong demonstration of the flaws of the common-input-ownership heuristic.</li><li>Many years later, a bitcoin transaction worth 40000 BTC was broadcasted and mined which caused some <a href=https://www.reddit.com/r/Bitcoin/comments/6tvwr5/someone_moved_40000_btc_is_it_from_silkroad/>speculation on bitcoin forums</a>. The handmade coinjoins caused some to come to the wrong conclusion that Greg Maxwell was the owner of the 40000 BTC.</li><li>A quote from the analyst:</li></ol><blockquote><p><em>Originally looks like they were owned by someone with the vanity address of GMaxweLL: 14947302eab0608fb2650a05f13f6f30b27a0a314c41250000f77ed904475dbb</em></p><p><em>If you follow the 40k from that transaction (click the outputs), you get to the transaction you linked to. It&rsquo;s a short series of transactions.</em></p><p><em>Basically, someone who owns that address was able to unlock coins from that address, as well as another address that held the 40,000, in the same transaction. So they must have owned both (at least 4 years ago anyway).</em></p></blockquote><p>Lesson: The common-input-ownership heuristic isn&rsquo;t always right.</p><h2 id=real-life-example---the-quadrigacx-exchange-wallet-analysis>Real life example - The QuadrigaCX exchange wallet analysis
<a class=anchor href=#real-life-example---the-quadrigacx-exchange-wallet-analysis>#</a></h2><ol><li>In early 2019 the exchange QuadrigaCX shut down and many of its customers were left unable to access their bitcoin deposits, likely forever.</li><li>A customer wanted to analyze the blockchain to find information about QuadrigaCX&rsquo;s wallet.</li><li>They asked on internet forums for other customers to reveal their deposit addresses and transactions, many customers did so.</li><li>Using <a href=https://www.walletexplorer.com>www.walletexplorer.com</a> the analyst was able to find a big wallet cluster containing all those addresses, it is likely this is the QuadrigaCX hot wallet. The hot wallet made many transactions, often involve reused addresses and didn&rsquo;t use CoinJoin; so it&rsquo;s likely that this analysis is correct.</li><li>The walletexplorer cluster called MtGoxAndOthers mislead the analyst into believing the QuadrigaCX had something to do with MtGox, when in reality that cluster arises because of CoinJoin.</li><li>The analyst was unable to find a single cluster with a significant amount of bitcoins which could be the <a href=https://en.bitcoin.it/wiki/Cold_storage title="Cold storage">cold storage</a> wallet. However cold storage wallets are likely to create few transactions and never reuse addresses; so its possible such a cluster would never appear on walletexplorer.com which uses the common-input-ownership heuristic. However its also possible that the exchange is insolvent and so there is no <a href=https://en.bitcoin.it/wiki/Cold_storage title="Cold storage">cold storage</a> wallet.</li></ol><p>Main article: <a href=https://blog.zerononcense.com/2019/02/04/quadrigacx-chain-analysis-report-pt-1-bitcoin-wallets/>https://blog.zerononcense.com/2019/02/04/quadrigacx-chain-analysis-report-pt-1-bitcoin-wallets/</a></p><p>Reddit comments: <a href=https://www.reddit.com/r/Bitcoin/comments/amut05/investigation_proves_an_exchange_quadriga_ran_a/>https://www.reddit.com/r/Bitcoin/comments/amut05/investigation_proves_an_exchange_quadriga_ran_a/</a></p><h2 id=real-life-example---stopping-bustabit-casino-customers-getting-banned-from-coinbasecom>Real life example - Stopping Bustabit casino customers getting banned from Coinbase.com
<a class=anchor href=#real-life-example---stopping-bustabit-casino-customers-getting-banned-from-coinbasecom>#</a></h2><ol><li>Coinbase.com is a bitcoin <a href=https://en.bitcoin.it/wiki/Exchange title=Exchange>exchange</a>. Bustabit is an online casino that uses bitcoin.</li><li>In the United States online gambling is illegal (although state government often operates their own lotteries, and meatspace gambling like in Vegas is legal). Coinbase.com enforces this policy by warning and ultimately banning their customers who use online bitcoin casinos.</li><li>Some of Bustabit&rsquo;s customers were being warned and banned by Coinbase.com.</li><li>Bustabit implemented <a href=https://en.bitcoin.it/wiki/Techniques_to_reduce_transaction_fees#Change_avoidance title="Techniques to reduce transaction fees">change avoidance</a> <sup id=fnref:105><a href=#fn:105 class=footnote-ref role=doc-noteref>105</a></sup> so many of their withdrawal transactions did not have a change output.</li><li>Bustabit also imported many thousands of re-used addresses into <a href=https://en.bitcoin.it/wiki/JoinMarket title=JoinMarket>JoinMarket</a> and made them be used as inputs in many CoinJoin transactions.</li><li>No more Bustabit customers were ever warned or banned</li><li>It seems the combination of both methods broke the common-input-ownership heuristic and reduced the privacy-relevant information leaked by change outputs, enough that Coinbase.com&rsquo;s <a href=https://en.bitcoin.it/wiki/Transaction_surveillance_company title="Transaction surveillance company">transaction surveillance company</a> partner was unable to identify Bustabit&rsquo;s wallet addresses anymore.</li></ol><h2 id=real-life-example---rare-multisignature-scripts>Real life example - Rare multisignature scripts
<a class=anchor href=#real-life-example---rare-multisignature-scripts>#</a></h2><ol><li>As of January 2019 <a href=https://en.bitcoin.it/wiki/Multisignature title=Multisignature>multisignature</a> contracts are visible to any observer of the blockchain.</li><li>This includes their m-of-n values, the most common by far are 2-of-3 multisig <sup id=fnref:106><a href=#fn:106 class=footnote-ref role=doc-noteref>106</a></sup>.</li><li>Some very unusual scripts such as 12-of-14 multisignature has been used a handful of times on the blockchain. These are easily visible as someone&rsquo;s wallet who received some money and then spent it.</li><li>The bitcoin vault of the Xapo company used a 3-of-5 multisignature scheme. At one point when they moved it which resulted in 90% of the coins held on 3-of-5 multisig addresses moving on the blockchain. This revealed the amount of bitcoin in Xapo&rsquo;s wallet <sup id=fnref:107><a href=#fn:107 class=footnote-ref role=doc-noteref>107</a></sup>.</li><li>In 2016 the exchange Bitfinex was hacked and part of its wallet was stolen. Bitfinex used 2-of-3 multisignature addresses to store its coins. As the thief moved the hacked coins to regular non-multisignature addresses, the movement of 120,000 bitcoins out of 2-of-3 multisig was visible on the blockchain, and it revealed the size of the theft <sup id=fnref:108><a href=#fn:108 class=footnote-ref role=doc-noteref>108</a></sup>.</li></ol><h2 id=real-life-example---freelance-it-contractor-has-his-co-workers-figure-out-his-salary>Real life example - Freelance IT contractor has his co-workers figure out his salary
<a class=anchor href=#real-life-example---freelance-it-contractor-has-his-co-workers-figure-out-his-salary>#</a></h2><ol><li>A user posted on the bitcoin reddit forum <sup id=fnref:109><a href=#fn:109 class=footnote-ref role=doc-noteref>109</a></sup> about his experience with co-workers figuring out his salary because of address reuse.</li><li><em>&ldquo;As a freelance IT contractor, I had one incident where an on-site specialist found out my daily rate. Surely, he was a bit upset and complained to his manager about the lack of his own compensation. My agency fined me for 50% of the monthly rate. Needless to say, I now create a unique receive address for every invoice, and use another set of addresses for the daily personal-use expenditure.&rdquo;</em></li></ol><p>Lesson: <a href=https://en.bitcoin.it/wiki/Address_reuse title="Address reuse">Address reuse</a> is terrible for privacy.</p><h2 id=real-life-example---hacker-hides-destination-of-445-btc-with-coinjoin>Real life example - Hacker hides destination of 445 btc with CoinJoin
<a class=anchor href=#real-life-example---hacker-hides-destination-of-445-btc-with-coinjoin>#</a></h2><ol><li>In May 2017 a reddit user posted a thread saying they kept 445 btc on blockchain.info&rsquo;s web wallet, and their coins were stolen <sup id=fnref:110><a href=#fn:110 class=footnote-ref role=doc-noteref>110</a></sup>.</li><li>They offered a 50% bounty for any help or information leading to finding their bitcoins again</li><li>The stolen coins turned out to have been mixed through <a href=https://en.bitcoin.it/wiki/JoinMarket title=JoinMarket>JoinMarket</a>. It seems the hacker put the coins in a JoinMarket yield generator script and allowed them to be used for coinjoins a large number of times. A CoinJoin peeling chain can be seen.</li><li>All traces are lost from what anybody has been able to tell.</li></ol><p>For good advice on how to store bitcoins without having them stolen by hackers see the <a href=https://en.bitcoin.it/wiki/Storing_bitcoins title="Storing bitcoins">Storing bitcoins</a> article on this wiki.</p><h2 id=bad-privacy-example---data-fusion-of-blockchain-data-and-web-cookies-when-online-shopping-with-bitcoin>Bad privacy example - Data fusion of blockchain data and web cookies when online shopping with Bitcoin
<a class=anchor href=#bad-privacy-example---data-fusion-of-blockchain-data-and-web-cookies-when-online-shopping-with-bitcoin>#</a></h2><ol><li>Online shopping has several potential privacy leaks. Examples are third-party tracking cookies (such as from sites Doubleclick, Google Analytics or Facebook), or data given intentionally to merchants such as name, delivery address or email address.</li><li>Bitcoin&rsquo;s blockchain leaks a lot of privacy-relevant information.</li><li>Data fusion of these two categories of leaks can reveal a lot of information about people using Bitcoin for online shopping. This is the topic of a 2018 paper called When The Cookie Meets The Blockchain <sup id=fnref:111><a href=#fn:111 class=footnote-ref role=doc-noteref>111</a></sup>.</li><li>For example, if a bitcoin user buys a novelty hat and has it shipped to their home and then later the same bitcoin wallet donates to Wikileaks, then the hat merchant and third-party trackers (who know the user&rsquo;s real name and mail address) can figure out that the same user donated to Wikileaks.</li></ol><p>This is example of the power of data fusion, where two or more privacy leaks which when combined reveal far more information than each individual leak.</p><p>The privacy problems of third-party web tracking cookies have been known for nearly a decade but the situation has not improved much. Privacy can be regained in practice in this situation by 1) Using browser extensions such as uBlock Origin, Adblock Plus or Ghostery to block third-party tracking cookies, and/or 2) Using <a href=https://en.bitcoin.it/wiki/Off-Chain_Transactions title="Off-Chain Transactions">off-chain transaction methods</a> to make payments where much less privacy-relevant information is leaked. Most practically as of 2019 would be using Lightning Network for online shopping.</p><h2 id=bad-privacy-example---centralized-mixers-being-easily-unmixed-with-amount-correlation>Bad privacy example - Centralized mixers being easily unmixed with amount correlation
<a class=anchor href=#bad-privacy-example---centralized-mixers-being-easily-unmixed-with-amount-correlation>#</a></h2><ol><li>BitcoinFog is a centralized bitcoin mixer, it charges 1-3% for a mix.</li><li>Someone on reddit easily unmixes many BitcoinFog mixes using <a href=/en/wiki-bitcoin-privacy/#amount-correlation>Amount correlation</a> <sup id=fnref:112><a href=#fn:112 class=footnote-ref role=doc-noteref>112</a></sup>.</li></ol><h2 id=bad-privacy-example---data-fusion-of-blockchain-data-and-ip-address-transaction-broadcasting-data>Bad privacy example - Data fusion of blockchain data and IP address transaction broadcasting data
<a class=anchor href=#bad-privacy-example---data-fusion-of-blockchain-data-and-ip-address-transaction-broadcasting-data>#</a></h2><ol><li>A 2018 paper <sup id=fnref:113><a href=#fn:113 class=footnote-ref role=doc-noteref>113</a></sup> uses blockchain analysis and the tracking of transaction broadcasts to deanonymize bitcoin users.</li><li>The researchers use address reuse and the common-input-ownership heuristic (the paper authors do not mention the possibility of CoinJoin)</li><li>The researchers connect to every single listening bitcoin node, and attempt to track transactions as they broadcast. This gives them an idea of the originating IP address.</li><li>The paper identifies about 22,000 bitcoin users by linking their IP address and bitcoin addresses. About 20,000 of these users come from one IP address which is probably a popular web wallet.</li><li>The paper collected data during late-2013, but the Bitcoin Core transaction relay algorithm has been changed significantly in the meantime to improve privacy. So the method used should work less well today.</li></ol><p>Lesson: Private transaction broadcasting (for example over Tor) is necessary for privacy.</p><h2 id=real-life-example---2018-paper-on-analysis-of-bitcoin-ransomware-transactions>Real life example - 2018 paper on analysis of bitcoin ransomware transactions
<a class=anchor href=#real-life-example---2018-paper-on-analysis-of-bitcoin-ransomware-transactions>#</a></h2><ol><li>A 2018 paper uses tracking techniques to study bitcoin ransomware <sup id=fnref:114><a href=#fn:114 class=footnote-ref role=doc-noteref>114</a></sup>.</li><li>Some ransomware uses static addresses (which implies address reuse) while other ransomware requires victims to connect to a http server that hands out new bitcoin addresses.</li><li>To find ransomware addresses the researchers found online reports by victims and reverse-engineered ransomware binaries to find addresses within.</li><li>They also used <a href=https://en.bitcoin.it/wiki/Mystery_shopper_payments title="Mystery shopper payments">mystery shopper payments</a>, sending 0.001 BTC to ransomware addresses and watching where that coin is sent to. Two ransomware operators (Cerber and Locky) took the bait but one operator (Sage) did not and so his cluster was never found.</li><li>The researchers use the common-input-ownership heuristic to find clusters of addresses. They know that CoinJoin breaks this assumption and so search for detectable CoinJoin transactions within the clusters which would indicate a break. This was before the invention or implementation of <a href=https://en.bitcoin.it/wiki/PayJoin title=PayJoin>PayJoin</a> so it is assumed that all coinjoins can be detected.</li><li>The researchers try to match incoming payments to the ransomware clusters with spikes in Google searches for that ransomware, and uploads of the ransomware binary to malware-tracking websites. If there are spikes in google searches or binary uploads without a corresponding increase in incoming bitcoin payments, then that indicates that the researchers have missed some clusters belonging to the ransomware wallets. This is <a href=/en/wiki-bitcoin-privacy/#timing-correlation>Timing correlation</a> in use. The researchers conclude they are in fact missing most clusters for CryptoDefense, CryptoLocker, and CryptoWall, but probably have all the clusters for the other ransomware they study.</li><li>A <a href=https://en.bitcoin.it/wiki/Transaction_surveillance_company title="Transaction surveillance company">transaction surveillance company</a> called Chainalysis is used to find the ownership of certain addresses. It works particularly well for exchanges which share their data with Chainalysis. With this the destination of ransomware funds can be tracked. The largest known destination is the BTC-E, a now-shut-down Russian bitcoin exchange with lax controls that was widely known to be used by criminals. However the vast majority of funds is sent to Unknown destinations. One ransomware called CryptoXXX is ~95% sent to Unknown, WannaCry had 100% unknown. The researchers write BTC-E in the paper&rsquo;s abstract and conclusion because that&rsquo;s the biggest destination they could find, but in reality most of the ransomware money could not be tracked</li></ol><p>The paper is an excellent example of transaction tracking. The researchers take great care in their conclusions, as in blockchain analysis it is sometimes easy to trick yourself into thinking you know more than you do. It is worth reading by anyone interested in bitcoin privacy.</p><p>Ransomware is a threat. Always keep good backups of your important data.</p><h1 id=see-also>See also
<a class=anchor href=#see-also>#</a></h1><ul><li><a href=https://en.bitcoin.it/wiki/Common-input-ownership_heuristic title="Common-input-ownership heuristic">Common-input-ownership heuristic</a></li><li><a href=https://en.bitcoin.it/wiki/Address_reuse title="Address reuse">Address reuse</a></li><li><a href=https://en.bitcoin.it/wiki/CoinJoin title=CoinJoin>CoinJoin</a></li><li><a href=https://en.bitcoin.it/wiki/PayJoin title=PayJoin>PayJoin</a></li><li><a href=https://en.bitcoin.it/wiki/Transaction_surveillance_company title="Transaction surveillance company">Transaction surveillance company</a></li><li><a href=https://en.bitcoin.it/wiki/Client-side_block_filtering title="Client-side block filtering">Client-side block filtering</a></li><li><a href=https://en.bitcoin.it/wiki/Full_node#Privacy title="Full node">Full node#Privacy</a></li><li><a href=https://en.bitcoin.it/wiki/Lightning_Network title="Lightning Network">Lightning Network</a></li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Bitcoin Milan Meetup 46 - Talk by Adam Gibson <a href="https://www.youtube.com/watch?v=IKSSWUBqMCM&amp;t=2448">https://www.youtube.com/watch?v=IKSSWUBqMCM&amp;t=2448</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href="https://bitcointalk.org/index.php?topic=334316.msg3588908#msg3588908">https://bitcointalk.org/index.php?topic=334316.msg3588908#msg3588908</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>Neudecker, Till & Hartenstein, Hannes. (2018). Network Layer Aspects of Permissionless Blockchains. IEEE Communications Surveys & Tutorials. PP. 1-1. 10.1109/COMST.2018.2852480.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>Harrigan, Martin & Fretter, Christoph. (2016). The Unreasonable Effectiveness of Address Clustering.&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>Sarah Meiklejohn, Marjori Pomarole, Grant Jordan, Kirill Levchenko, Damon McCoy, Geoffrey M. Voelker, and Stefan Savage. 2013. A fistful of bitcoins: characterizing payments among men with no names. In Proceedings of the 2013 conference on Internet measurement conference (IMC &lsquo;13). ACM, New York, NY, USA, 127-140. DOI: <a href=https://doi.org/10.1145/2504730.2504747>https://doi.org/10.1145/2504730.2504747</a> <a href=https://cseweb.ucsd.edu/~smeiklejohn/files/imc13.pdf>https://cseweb.ucsd.edu/~smeiklejohn/files/imc13.pdf</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p>Bitcoin Privacy: Theory and Practice - Jonas Nick (Blockstream) - Zürich, March 2016 <a href="https://www.youtube.com/watch?v=HScK4pkDNds">https://www.youtube.com/watch?v=HScK4pkDNds</a>&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7><p>Nick, Jonas David. “Data-Driven De-Anonymization in Bitcoin.” (2015).&#160;<a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:8><p><a href=https://github.com/bitcoin/bitcoin/pull/13666>https://github.com/bitcoin/bitcoin/pull/13666</a>&#160;<a href=#fnref:8 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:9><p><a href=https://bitcoinops.org/en/newsletters/2018/08/14/>https://bitcoinops.org/en/newsletters/2018/08/14/</a>&#160;<a href=#fnref:9 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:10><p><a href=https://bitcoin.stackexchange.com/questions/3059/what-is-a-compressed-bitcoin-key>https://bitcoin.stackexchange.com/questions/3059/what-is-a-compressed-bitcoin-key</a>&#160;<a href=#fnref:10 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:11><p>Harrigan, Martin & Fretter, Christoph. (2016). The Unreasonable Effectiveness of Address Clustering.&#160;<a href=#fnref:11 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:12><p>Meiklejohn, Sarah & Orlandi, Claudio. (2015). Privacy-Enhancing Overlays in Bitcoin. 127-141. 10.1007/978-3-662-48051-9_10. <a href=https://fc15.ifca.ai/preproceedings/bitcoin/paper_5.pdf>https://fc15.ifca.ai/preproceedings/bitcoin/paper_5.pdf</a>&#160;<a href=#fnref:12 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:13><p>Gervais A., Ritzdorf H., Lucic M., Lenders V., Capkun S. (2016) Quantifying Location Privacy Leakage from Transaction Prices. In: Askoxylakis I., Ioannidis S., Katsikas S., Meadows C. (eds) Computer Security – ESORICS 2016. ESORICS 2016. Lecture Notes in Computer Science, vol 9879. Springer, Cham <a href=https://eprint.iacr.org/2015/496>https://eprint.iacr.org/2015/496</a>&#160;<a href=#fnref:13 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:14><p><a href=https://medium.com/@octskyward/merge-avoidance-7f95a386692f>https://medium.com/@octskyward/merge-avoidance-7f95a386692f</a>&#160;<a href=#fnref:14 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:15><p><a href=https://bitcointechtalk.com/saving-up-to-80-on-bitcoin-transaction-fees-by-batching-payments-4147ab7009fb>https://bitcointechtalk.com/saving-up-to-80-on-bitcoin-transaction-fees-by-batching-payments-4147ab7009fb</a>&#160;<a href=#fnref:15 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:16><p><a href=https://www.reddit.com/r/Bitcoin/comments/3a1hte/psa_dust_being_sent_to_your_addresses_might_help/>https://www.reddit.com/r/Bitcoin/comments/3a1hte/psa_dust_being_sent_to_your_addresses_might_help/</a>&#160;<a href=#fnref:16 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:17><p><a href=https://www.reddit.com/r/Bitcoin/comments/9r9qud/if_you_have_recently_received_a_very_small_amount/>https://www.reddit.com/r/Bitcoin/comments/9r9qud/if_you_have_recently_received_a_very_small_amount/</a>&#160;<a href=#fnref:17 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:18><p><a href=https://github.com/JoinMarket-Org/joinmarket-clientserver/pull/471#issuecomment-565857814>https://github.com/JoinMarket-Org/joinmarket-clientserver/pull/471#issuecomment-565857814</a>&#160;<a href=#fnref:18 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:19><p><a href=https://www.reddit.com/r/Bitcoin/comments/2yvy6b/a_regulatory_compliance_service_is_sybil/>https://www.reddit.com/r/Bitcoin/comments/2yvy6b/a_regulatory_compliance_service_is_sybil/</a>&#160;<a href=#fnref:19 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:20><p>Alex Biryukov, Dmitry Khovratovich, and Ivan Pustogarov. 2014. Deanonymisation of Clients in Bitcoin P2P Network. In Proceedings of the 2014 ACM SIGSAC Conference on Computer and Communications Security (CCS &lsquo;14). ACM, New York, NY, USA, 15-29. DOI: 10.1145/2660267.2660379 <a href=https://arxiv.org/abs/1405.7418>https://arxiv.org/abs/1405.7418</a>&#160;<a href=#fnref:20 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:21><p>Koshy, Philip & Koshy, Diana & McDaniel, Patrick. (2014). An Analysis of Anonymity in Bitcoin Using P2P Network Traffic. 8437. 469-485. 10.1007/978-3-662-45472-5_30. <a href=http://ifca.ai/fc14/papers/fc14_submission_71.pdf>http://ifca.ai/fc14/papers/fc14_submission_71.pdf</a>&#160;<a href=#fnref:21 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:22><p><a href=https://github.com/bitcoin/bitcoin/issues/3828>https://github.com/bitcoin/bitcoin/issues/3828</a>&#160;<a href=#fnref:22 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:23><p><a href=https://twitter.com/waxwing__/status/983258474040774657>https://twitter.com/waxwing__/status/983258474040774657</a>&#160;<a href=#fnref:23 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:24><p><a href=https://twitter.com/thegrugq/status/1062194678089404421>https://twitter.com/thegrugq/status/1062194678089404421</a>&#160;<a href=#fnref:24 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:25><p><a href=https://motherboard.vice.com/en_us/article/3k9zzk/hacking-team-hacker-phineas-fisher-has-gotten-away-with-it>https://motherboard.vice.com/en_us/article/3k9zzk/hacking-team-hacker-phineas-fisher-has-gotten-away-with-it</a>&#160;<a href=#fnref:25 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:26><p><a href=https://motherboard.vice.com/en_us/article/nzeg5x/here-are-all-the-sketchy-government-agencies-buying-hacking-teams-spy-tech>https://motherboard.vice.com/en_us/article/nzeg5x/here-are-all-the-sketchy-government-agencies-buying-hacking-teams-spy-tech</a>&#160;<a href=#fnref:26 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:27><p><a href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-June/016062.html>https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-June/016062.html</a>&#160;<a href=#fnref:27 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:28><p><a href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2015-July/009510.html>https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2015-July/009510.html</a>&#160;<a href=#fnref:28 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:29><p><a href=https://bitcoin.stackexchange.com/questions/61151/eclipse-attack-vs-sybil-attack>https://bitcoin.stackexchange.com/questions/61151/eclipse-attack-vs-sybil-attack</a>&#160;<a href=#fnref:29 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:30><p><a href=https://github.com/bitcoin/bitcoin/pull/8282>https://github.com/bitcoin/bitcoin/pull/8282</a>&#160;<a href=#fnref:30 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:31><p><a href=https://github.com/bitcoin/bitcoin/pull/5941>https://github.com/bitcoin/bitcoin/pull/5941</a>&#160;<a href=#fnref:31 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:32><p><a href=https://github.com/bitcoin/bitcoin/pull/9037>https://github.com/bitcoin/bitcoin/pull/9037</a>&#160;<a href=#fnref:32 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:33><p><a href=https://github.com/bitcoin/bitcoin/pull/8594>https://github.com/bitcoin/bitcoin/pull/8594</a>&#160;<a href=#fnref:33 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:34><p><a href=https://github.com/bitcoin/bitcoin/pull/12626>https://github.com/bitcoin/bitcoin/pull/12626</a>&#160;<a href=#fnref:34 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:35><p><a href=https://bitcoin.stackexchange.com/questions/83018/transaction-relay-and-trickling-in-bitcoin>https://bitcoin.stackexchange.com/questions/83018/transaction-relay-and-trickling-in-bitcoin</a>&#160;<a href=#fnref:35 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:36><p><a href=https://github.com/bitcoin/bitcoin/issues/13298>https://github.com/bitcoin/bitcoin/issues/13298</a>&#160;<a href=#fnref:36 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:37><p><a href=https://github.com/bitcoin/bitcoin/pull/7125>https://github.com/bitcoin/bitcoin/pull/7125</a>&#160;<a href=#fnref:37 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:38><p><a href=https://github.com/bitcoin/bitcoin/pull/7840>https://github.com/bitcoin/bitcoin/pull/7840</a>&#160;<a href=#fnref:38 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:39><p><a href="https://bitcointalk.org/index.php?topic=7.msg264#msg264">https://bitcointalk.org/index.php?topic=7.msg264#msg264</a>&#160;<a href=#fnref:39 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:40><p><a href=https://github.com/bitcoin/bitcoin/pull/5951>https://github.com/bitcoin/bitcoin/pull/5951</a>&#160;<a href=#fnref:40 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:41><p><a href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2017-June/014571.html>https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2017-June/014571.html</a>&#160;<a href=#fnref:41 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:42><p><a href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2017-September/015030.html>https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2017-September/015030.html</a>&#160;<a href=#fnref:42 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:43><p><a href=https://bitcoinmagazine.com/articles/anatomy-anonymity-how-dandelion-could-make-bitcoin-more-private/>https://bitcoinmagazine.com/articles/anatomy-anonymity-how-dandelion-could-make-bitcoin-more-private/</a>&#160;<a href=#fnref:43 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:44><p><a href="https://www.youtube.com/watch?v=XORDEX-RrAI&amp;t=7h34m35s">https://www.youtube.com/watch?v=XORDEX-RrAI&amp;t=7h34m35s</a>&#160;<a href=#fnref:44 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:45><p><a href=https://blockstream.com/satellite/>https://blockstream.com/satellite/</a>&#160;<a href=#fnref:45 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:46><p><a href=https://github.com/bitcoin/bitcoin/blob/master/doc/release-notes/release-notes-0.17.0.md#partial-spend-avoidance>https://github.com/bitcoin/bitcoin/blob/master/doc/release-notes/release-notes-0.17.0.md#partial-spend-avoidance</a>&#160;<a href=#fnref:46 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:47><p><a href=https://github.com/petertodd/dust-b-gone>https://github.com/petertodd/dust-b-gone</a>&#160;<a href=#fnref:47 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:48><p><a href=https://medium.com/@octskyward/merge-avoidance-7f95a386692f>https://medium.com/@octskyward/merge-avoidance-7f95a386692f</a>&#160;<a href=#fnref:48 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:49><p><a href=https://medium.com/@nopara73/coin-control-is-must-learn-if-you-care-about-your-privacy-in-bitcoin-33b9a5f224a2>https://medium.com/@nopara73/coin-control-is-must-learn-if-you-care-about-your-privacy-in-bitcoin-33b9a5f224a2</a>&#160;<a href=#fnref:49 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:50><p><a href=https://p2sh.info/>https://p2sh.info/</a>&#160;<a href=#fnref:50 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:51><p>Scaling Bitcoin conference 2018 Tokyo. Conner Fromknecht (Lightning Labs) Instantiating [Scriptless] 2P-ECDSA: Fungible 2-of-2 MultiSigs for Today&rsquo;s Bitcoin. <a href="https://www.youtube.com/watch?v=3mJURLD2XS8&amp;t=3623">https://www.youtube.com/watch?v=3mJURLD2XS8&amp;t=3623</a> <a href=https://diyhpl.us/wiki/transcripts/scalingbitcoin/tokyo-2018/scriptless-ecdsa/>https://diyhpl.us/wiki/transcripts/scalingbitcoin/tokyo-2018/scriptless-ecdsa/</a>&#160;<a href=#fnref:51 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:52><p><a href=https://medium.com/cryptoadvance/how-schnorr-signatures-may-improve-bitcoin-91655bcb4744>https://medium.com/cryptoadvance/how-schnorr-signatures-may-improve-bitcoin-91655bcb4744</a>&#160;<a href=#fnref:52 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:53><p><a href=https://bitcoincore.org/en/2017/03/23/schnorr-signature-aggregation/>https://bitcoincore.org/en/2017/03/23/schnorr-signature-aggregation/</a>&#160;<a href=#fnref:53 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:54><p><a href=https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures/>https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures/</a>&#160;<a href=#fnref:54 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:55><p><a href=https://github.com/sipa/bips/blob/bip-schnorr/bip-schnorr.mediawiki>https://github.com/sipa/bips/blob/bip-schnorr/bip-schnorr.mediawiki</a>&#160;<a href=#fnref:55 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:56><p><a href=https://bitcoinmagazine.com/articles/scriptless-scripts-how-bitcoin-can-support-smart-contracts-without-smart-contracts/>https://bitcoinmagazine.com/articles/scriptless-scripts-how-bitcoin-can-support-smart-contracts-without-smart-contracts/</a>&#160;<a href=#fnref:56 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:57><p><a href=https://download.wpsoftware.net/bitcoin/wizardry/mw-slides/2017-03-mit-bitcoin-expo/slides.pdf>https://download.wpsoftware.net/bitcoin/wizardry/mw-slides/2017-03-mit-bitcoin-expo/slides.pdf</a>&#160;<a href=#fnref:57 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:58><p><a href=https://joinmarket.me/blog/blog/flipping-the-scriptless-script-on-schnorr/>https://joinmarket.me/blog/blog/flipping-the-scriptless-script-on-schnorr/</a>&#160;<a href=#fnref:58 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:59><p><a href=https://lists.linuxfoundation.org/pipermail/lightning-dev/2018-April/001221.html>https://lists.linuxfoundation.org/pipermail/lightning-dev/2018-April/001221.html</a>&#160;<a href=#fnref:59 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:60><p><a href=http://diyhpl.us/wiki/transcripts/layer2-summit/2018/scriptless-scripts/>http://diyhpl.us/wiki/transcripts/layer2-summit/2018/scriptless-scripts/</a>&#160;<a href=#fnref:60 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:61><p><a href=https://bitcointechtalk.com/what-is-a-bitcoin-merklized-abstract-syntax-tree-mast-33fdf2da5e2f>https://bitcointechtalk.com/what-is-a-bitcoin-merklized-abstract-syntax-tree-mast-33fdf2da5e2f</a>&#160;<a href=#fnref:61 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:62><p><a href=https://bitcoinmagazine.com/articles/the-next-step-to-improve-bitcoin-s-flexibility-scalability-and-privacy-is-called-mast-1476388597/>https://bitcoinmagazine.com/articles/the-next-step-to-improve-bitcoin-s-flexibility-scalability-and-privacy-is-called-mast-1476388597/</a>&#160;<a href=#fnref:62 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:63><p><a href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-January/015614.html>https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-January/015614.html</a>&#160;<a href=#fnref:63 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:64><p><a href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-February/015700.html>https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-February/015700.html</a>&#160;<a href=#fnref:64 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:65><p><a href=https://www.reddit.com/r/Bitcoin/comments/7vcyip/graftroot_private_and_efficient_surrogate_scripts/>https://www.reddit.com/r/Bitcoin/comments/7vcyip/graftroot_private_and_efficient_surrogate_scripts/</a>&#160;<a href=#fnref:65 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:66><p><a href=https://bitcoinmagazine.com/articles/graftroot-how-delegating-signatures-allows-near-infinite-spending-variations/>https://bitcoinmagazine.com/articles/graftroot-how-delegating-signatures-allows-near-infinite-spending-variations/</a>&#160;<a href=#fnref:66 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:67><p><a href=https://gist.github.com/chris-belcher/00255ecfe1bc4984fcf7c65e25aa8b4b#worked-example-for-tumbler-replacement>https://gist.github.com/chris-belcher/00255ecfe1bc4984fcf7c65e25aa8b4b#worked-example-for-tumbler-replacement</a>&#160;<a href=#fnref:67 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:68><p><a href=https://www.reddit.com/r/joinmarket/comments/3c7hnm/joinmarket_is_smart_contracts/>https://www.reddit.com/r/joinmarket/comments/3c7hnm/joinmarket_is_smart_contracts/</a>&#160;<a href=#fnref:68 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:69><p><a href=https://blockstream.com/2018/08/08/improving-privacy-using-pay-to-endpoint/>https://blockstream.com/2018/08/08/improving-privacy-using-pay-to-endpoint/</a>&#160;<a href=#fnref:69 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:70><p><a href=https://medium.com/@nopara73/pay-to-endpoint-56eb05d3cac6>https://medium.com/@nopara73/pay-to-endpoint-56eb05d3cac6</a>&#160;<a href=#fnref:70 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:71><p><a href=https://gist.github.com/AdamISZ/4551b947789d3216bacfcb7af25e029e>https://gist.github.com/AdamISZ/4551b947789d3216bacfcb7af25e029e</a>&#160;<a href=#fnref:71 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:72><p><a href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-August/016340.html>https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-August/016340.html</a>&#160;<a href=#fnref:72 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:73><p><a href=https://joinmarket.me/blog/blog/coinswaps/>https://joinmarket.me/blog/blog/coinswaps/</a>&#160;<a href=#fnref:73 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:74><p><a href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2020-May/017898.html>Design for a CoinSwap implementation for massively improving Bitcoin privacy and fungibility</a>&#160;<a href=#fnref:74 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:75><p><a href=https://gist.github.com/chris-belcher/9144bd57a91c194e332fb5ca371d0964>Coinswap design document</a>&#160;<a href=#fnref:75 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:76><p><a href=https://bitcoinmagazine.com/articles/the-human-rights-foundation-is-now-funding-bitcoin-privacy-development-starting-with-coinswap>The Human Rights Foundation Is Now Funding Bitcoin Privacy Development, Starting With CoinSwap</a>&#160;<a href=#fnref:76 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:77><p><a href=https://joinmarket.me/blog/blog/coinjoinxt/>https://joinmarket.me/blog/blog/coinjoinxt/</a>&#160;<a href=#fnref:77 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:78><p><a href=https://joinmarket.me/blog/blog/the-steganographic-principle/>https://joinmarket.me/blog/blog/the-steganographic-principle/</a>&#160;<a href=#fnref:78 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:79><p><a href=https://www.reddit.com/r/Bitcoin/comments/7t1q5x/deanonymization_risks_on_lightning_network/>https://www.reddit.com/r/Bitcoin/comments/7t1q5x/deanonymization_risks_on_lightning_network/</a>&#160;<a href=#fnref:79 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:80><p><a href=https://github.com/lightningnetwork/lightning-rfc/blob/master/04-onion-routing.md>https://github.com/lightningnetwork/lightning-rfc/blob/master/04-onion-routing.md</a>&#160;<a href=#fnref:80 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:81><p><a href=https://diyhpl.us/wiki/transcripts/scalingbitcoin/milan/onion-routing-in-lightning/>https://diyhpl.us/wiki/transcripts/scalingbitcoin/milan/onion-routing-in-lightning/</a>&#160;<a href=#fnref:81 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:82><p><a href=https://www.reddit.com/r/Bitcoin/comments/7rrjp3/is_onion_routing_appropriate_for_lightning_network/>https://www.reddit.com/r/Bitcoin/comments/7rrjp3/is_onion_routing_appropriate_for_lightning_network/</a>&#160;<a href=#fnref:82 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:83><p><a href=https://www.reddit.com/r/Bitcoin/comments/8hwzbh/chainalysis_on_the_ln/>https://www.reddit.com/r/Bitcoin/comments/8hwzbh/chainalysis_on_the_ln/</a>&#160;<a href=#fnref:83 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:84><p><a href=https://github.com/lightningnetwork/lightning-rfc/wiki/Rendez-vous-mechanism-on-top-of-Sphinx>https://github.com/lightningnetwork/lightning-rfc/wiki/Rendez-vous-mechanism-on-top-of-Sphinx</a>&#160;<a href=#fnref:84 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:85><p><a href=https://lists.linuxfoundation.org/pipermail/lightning-dev/2018-November/001498.html>https://lists.linuxfoundation.org/pipermail/lightning-dev/2018-November/001498.html</a>&#160;<a href=#fnref:85 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:86><p><a href=https://bitcoinops.org/en/newsletters/2018/11/20/>https://bitcoinops.org/en/newsletters/2018/11/20/</a>&#160;<a href=#fnref:86 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:87><p><a href=https://lists.linuxfoundation.org/pipermail/lightning-dev/2018-February/000993.html>https://lists.linuxfoundation.org/pipermail/lightning-dev/2018-February/000993.html</a>&#160;<a href=#fnref:87 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:88><p>Lightning in Scriptless Scripts Andrew Poelstra 20 Mar 2017 <a href=https://lists.launchpad.net/mimblewimble/msg00086.html>https://lists.launchpad.net/mimblewimble/msg00086.html</a>&#160;<a href=#fnref:88 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:89><p>L2 Summit Hosted by MIT DCI and Fidelity Labs, Boston 2018, Andrew Poelstra talk on Scriptless Scripts <a href=http://diyhpl.us/wiki/transcripts/layer2-summit/2018/scriptless-scripts/>http://diyhpl.us/wiki/transcripts/layer2-summit/2018/scriptless-scripts/</a>&#160;<a href=#fnref:89 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:90><p>Giulio Malavolta, Pedro Moreno-Sanchez, Aniket Kate, Matteo Maffei, and Srivatsan Ravi. 2017. Concurrency and Privacy with Payment-Channel Networks. In Proceedings of the 2017 ACM SIGSAC Conference on Computer and Communications Security (CCS &lsquo;17). ACM, New York, NY, USA, 455-471. DOI: <a href=https://doi.org/10.1145/3133956.3134096>https://doi.org/10.1145/3133956.3134096</a> <a href=https://eprint.iacr.org/2017/820.pdf>https://eprint.iacr.org/2017/820.pdf</a>&#160;<a href=#fnref:90 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:91><p><a href=https://diyhpl.us/wiki/transcripts/scalingbitcoin/stanford-2017/concurrency-and-privacy-with-payment-channel-networks/>https://diyhpl.us/wiki/transcripts/scalingbitcoin/stanford-2017/concurrency-and-privacy-with-payment-channel-networks/</a>&#160;<a href=#fnref:91 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:92><p>See first 20 minutes of this: <a href="https://www.youtube.com/watch?v=H1yPkPXLDVc">https://www.youtube.com/watch?v=H1yPkPXLDVc</a>&#160;<a href=#fnref:92 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:93><p>Jordi Herrera-Joancomartí, Guillermo Navarro-Arribas, Alejandro Ranchal-Pedrosa, Cristina Pérez-Solà, Joaquin Garcia-Alfaro (2019), &ldquo;On the Difficulty of Hiding the Balance of Lightning Network Channels&rdquo; IACR Cryptology ePrint Archive: <a href=https://eprint.iacr.org/2019/328>https://eprint.iacr.org/2019/328</a>&#160;<a href=#fnref:93 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:94><p><a href=https://github.com/jlopp/physical-bitcoin-attacks>https://github.com/jlopp/physical-bitcoin-attacks</a>&#160;<a href=#fnref:94 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:95><p><a href=https://gist.github.com/chris-belcher/00255ecfe1bc4984fcf7c65e25aa8b4b#worked-example-for-tumbler-replacement>https://gist.github.com/chris-belcher/00255ecfe1bc4984fcf7c65e25aa8b4b#worked-example-for-tumbler-replacement</a>&#160;<a href=#fnref:95 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:96><p><a href=https://www.reddit.com/r/joinmarket/comments/7614ea/how_to_properly_spend_tumbled_coins/>https://www.reddit.com/r/joinmarket/comments/7614ea/how_to_properly_spend_tumbled_coins/</a>&#160;<a href=#fnref:96 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:97><p><a href=https://twitter.com/msuiche/status/863082346014224385>https://twitter.com/msuiche/status/863082346014224385</a>&#160;<a href=#fnref:97 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:98><p><a href="https://bitcointalk.org/index.php?topic=1916199.0">https://bitcointalk.org/index.php?topic=1916199.0</a>&#160;<a href=#fnref:98 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:99><p><a href=https://www.reddit.com/r/Bitcoin/comments/anycg2/electrum_targeted_phishing_malware_warning/>https://www.reddit.com/r/Bitcoin/comments/anycg2/electrum_targeted_phishing_malware_warning/</a>&#160;<a href=#fnref:99 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:100><p><a href=https://twitter.com/GossiTheDog/status/1078308649158664194>https://twitter.com/GossiTheDog/status/1078308649158664194</a>&#160;<a href=#fnref:100 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:101><p><a href=https://twitter.com/LaurentMT/status/1078638385256902656>https://twitter.com/LaurentMT/status/1078638385256902656</a>&#160;<a href=#fnref:101 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:102><p><a href=https://www.reddit.com/r/Bitcoin/comments/2ww4eb/how_does_wallet_explorer_know_which_wallets/>https://www.reddit.com/r/Bitcoin/comments/2ww4eb/how_does_wallet_explorer_know_which_wallets/</a>&#160;<a href=#fnref:102 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:103><p><a href=https://www.walletexplorer.com/txid/5ac0210febf7ce07a737bae8c32f84c1c54d131c21a16ca6b02b6f1edcad15c3>https://www.walletexplorer.com/txid/5ac0210febf7ce07a737bae8c32f84c1c54d131c21a16ca6b02b6f1edcad15c3</a>&#160;<a href=#fnref:103 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:104><p><a href=https://www.coinjoinsudoku.com/>https://www.coinjoinsudoku.com/</a>&#160;<a href=#fnref:104 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:105><p><a href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-January/015606.html>https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-January/015606.html</a>&#160;<a href=#fnref:105 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:106><p><a href="https://p2sh.info/dashboard/db/p2sh-repartition-by-type?orgId=1">https://p2sh.info/dashboard/db/p2sh-repartition-by-type?orgId=1</a>&#160;<a href=#fnref:106 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:107><p><a href="https://www.youtube.com/watch?v=Tiyvrh53Yp8">https://www.youtube.com/watch?v=Tiyvrh53Yp8</a>&#160;<a href=#fnref:107 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:108><p><a href=https://www.reddit.com/r/Bitcoin/comments/4vupa6/p2shinfo_shows_movement_out_of_multisig_wallets/>https://www.reddit.com/r/Bitcoin/comments/4vupa6/p2shinfo_shows_movement_out_of_multisig_wallets/</a>&#160;<a href=#fnref:108 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:109><p><a href=https://web.archive.org/web/20170309231819/https://www.reddit.com/r/Bitcoin/comments/4v28jl/how_have_fungiblity_problems_affected_you_in/>https://web.archive.org/web/20170309231819/https://www.reddit.com/r/Bitcoin/comments/4v28jl/how_have_fungiblity_problems_affected_you_in/</a>&#160;<a href=#fnref:109 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:110><p><a href=https://www.reddit.com/r/Bitcoin/comments/69duq9/50_bounty_for_anybody_recovering_445_btc_stolen/>https://www.reddit.com/r/Bitcoin/comments/69duq9/50_bounty_for_anybody_recovering_445_btc_stolen/</a>&#160;<a href=#fnref:110 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:111><p>Goldfeder, S., Kalodner, H., Reisman, D., & Narayanan, A. (2018). When the cookie meets the blockchain: Privacy risks of web payments via cryptocurrencies, Proceedings on Privacy Enhancing Technologies, 2018(4), 179-199. doi: <a href=https://doi.org/10.1515/popets-2018-0038>https://doi.org/10.1515/popets-2018-0038</a>&#160;<a href=#fnref:111 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:112><p><a href=https://web.archive.org/web/20150607131623/http://www.reddit.com/r/DarkNetMarkets/comments/2rhaqc/deanonimyzing_bitcoinfog_and_other_tumblers/>https://web.archive.org/web/20150607131623/http://www.reddit.com/r/DarkNetMarkets/comments/2rhaqc/deanonimyzing_bitcoinfog_and_other_tumblers/</a>&#160;<a href=#fnref:112 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:113><p>Juhász PL, Stéger J, Kondor D, Vattay G (2018) A Bayesian approach to identify Bitcoin users. PLOS ONE 13(12): e0207000. <a href=https://doi.org/10.1371/journal.pone.0207000>https://doi.org/10.1371/journal.pone.0207000</a>&#160;<a href=#fnref:113 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:114><p>D. Y. Huang et al., &ldquo;Tracking Ransomware End-to-end,&rdquo; 2018 IEEE Symposium on Security and Privacy (SP), San Francisco, CA, 2018, pp. 618-631. doi: 10.1109/SP.2018.00047 <a href="https://www.youtube.com/watch?v=H5bPmzsVLF8">https://www.youtube.com/watch?v=H5bPmzsVLF8</a>&#160;<a href=#fnref:114 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><hr><i>Connect to our relay to leave a comment. <a href=https://21ideas.org/en/comments/>Details</a>.<br>Подключитесь к нашему релею, чтобы оставить комментарий. <a href=https://21ideas.org/comments/>Подробнее</a>.</i>
<zap-threads anchor=https://21ideas.org/en/wiki-bitcoin-privacy/ author=npub1lm3f47nzyf0rjp6fsl4qlnkmzed4uj4h2gnf2vhe3l3mrj85vqks6z3c7l relays=wss://21ideas.nostr1.com disable=replyAnonymously legacy-url=true></zap-threads><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#summary>Summary</a></li><li><a href=#introduction>Introduction</a><ul><li><a href=#example---adversary-controls-source-and-destination-of-coins>Example - Adversary controls source and destination of coins</a></li><li><a href=#example---non-anonymous-chinese-newspaper-buying>Example - Non-anonymous Chinese newspaper buying</a></li><li><a href=#example---a-perfectly-private-donation>Example - A perfectly private donation</a></li><li><a href=#multiple-interpretations-of-a-blockchain-transaction>Multiple interpretations of a blockchain transaction</a></li><li><a href=#threat-model>Threat model</a></li><li><a href=#method-of-data-fusion>Method of data fusion</a></li><li><a href=#why-privacy>Why privacy</a></li></ul></li><li><a href=#blockchain-attacks-on-privacy>Blockchain attacks on privacy</a><ul><li><a href=#common-input-ownership-heuristic>Common-input-ownership heuristic</a></li><li><a href=#change-address-detection>Change address detection</a><ul><li><a href=#address-reuse>Address reuse</a></li><li><a href=#wallet-fingerprinting>Wallet fingerprinting</a></li><li><a href=#round-numbers>Round numbers</a></li><li><a href=#fee-bumping>Fee bumping</a></li><li><a href=#unnecessary-input-heuristic>Unnecessary input heuristic</a></li><li><a href=#sending-to-a-different-script-type>Sending to a different script type</a></li><li><a href=#wallet-bugs>Wallet bugs</a></li><li><a href=#equal-output-coinjoin>Equal-output CoinJoin</a></li><li><a href=#cluster-growth>Cluster growth</a></li></ul></li><li><a href=#transaction-graph-heuristic>Transaction graph heuristic</a><ul><li><a href=#taint-analysis>Taint analysis</a></li></ul></li><li><a href=#amount>Amount</a><ul><li><a href=#input-amounts-revealing-sender-wealth>Input amounts revealing sender wealth</a></li><li><a href=#exact-payment-amounts-no-change>Exact payment amounts (no change)</a></li></ul></li><li><a href=#batching>Batching</a></li><li><a href=#unusual-scripts>Unusual scripts</a></li><li><a href=#mystery-shopper-payment>Mystery shopper payment</a></li><li><a href=#forced-address-reuse>Forced address reuse</a></li><li><a href=#amount-correlation>Amount correlation</a></li><li><a href=#timing-correlation>Timing correlation</a></li></ul></li><li><a href=#non-blockchain-attacks-on-privacy>Non-blockchain attacks on privacy</a><ul><li><a href=#traffic-analysis>Traffic analysis</a></li><li><a href=#custodial-wallets>Custodial Wallets</a></li><li><a href=#wallet-history-retrieval-from-third-party>Wallet history retrieval from third-party</a><ul><li><a href=#blockchain-explorer-websites>Blockchain explorer websites</a></li><li><a href=#bip-37>BIP 37</a></li><li><a href=#public-electrum-servers>Public Electrum servers</a></li></ul></li><li><a href=#communication-eavesdropping>Communication eavesdropping</a></li><li><a href=#revealing-data-when-transacting-bitcoin>Revealing data when transacting bitcoin</a></li><li><a href=#digital-forensics>Digital forensics</a></li></ul></li><li><a href=#methods-for-improving-privacy-non-blockchain>Methods for improving privacy (non-blockchain)</a><ul><li><a href=#obtaining-bitcoins-anonymously>Obtaining bitcoins anonymously</a><ul><li><a href=#cash-trades>Cash trades</a></li><li><a href=#cash-substitute>Cash substitute</a></li><li><a href=#employment>Employment</a></li><li><a href=#mining>Mining</a></li><li><a href=#stealing>Stealing</a></li></ul></li><li><a href=#spending-bitcoins-anonymously>Spending bitcoins anonymously</a></li><li><a href=#wallet-history-synchronization>Wallet history synchronization</a><ul><li><a href=#full-node>Full node</a></li><li><a href=#private-information-retrieval>Private information retrieval</a></li><li><a href=#client-side-block-filtering>Client-side block filtering</a></li><li><a href=#address-query-via-onion-routing>Address query via onion routing</a></li></ul></li><li><a href=#countermeasures-to-traffic-analysis>Countermeasures to traffic analysis</a><ul><li><a href=#tor-and-tor-broadcasting>Tor and tor broadcasting</a></li><li><a href=#dandelion>Dandelion</a></li><li><a href=#interactive-peer-broadcasting>Interactive peer broadcasting</a></li><li><a href=#receiving-bitcoin-data-over-satellite>Receiving bitcoin data over satellite</a></li></ul></li></ul></li><li><a href=#methods-for-improving-privacy-blockchain>Methods for improving privacy (blockchain)</a><ul><li><a href=#avoiding-address-reuse>Avoiding address reuse</a><ul><li><a href=#avoiding-forced-address-reuse>Avoiding forced address reuse</a></li></ul></li><li><a href=#coin-control>Coin control</a></li><li><a href=#multiple-transactions>Multiple transactions</a></li><li><a href=#change-avoidance>Change avoidance</a></li><li><a href=#multiple-change-outputs>Multiple change outputs</a></li><li><a href=#script-privacy-improvements>Script privacy improvements</a></li><li><a href=#ecdh-addresses>ECDH addresses</a></li><li><a href=#centralized-mixers>Centralized mixers</a></li><li><a href=#coinjoin>CoinJoin</a><ul><li><a href=#equal-output-coinjoin-1>Equal-output CoinJoin</a></li><li><a href=#payjoin>PayJoin</a></li></ul></li><li><a href=#coinswap>CoinSwap</a></li><li><a href=#coinjoinxt>CoinJoinXT</a></li><li><a href=#tumblebit>TumbleBit</a></li><li><a href=#off-chain-transactions>Off-chain transactions</a><ul><li><a href=#blinded-bearer-certificates>Blinded bearer certificates</a></li><li><a href=#sidechains>Sidechains</a></li><li><a href=#statechains>StateChains</a></li></ul></li><li><a href=#confidential-transactions>Confidential transactions</a></li><li><a href=#discussion>Discussion</a><ul><li><a href=#privacy-vs-scalability>Privacy vs scalability</a></li><li><a href=#steganography>Steganography</a></li></ul></li></ul></li><li><a href=#lightning-network>Lightning Network</a><ul><li><a href=#onion-routing>Onion routing</a><ul><li><a href=#onion-routing-overlaid-with-network-topology>Onion routing overlaid with network topology</a></li><li><a href=#rendez-vous-routing>Rendez-vous routing</a></li></ul></li><li><a href=#atomic-multipath-payments>Atomic Multipath Payments</a></li><li><a href=#common-hashlock-value>Common hashlock value</a></li><li><a href=#custodial-wallets-1>Custodial wallets</a></li><li><a href=#private-script-types>Private script types</a></li><li><a href=#probing-payments-to-reveal-channel-states>Probing payments to reveal channel states</a></li></ul></li><li><a href=#existing-privacy-solutions>Existing privacy solutions</a><ul><li><a href=#lightning-network-1>Lightning Network</a></li><li><a href=#handmade-coinjoin>Handmade CoinJoin</a></li><li><a href=#joinmarket>JoinMarket</a></li><li><a href=#wasabi-wallet>Wasabi Wallet</a></li><li><a href=#samourai-wallet>Samourai Wallet</a></li><li><a href=#liquid-sidechain>Liquid sidechain</a></li><li><a href=#mercury-wallet>Mercury Wallet</a></li></ul></li><li><a href=#examples-and-case-studies>Examples and case studies</a><ul><li><a href=#bad-privacy-example---exchange-front-running>Bad privacy example - Exchange front running</a></li><li><a href=#bad-privacy-example---savings-revealed-with-address-reuse>Bad privacy example - Savings revealed with address reuse</a></li><li><a href=#bad-privacy-example---savings-revealed-with-data-collection>Bad privacy example - Savings revealed with data collection</a></li><li><a href=#example---evading-sanctions>Example - Evading sanctions</a></li><li><a href=#example---transacting-with-your-online-poker-buddies-without-revealing-your-real-name>Example - Transacting with your online poker buddies without revealing your real name</a></li><li><a href=#example---donation-without-your-employer-knowing>Example - Donation without your employer knowing</a></li><li><a href=#example---donation-without-anyone-knowing>Example - Donation without anyone knowing</a></li><li><a href=#example---receiving-donations-privately>Example - Receiving donations privately</a></li><li><a href=#example---storing-savings-privately>Example - Storing savings privately</a></li><li><a href=#example---stopping-incoming-payments-from-different-sources-from-being-linked-together>Example - Stopping incoming payments from different sources from being linked together</a></li><li><a href=#example---withdrawing-casino-winnings-to-a-bitcoin-exchange-without-either-entity-knowing-the-source-or-destination-of-funds>Example - Withdrawing casino winnings to a bitcoin exchange without either entity knowing the source or destination of funds</a></li><li><a href=#bad-privacy-example---using-a-blockchain-explorer>Bad privacy example - Using a blockchain explorer</a></li><li><a href=#bad-privacy-example---privacy-altcoin-mixing-failing-due-to-amount-correlation>Bad privacy example - Privacy altcoin mixing failing due to amount correlation</a></li><li><a href=#example---privacy-altcoin-mixing>Example - Privacy altcoin mixing</a></li><li><a href=#example---daily-commerce-with-lightning-network>Example - Daily commerce with Lightning Network</a></li><li><a href=#bad-privacy-example---sending-to-a-static-donation-address-without-precautions>Bad privacy example - Sending to a static donation address without precautions</a></li><li><a href=#bad-privacy-example---receiving-donations-spied-on-with-mystery-shopper-payments>Bad privacy example - Receiving donations spied on with mystery shopper payments</a></li><li><a href=#real-life-example---bitcoin-stealing-malware-using-static-addresses>Real life example - Bitcoin-stealing malware using static addresses</a></li><li><a href=#bad-privacy-example---bitcoin-stealing-malware-spied-on-with-mystery-shopper-payments>Bad privacy example - Bitcoin-stealing malware spied on with mystery shopper payments</a></li><li><a href=#example---single-use-lightweight-wallet-over-tor>Example - Single-use lightweight wallet over Tor</a></li><li><a href=#bad-privacy-example---lightweight-wallet-over-tor-used-multiple-times>Bad privacy example - Lightweight wallet over Tor used multiple times</a></li><li><a href=#real-life-example---public-donation-address-combined-with-the-common-input-ownership-heuristic>Real life example - Public donation address combined with the common-input-ownership heuristic</a></li><li><a href=#real-life-example---digital-forensics-aids-with-investigation-of-the-mtgox-exchange>Real life example - Digital forensics aids with investigation of the MtGox exchange</a></li><li><a href=#real-life-example---flawed-use-of-the-common-input-ownership-heuristic-exaggerates-donation-income>Real life example - Flawed use of the common-input-ownership heuristic exaggerates donation income</a></li><li><a href=#real-life-example---incorrect-clusters-found-by-the-common-input-ownership-heuristic>Real life example - Incorrect clusters found by the common-input-ownership heuristic</a></li><li><a href=#real-life-example---handmade-coinjoin-mislead-a-bitcoin-analyist>Real life example - Handmade coinjoin mislead a bitcoin analyist</a></li><li><a href=#real-life-example---the-quadrigacx-exchange-wallet-analysis>Real life example - The QuadrigaCX exchange wallet analysis</a></li><li><a href=#real-life-example---stopping-bustabit-casino-customers-getting-banned-from-coinbasecom>Real life example - Stopping Bustabit casino customers getting banned from Coinbase.com</a></li><li><a href=#real-life-example---rare-multisignature-scripts>Real life example - Rare multisignature scripts</a></li><li><a href=#real-life-example---freelance-it-contractor-has-his-co-workers-figure-out-his-salary>Real life example - Freelance IT contractor has his co-workers figure out his salary</a></li><li><a href=#real-life-example---hacker-hides-destination-of-445-btc-with-coinjoin>Real life example - Hacker hides destination of 445 btc with CoinJoin</a></li><li><a href=#bad-privacy-example---data-fusion-of-blockchain-data-and-web-cookies-when-online-shopping-with-bitcoin>Bad privacy example - Data fusion of blockchain data and web cookies when online shopping with Bitcoin</a></li><li><a href=#bad-privacy-example---centralized-mixers-being-easily-unmixed-with-amount-correlation>Bad privacy example - Centralized mixers being easily unmixed with amount correlation</a></li><li><a href=#bad-privacy-example---data-fusion-of-blockchain-data-and-ip-address-transaction-broadcasting-data>Bad privacy example - Data fusion of blockchain data and IP address transaction broadcasting data</a></li><li><a href=#real-life-example---2018-paper-on-analysis-of-bitcoin-ransomware-transactions>Real life example - 2018 paper on analysis of bitcoin ransomware transactions</a></li></ul></li><li><a href=#see-also>See also</a></li></ul></nav></div></aside></main><script>"use strict";const METRICS={FEE:"fee",BLOCK:"block",PRICE:"price",SATS:"sats",BTC:"btc"};let currentMetric=METRICS.FEE,lastKnownValues={fee:{label:"Комиссия",value:"0 sat/vB"},block:{label:"Высота блока",value:"0"},price:{label:"Цена",value:"$0"},sats:{label:"Московское время",value:"00:00"},btc:{label:"",value:"1 BTC = 1 BTC"}};function formatSatsAsTime(e){const t=Math.round(e).toString().padStart(4,"0"),n=t.slice(0,-2),s=t.slice(-2);return`${n}:${s}`}function formatNumber(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}function updateDisplay(){const n=document.getElementById("metrics-label"),e=document.getElementById("metrics-value");if(!n||!e)return;const t=lastKnownValues[currentMetric];n.textContent=t.label,e.textContent=t.value,e.style.paddingTop=t.label?"0":"0.7rem"}async function updateMetrics(){try{const[t,n,e]=await Promise.all([fetch("https://mempool.space/api/v1/fees/recommended").then(e=>e.json()),fetch("https://mempool.space/api/blocks/tip/height").then(e=>e.json()),fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd").then(e=>e.json())]);lastKnownValues.fee.value=`${t.fastestFee} sat/vB`,lastKnownValues.block.value=formatNumber(n),lastKnownValues.price.value=`$${formatNumber(e.bitcoin.usd)}`;const s=Math.round(1e8/e.bitcoin.usd);lastKnownValues.sats.value=formatSatsAsTime(s),updateDisplay()}catch(e){console.error("Error fetching metrics:",e)}}function cycleMetric(){const e=Object.values(METRICS),t=e.indexOf(currentMetric);currentMetric=e[(t+1)%e.length],updateDisplay()}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("metrics-container");e&&(e.addEventListener("click",cycleMetric),updateMetrics(),setInterval(updateMetrics,6e4))})</script></body></html>