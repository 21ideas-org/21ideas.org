"use strict";(function(){const i="/ru.search-data.min.2265a7e7a536a7c98c8db7e7828eecd0e476e0053f57506bc7f9aaa794f95d0f.json",a=Object.assign({split:/[^a-zа-яё0-9\w]/gi},{doc:{id:"id",field:["title","content","tags_index"],store:["title","href","section","tags"]}}),e=document.querySelector("#book-search-input"),t=document.querySelector("#book-search-results");if(!e)return;e.addEventListener("focus",s),e.addEventListener("keyup",o);function c(t){if(t.target.value!==void 0)return;if(e===document.activeElement)return;const n=String.fromCharCode(t.charCode);if(!r(n))return;e.focus(),t.preventDefault()}function r(t){const n=e.getAttribute("data-hotkeys")||"";return n.indexOf(t)>=0}function s(){e.removeEventListener("focus",s),e.required=!0,fetch(i).then(e=>e.json()).then(e=>{e=e.map(e=>({...e,tags_index:e.tags?e.tags.join(" "):""})),window.bookSearchIndex=FlexSearch.create("balance",a),window.bookSearchIndex.add(e)}).then(()=>e.required=!1).then(o)}function o(){for(;t.firstChild;)t.removeChild(t.firstChild);if(!e.value)return;const s=window.bookSearchIndex.search(e.value,10);s.forEach(function(e){const s=n("<li><a href></a><small></small></li>"),o=s.querySelector("a"),i=s.querySelector("small");if(o.href=e.href,o.textContent=e.title,i.textContent=e.section,e.tags&&e.tags.length){const t=n('<div class="tags"></div>');e.tags.forEach(e=>{const s=n(`<span class="tag">${e}</span>`);t.appendChild(s)}),s.appendChild(t)}t.appendChild(s)})}function n(e){const t=document.createElement("div");return t.innerHTML=e,t.firstChild}})()